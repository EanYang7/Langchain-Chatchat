{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-]","pipeline":["stemmer"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#_1","title":"\u9879\u76ee\u200b\u7b80\u4ecb","text":"<p>\ud83d\udcc3 LangChain-Chatchat (\u200b\u539f\u200b Langchain-ChatGLM):  \u200b\u57fa\u4e8e\u200b Langchain \u200b\u4e0e\u200b ChatGLM \u200b\u7b49\u200b\u5927\u200b\u8bed\u8a00\u200b\u6a21\u578b\u200b\u7684\u200b\u672c\u5730\u200b\u77e5\u8bc6\u5e93\u200b\u95ee\u7b54\u200b\u5e94\u7528\u200b\u5b9e\u73b0\u200b\u3002</p> <p>\ud83e\udd16\ufe0f \u200b\u4e00\u79cd\u200b\u5229\u7528\u200b langchain \u200b\u601d\u60f3\u200b\u5b9e\u73b0\u200b\u7684\u200b\u57fa\u4e8e\u200b\u672c\u5730\u200b\u77e5\u8bc6\u5e93\u200b\u7684\u200b\u95ee\u7b54\u200b\u5e94\u7528\u200b\uff0c\u200b\u76ee\u6807\u200b\u671f\u671b\u200b\u5efa\u7acb\u200b\u4e00\u5957\u200b\u5bf9\u200b\u4e2d\u6587\u200b\u573a\u666f\u200b\u4e0e\u200b\u5f00\u6e90\u200b\u6a21\u578b\u200b\u652f\u6301\u200b\u53cb\u597d\u200b\u3001\u200b\u53ef\u200b\u79bb\u7ebf\u200b\u8fd0\u884c\u200b\u7684\u200b\u77e5\u8bc6\u5e93\u200b\u95ee\u7b54\u200b\u89e3\u51b3\u65b9\u6848\u200b\u3002</p> <p>\ud83d\udca1 \u200b\u53d7\u200b GanymedeNil \u200b\u7684\u200b\u9879\u76ee\u200b document.ai \u200b\u548c\u200b AlexZhangji \u200b\u521b\u5efa\u200b\u7684\u200b ChatGLM-6B Pull Request \u200b\u542f\u53d1\u200b\uff0c\u200b\u5efa\u7acb\u200b\u4e86\u200b\u5168\u200b\u6d41\u7a0b\u200b\u53ef\u200b\u4f7f\u7528\u200b\u5f00\u6e90\u200b\u6a21\u578b\u200b\u5b9e\u73b0\u200b\u7684\u200b\u672c\u5730\u200b\u77e5\u8bc6\u5e93\u200b\u95ee\u7b54\u200b\u5e94\u7528\u200b\u3002\u200b\u672c\u200b\u9879\u76ee\u200b\u7684\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u4e2d\u200b\u901a\u8fc7\u200b\u4f7f\u7528\u200b FastChat \u200b\u63a5\u5165\u200b Vicuna, Alpaca, LLaMA, Koala, RWKV \u200b\u7b49\u200b\u6a21\u578b\u200b\uff0c\u200b\u4f9d\u6258\u200b\u4e8e\u200b langchain \u200b\u6846\u67b6\u200b\u652f\u6301\u200b\u901a\u8fc7\u200b\u57fa\u4e8e\u200b FastAPI \u200b\u63d0\u4f9b\u200b\u7684\u200b API \u200b\u8c03\u7528\u200b\u670d\u52a1\u200b\uff0c\u200b\u6216\u200b\u4f7f\u7528\u200b\u57fa\u4e8e\u200b Streamlit \u200b\u7684\u200b WebUI \u200b\u8fdb\u884c\u200b\u64cd\u4f5c\u200b\u3002</p> <p>\u2705 \u200b\u4f9d\u6258\u200b\u4e8e\u672c\u200b\u9879\u76ee\u200b\u652f\u6301\u200b\u7684\u200b\u5f00\u6e90\u200b LLM \u200b\u4e0e\u200b Embedding \u200b\u6a21\u578b\u200b\uff0c\u200b\u672c\u200b\u9879\u76ee\u200b\u53ef\u200b\u5b9e\u73b0\u200b\u5168\u90e8\u200b\u4f7f\u7528\u200b\u5f00\u6e90\u200b\u6a21\u578b\u200b\u79bb\u7ebf\u200b\u79c1\u6709\u200b\u90e8\u7f72\u200b\u3002\u200b\u4e0e\u6b64\u540c\u65f6\u200b\uff0c\u200b\u672c\u200b\u9879\u76ee\u200b\u4e5f\u200b\u652f\u6301\u200b OpenAI GPT API \u200b\u7684\u200b\u8c03\u7528\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u5728\u200b\u540e\u7eed\u200b\u6301\u7eed\u200b\u6269\u5145\u200b\u5bf9\u200b\u5404\u7c7b\u200b\u6a21\u578b\u200b\u53ca\u200b\u6a21\u578b\u200b API \u200b\u7684\u200b\u63a5\u5165\u200b\u3002</p> <p>\u26d3\ufe0f \u200b\u672c\u200b\u9879\u76ee\u200b\u5b9e\u73b0\u200b\u539f\u7406\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff0c\u200b\u8fc7\u7a0b\u200b\u5305\u62ec\u200b\u52a0\u8f7d\u200b\u6587\u4ef6\u200b -&gt; \u200b\u8bfb\u53d6\u200b\u6587\u672c\u200b -&gt; \u200b\u6587\u672c\u200b\u5206\u5272\u200b -&gt; \u200b\u6587\u672c\u200b\u5411\u200b\u91cf\u5316\u200b -&gt; \u200b\u95ee\u53e5\u200b\u5411\u200b\u91cf\u5316\u200b -&gt; \u200b\u5728\u200b\u6587\u672c\u200b\u5411\u91cf\u200b\u4e2d\u200b\u5339\u914d\u200b\u51fa\u200b\u4e0e\u200b\u95ee\u53e5\u200b\u5411\u91cf\u200b\u6700\u200b\u76f8\u4f3c\u200b\u7684\u200b <code>top k</code>\u200b\u4e2a\u200b -&gt; \u200b\u5339\u914d\u200b\u51fa\u200b\u7684\u200b\u6587\u672c\u200b\u4f5c\u4e3a\u200b\u4e0a\u4e0b\u6587\u200b\u548c\u200b\u95ee\u9898\u200b\u4e00\u8d77\u200b\u6dfb\u52a0\u200b\u5230\u200b <code>prompt</code>\u200b\u4e2d\u200b -&gt; \u200b\u63d0\u4ea4\u200b\u7ed9\u200b <code>LLM</code>\u200b\u751f\u6210\u200b\u56de\u7b54\u200b\u3002</p>"},{"location":"#_2","title":"\u7b97\u6cd5\u200b\u6d41\u7a0b","text":"<p>\ud83d\udcfa \u200b\u539f\u7406\u200b\u4ecb\u7ecd\u200b\u89c6\u9891\u200b</p> <p>\u200b\u5b9e\u73b0\u200b\u539f\u7406\u56fe\u200b\uff1a</p> <p> </p> <p>\u200b\u4ece\u200b\u6587\u6863\u200b\u5904\u7406\u200b\u89d2\u5ea6\u200b\u6765\u770b\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u6d41\u7a0b\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p>"},{"location":"#_3","title":"\u6280\u672f\u200b\u8def\u7ebf\u56fe","text":"<ul> <li> Langchain \u200b\u5e94\u7528\u200b</li> <li> \u200b\u672c\u5730\u200b\u6570\u636e\u200b\u63a5\u5165\u200b<ul> <li> \u200b\u63a5\u5165\u200b\u975e\u200b\u7ed3\u6784\u5316\u200b\u6587\u6863\u200b</li> <li> .txt, .rtf, .epub, .srt</li> <li> .eml, .msg</li> <li> .html, .xml, .toml</li> <li> .json, .jsonl</li> <li> .md, .rst</li> <li> .docx, .doc, .pptx, .ppt, .odt</li> <li> .pdf</li> <li> .jpg, .jpeg, .png, .bmp</li> <li> .py, .ipynb</li> <li> \u200b\u7ed3\u6784\u5316\u200b\u6570\u636e\u200b\u63a5\u5165\u200b</li> <li> .csv, .tsv</li> <li> .xlsx, .xlsd</li> <li> \u200b\u5206\u8bcd\u200b\u53ca\u200b\u53ec\u56de\u200b</li> <li> \u200b\u63a5\u5165\u200b\u4e0d\u540c\u200b\u7c7b\u578b\u200b TextSplitter</li> <li> \u200b\u4f18\u5316\u200b\u4f9d\u636e\u200b\u4e2d\u6587\u200b\u6807\u70b9\u7b26\u53f7\u200b\u8bbe\u8ba1\u200b\u7684\u200b ChineseTextSplitter</li> <li> \u200b\u91cd\u65b0\u200b\u5b9e\u73b0\u200b\u4e0a\u4e0b\u6587\u200b\u62fc\u63a5\u200b\u53ec\u56de\u200b</li> <li> \u200b\u672c\u5730\u200b\u7f51\u9875\u200b\u63a5\u5165\u200b</li> <li> SQL \u200b\u63a5\u5165\u200b</li> <li> \u200b\u77e5\u8bc6\u200b\u56fe\u8c31\u200b/\u200b\u56fe\u200b\u6570\u636e\u5e93\u200b\u63a5\u5165\u200b</li> </ul> </li> <li> \u200b\u641c\u7d22\u5f15\u64ce\u200b\u63a5\u5165\u200b<ul> <li> Bing \u200b\u641c\u7d22\u200b</li> <li> DuckDuckGo \u200b\u641c\u7d22\u200b</li> <li> Metaphor \u200b\u641c\u7d22\u200b</li> </ul> </li> <li> Agent \u200b\u5b9e\u73b0\u200b<ul> <li> \u200b\u57fa\u7840\u200bReact\u200b\u5f62\u5f0f\u200b\u7684\u200bAgent\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u5305\u62ec\u200b\u8c03\u7528\u200b\u8ba1\u7b97\u5668\u200b\u7b49\u200b</li> <li> Langchain \u200b\u81ea\u5e26\u200b\u7684\u200bAgent\u200b\u5b9e\u73b0\u200b\u548c\u200b\u8c03\u7528\u200b</li> <li> \u200b\u667a\u80fd\u200b\u8c03\u7528\u200b\u4e0d\u540c\u200b\u7684\u200b\u6570\u636e\u5e93\u200b\u548c\u200b\u8054\u7f51\u200b\u77e5\u8bc6\u200b</li> <li> \u200b\u66f4\u200b\u591a\u200b\u5de5\u5177\u200b</li> </ul> </li> <li> LLM \u200b\u6a21\u578b\u200b\u63a5\u5165\u200b</li> <li> \u200b\u652f\u6301\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b FastChat api \u200b\u8c03\u7528\u200b llm</li> <li> \u200b\u652f\u6301\u200b ChatGLM API \u200b\u7b49\u200b LLM API \u200b\u7684\u200b\u63a5\u5165\u200b</li> <li> \u200b\u652f\u6301\u200b Langchain \u200b\u6846\u67b6\u200b\u652f\u6301\u200b\u7684\u200bLLM API \u200b\u63a5\u5165\u200b</li> <li> Embedding \u200b\u6a21\u578b\u200b\u63a5\u5165\u200b</li> <li> \u200b\u652f\u6301\u200b\u8c03\u7528\u200b HuggingFace \u200b\u4e2d\u200b\u5404\u200b\u5f00\u6e90\u200b Emebdding \u200b\u6a21\u578b\u200b</li> <li> \u200b\u652f\u6301\u200b OpenAI Embedding API \u200b\u7b49\u200b Embedding API \u200b\u7684\u200b\u63a5\u5165\u200b</li> <li> \u200b\u652f\u6301\u200b \u200b\u667a\u8c31\u200bAI\u3001\u200b\u767e\u5ea6\u200b\u5343\u5e06\u200b\u3001\u200b\u5343\u95ee\u200b\u3001MiniMax \u200b\u7b49\u200b\u5728\u200b Embedding API \u200b\u7684\u200b\u63a5\u5165\u200b</li> <li> \u200b\u57fa\u4e8e\u200b FastAPI \u200b\u7684\u200b API \u200b\u65b9\u5f0f\u200b\u8c03\u7528\u200b</li> <li> Web UI</li> <li> \u200b\u57fa\u4e8e\u200b Streamlit \u200b\u7684\u200b Web UI</li> </ul>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/","title":"1 \u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u90e8\u7f72","text":""},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_1","title":"\u8f6f\u4ef6\u200b\u8981\u6c42","text":"<p>\u200b\u8981\u200b\u987a\u5229\u200b\u8fd0\u884c\u200b\u672c\u200b\u4ee3\u7801\u200b\uff0c\u200b\u8bf7\u200b\u6309\u7167\u200b\u4ee5\u4e0b\u200b\u7cfb\u7edf\u200b\u8981\u6c42\u200b\u8fdb\u884c\u200b\u914d\u7f6e\u200b</p> <p>\u200b\u5df2\u7ecf\u200b\u6d4b\u8bd5\u200b\u8fc7\u200b\u7684\u200b\u7cfb\u7edf\u200b</p> <ul> <li>Linux Ubuntu 22.04.5 kernel version 6.7</li> </ul> <p>\u200b\u5176\u4ed6\u200b\u7cfb\u7edf\u200b\u53ef\u80fd\u200b\u51fa\u73b0\u200b\u7cfb\u7edf\u200b\u517c\u5bb9\u6027\u95ee\u9898\u200b\u3002</p> <p>\u200b\u6700\u4f4e\u200b\u8981\u6c42\u200b</p> <p>\u200b\u8be5\u200b\u8981\u6c42\u200b\u4ec5\u200b\u9488\u5bf9\u200b\u6807\u51c6\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u8f7b\u91cf\u200b\u6a21\u5f0f\u200b\u4f7f\u7528\u200b\u5728\u7ebf\u200b\u6a21\u578b\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u5b89\u88c5\u200btorch\u200b\u7b49\u5e93\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u200b\u9700\u8981\u200b\u663e\u5361\u200b\u5373\u53ef\u200b\u8fd0\u884c\u200b\u3002</p> <ul> <li>Python \u200b\u7248\u672c\u200b: &gt;= 3.10, &lt; 3.11</li> <li>CUDA \u200b\u7248\u672c\u200b: &gt;= 12.1 </li> </ul> <p>\u200b\u63a8\u8350\u200b\u8981\u6c42\u200b</p> <p>\u200b\u5f00\u53d1\u8005\u200b\u5728\u200b\u4ee5\u4e0b\u200b\u73af\u5883\u200b\u4e0b\u200b\u8fdb\u884c\u200b\u4ee3\u7801\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5728\u200b\u8be5\u200b\u73af\u5883\u200b\u4e0b\u200b\u80fd\u591f\u200b\u907f\u514d\u200b\u6700\u200b\u591a\u200b\u73af\u5883\u200b\u95ee\u9898\u200b\u3002</p> <ul> <li>Python \u200b\u7248\u672c\u200b == 3.10.12</li> <li>CUDA \u200b\u7248\u672c\u200b: == 12.3</li> </ul>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_2","title":"\u786c\u4ef6\u200b\u8981\u6c42","text":"<p>\u200b\u5982\u679c\u200b\u60f3\u8981\u200b\u987a\u5229\u200b\u5728\u200bGPU\u200b\u8fd0\u884c\u200b\u672c\u5730\u200b\u6a21\u578b\u200b\u7684\u200b int4 \u200b\u91cf\u5316\u200b\u7248\u672c\u200b\uff0c\u200b\u4f60\u200b\u81f3\u5c11\u200b\u9700\u8981\u200b\u4ee5\u4e0b\u200b\u7684\u200b\u786c\u4ef6\u200b\u914d\u7f6e\u200b:</p> <ul> <li>ChatGLM2-6B &amp; LLaMA-7B  </li> <li>\u200b\u6700\u4f4e\u200b\u663e\u5b58\u200b\u8981\u6c42\u200b: 7GB</li> <li>\u200b\u63a8\u8350\u200b\u663e\u5361\u200b: RTX 3060, RTX 2060</li> <li>LLaMA-13B </li> <li>\u200b\u6700\u4f4e\u200b\u663e\u5b58\u200b\u8981\u6c42\u200b: 11GB  </li> <li>\u200b\u63a8\u8350\u200b\u663e\u5361\u200b: RTX 2060 12GB, RTX 3060 12GB, RTX 3080, RTX A2000 </li> <li>Qwen-14B-Chat </li> <li>\u200b\u6700\u4f4e\u200b\u663e\u5b58\u200b\u8981\u6c42\u200b: 13GB </li> <li>\u200b\u63a8\u8350\u200b\u663e\u5361\u200b: RTX 3090</li> <li>LLaMA-30B </li> <li>\u200b\u6700\u4f4e\u200b\u663e\u5b58\u200b\u8981\u6c42\u200b: 22GB  </li> <li>\u200b\u63a8\u8350\u200b\u663e\u5361\u200b: RTX A5000, RTX 3090, RTX 4090, RTX 6000, Tesla V100, RTX Tesla P40</li> <li>LLaMA-65B </li> <li>\u200b\u6700\u4f4e\u200b\u663e\u5b58\u200b\u8981\u6c42\u200b: 40GB  </li> <li>\u200b\u63a8\u8350\u200b\u663e\u5361\u200b: A100, A40, A6000</li> </ul> <p>\u200b\u82e5\u200b\u4f7f\u7528\u200b int8 \u200b\u63a8\u7406\u200b\uff0c\u200b\u5219\u200b\u663e\u5b58\u200b\u5927\u81f4\u200b\u4e3a\u200b int4 \u200b\u63a8\u7406\u200b\u8981\u6c42\u200b\u7684\u200b 1.5 \u200b\u500d\u200b\uff1b</p> <p>\u200b\u82e5\u200b\u4f7f\u7528\u200b fp16 \u200b\u63a8\u7406\u200b\uff0c\u200b\u5219\u200b\u663e\u5b58\u200b\u5927\u81f4\u200b\u4e3a\u200b int4 \u200b\u63a8\u7406\u200b\u8981\u6c42\u200b\u7684\u200b 2.5 \u200b\u500d\u200b\u3002</p> <p>\ud83d\udca1 \u200b\u4f8b\u5982\u200b\uff1a\u200b\u4f7f\u7528\u200b fp16 \u200b\u63a8\u7406\u200b Qwen-7B-Chat \u200b\u6a21\u578b\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b 16GB \u200b\u663e\u5b58\u200b\u3002</p> <p>\u200b\u4ee5\u4e0a\u200b\u6570\u636e\u200b\u4ec5\u4e3a\u200b\u4f30\u7b97\u200b\uff0c\u200b\u5b9e\u9645\u200b\u60c5\u51b5\u200b\u4ee5\u200b nvidia-smi \u200b\u5360\u7528\u200b\u4e3a\u51c6\u200b\u3002 \u200b\u8bf7\u200b\u6ce8\u610f\u200b\uff0c\u200b\u5982\u679c\u200b\u4f7f\u7528\u200b\u6700\u4f4e\u200b\u914d\u7f6e\u200b\uff0c\u200b\u4ec5\u80fd\u200b\u4fdd\u8bc1\u200b\u4ee3\u7801\u200b\u80fd\u591f\u200b\u8fd0\u884c\u200b\uff0c\u200b\u4f46\u200b\u8fd0\u884c\u200b\u901f\u5ea6\u200b\u8f83\u6162\u200b\uff0c\u200b\u4f53\u9a8c\u200b\u4e0d\u4f73\u200b\u3002</p> <p>\u200b\u540c\u65f6\u200b\uff0cEmbedding \u200b\u6a21\u578b\u200b\u5c06\u4f1a\u200b\u5360\u7528\u200b 1-2G \u200b\u7684\u200b\u663e\u5b58\u200b\uff0c\u200b\u5386\u53f2\u8bb0\u5f55\u200b\u6700\u591a\u4f1a\u200b\u5360\u7528\u200b\u6570\u200b G \u200b\u663e\u5b58\u200b\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u9700\u8981\u200b\u591a\u200b\u5197\u4f59\u200b\u4e00\u4e9b\u200b\u663e\u5b58\u200b\u3002</p> <p>\u200b\u5185\u5b58\u200b\u6700\u4f4e\u200b\u8981\u6c42\u200b: \u200b\u5185\u5b58\u200b\u8981\u6c42\u200b\u81f3\u5c11\u200b\u5e94\u8be5\u200b\u6bd4\u200b\u6a21\u578b\u200b\u8fd0\u884c\u200b\u7684\u200b\u663e\u5b58\u200b\u5927\u200b\u3002 \u200b\u4f8b\u5982\u200b\uff0c\u200b\u8fd0\u884c\u200bChatglm2-6b FP16\u200b\u6a21\u578b\u200b\uff0c\u200b\u663e\u5b58\u200b\u5360\u7528\u200b10G\uff0c\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b16G\u200b\u4ee5\u4e0a\u200b\u5185\u5b58\u200b\u3002</p>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#vpn","title":"VPN","text":"<p>\u200b\u5982\u679c\u200b\u60a8\u200b\u4f4d\u4e8e\u200b\u4e2d\u56fd\u200b(\u200b\u542b\u6e2f\u200b\uff0c\u200b\u6fb3\u200b\uff0c\u200b\u53f0\u200b) \u200b\u9700\u8981\u200b\u8c03\u7528\u200b OpenAI \u200b\u6216\u8005\u200b \u200b\u5176\u4ed6\u200b\u5883\u5916\u200b\u6a21\u578b\u200b\u7684\u200b API\uff0c\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b VPN \u200b\u5de5\u5177\u200b\u6216\u200b\u8bbf\u95ee\u200b\u955c\u50cf\u200b\u7ad9\u200b\u3002</p> <p>\u200b\u4ece\u200b Huggingface \u200b\u4e0b\u8f7d\u200b\u6a21\u578b\u200b\u6216\u8005\u200b\u4ece\u672c\u200b\u4ed3\u5e93\u200b\u62c9\u53d6\u200b\u6700\u65b0\u200b\u7684\u200b\u4ee3\u7801\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u5f00\u53d1\u8005\u200b\u81ea\u884c\u200b\u8bbe\u7f6e\u200b\u4ee3\u7406\u200b\u3002\u200b\u672c\u200b\u9879\u76ee\u200b\u4e0d\u200b\u6d89\u53ca\u200b\u4efb\u4f55\u200b\u4ee3\u7406\u200b\u5de5\u5177\u200b\u8bbe\u7f6e\u200b\u548c\u200b\u4f7f\u7528\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u200b\u89e3\u51b3\u200b\u4efb\u4f55\u200b\u5173\u4e8e\u200b\u4ee3\u7406\u200b\u7684\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#docker","title":"Docker \u200b\u90e8\u7f72","text":"<p>\u200b\u5f00\u53d1\u200b\u7ec4\u4e3a\u200b\u5f00\u53d1\u8005\u200b\u4eec\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u952e\u200b\u90e8\u7f72\u200b\u7684\u200b docker \u200b\u955c\u50cf\u6587\u4ef6\u200b\u61d2\u4eba\u200b\u5305\u200b\u3002\u200b\u5f00\u53d1\u8005\u200b\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b AutoDL \u200b\u5e73\u53f0\u200b\u548c\u200b Docker \u200b\u5e73\u53f0\u200b\u4e00\u952e\u200b\u90e8\u7f72\u200b\u3002</p> <p>\ud83c\udf10 AutoDL \u200b\u955c\u50cf\u200b </p> <p>\ud83d\udc33 Docker \u200b\u955c\u50cf\u200b</p> <p>\ud83d\udcbb \u200b\u4e00\u884c\u200b\u547d\u4ee4\u200b\u8fd0\u884c\u200b Docker \ud83c\udf32\uff1a</p> <pre><code>docker run -d --gpus all -p 80:8501 registry.cn-beijing.aliyuncs.com/chatchat/chatchat:0.2.6\n</code></pre> <ul> <li>\u200b\u8be5\u200b\u7248\u672c\u200b\u955c\u50cf\u200b\u5927\u5c0f\u200b <code>43.1GB</code>\uff0c\u200b\u4f7f\u7528\u200b <code>v0.2.6</code>\uff0c\u200b\u4ee5\u200b <code>nvidia/cuda:12.1.1-cudnn8-devel-ubuntu22.04</code> \u200b\u4e3a\u200b\u57fa\u7840\u200b\u955c\u50cf\u200b</li> <li>\u200b\u8be5\u200b\u7248\u672c\u200b\u4e3a\u200b\u6b63\u5e38\u200b\u7248\u672c\u200b\uff0c\u200b\u975e\u200b\u8f7b\u91cf\u5316\u200b\u7248\u672c\u200b</li> <li>\u200b\u8be5\u200b\u7248\u672c\u200b\u5185\u7f6e\u200b\u4e24\u4e2a\u200b Embedding \u200b\u6a21\u578b\u200b\uff1a<code>m3e-large</code>\uff0c<code>text2vec-bge-large-chinese</code>\uff0c\u200b\u9ed8\u8ba4\u200b\u542f\u7528\u200b\u540e\u8005\u200b\uff0c\u200b\u5185\u7f6e\u200b <code>chatglm2-6b-32k</code></li> <li>\u200b\u8be5\u200b\u7248\u672c\u200b\u76ee\u6807\u200b\u4e3a\u200b\u65b9\u4fbf\u200b\u4e00\u952e\u200b\u90e8\u7f72\u200b\u4f7f\u7528\u200b\uff0c\u200b\u8bf7\u200b\u786e\u4fdd\u60a8\u200b\u5df2\u7ecf\u200b\u5728\u200b Linux \u200b\u53d1\u884c\u7248\u200b\u4e0a\u200b\u5b89\u88c5\u200b\u4e86\u200b NVIDIA \u200b\u9a71\u52a8\u7a0b\u5e8f\u200b</li> <li>\u200b\u8bf7\u200b\u6ce8\u610f\u200b\uff0c\u200b\u60a8\u200b\u4e0d\u200b\u9700\u8981\u200b\u5728\u200b\u4e3b\u673a\u200b\u7cfb\u7edf\u200b\u4e0a\u200b\u5b89\u88c5\u200b CUDA \u200b\u5de5\u5177\u5305\u200b\uff0c\u200b\u4f46\u200b\u9700\u8981\u200b\u5b89\u88c5\u200b <code>NVIDIA Driver</code> \u200b\u4ee5\u53ca\u200b <code>NVIDIA Container Toolkit</code>\uff0c\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b89\u88c5\u200b\u6307\u5357\u200b</li> <li>\u200b\u9996\u6b21\u200b\u62c9\u53d6\u200b\u548c\u200b\u542f\u52a8\u200b\u5747\u200b\u9700\u8981\u200b\u4e00\u5b9a\u200b\u65f6\u95f4\u200b\uff0c\u200b\u9996\u6b21\u200b\u542f\u52a8\u200b\u65f6\u8bf7\u200b\u53c2\u7167\u200b\u4e0b\u56fe\u200b\u4f7f\u7528\u200b <code>docker logs -f &lt;container id&gt;</code> \u200b\u67e5\u770b\u200b\u65e5\u5fd7\u200b</li> <li>\u200b\u5982\u200b\u9047\u5230\u200b\u542f\u52a8\u200b\u8fc7\u7a0b\u200b\u5361\u200b\u5728\u200b <code>Waiting..</code> \u200b\u6b65\u9aa4\u200b\uff0c\u200b\u5efa\u8bae\u200b\u4f7f\u7528\u200b <code>docker exec -it &lt;container id&gt; bash</code> \u200b\u8fdb\u5165\u200b <code>/logs/</code> \u200b\u76ee\u5f55\u200b\u67e5\u770b\u200b\u5bf9\u5e94\u200b\u9636\u6bb5\u200b\u65e5\u5fd7\u200b</li> </ul>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_3","title":"\u5e38\u89c4\u200b\u6a21\u5f0f\u200b\u672c\u5730\u200b\u90e8\u7f72\u200b\u65b9\u6848","text":"<p><pre><code># \u200b\u9996\u5148\u200b\uff0c\u200b\u786e\u4fe1\u200b\u4f60\u200b\u7684\u200b\u673a\u5668\u200b\u5b89\u88c5\u200b\u4e86\u200b Python 3.8 - 3.10 \u200b\u7248\u672c\u200b\n$ python --version\nPython 3.8.13\n\n# \u200b\u5982\u679c\u200b\u4f4e\u4e8e\u200b\u8fd9\u4e2a\u200b\u7248\u672c\u200b\uff0c\u200b\u53ef\u200b\u4f7f\u7528\u200bconda\u200b\u5b89\u88c5\u200b\u73af\u5883\u200b\n$ conda create -p /your_path/env_name python=3.8\n\n# \u200b\u6fc0\u6d3b\u200b\u73af\u5883\u200b\n$ source activate /your_path/env_name\n\n# \u200b\u6216\u200b\uff0cconda\u200b\u5b89\u88c5\u200b\uff0c\u200b\u4e0d\u200b\u6307\u5b9a\u200b\u8def\u5f84\u200b, \u200b\u6ce8\u610f\u200b\u4ee5\u4e0b\u200b\uff0c\u200b\u90fd\u200b\u5c06\u200b/your_path/env_name\u200b\u66ff\u6362\u200b\u4e3a\u200benv_name\n$ conda create -n env_name python=3.8\n$ conda activate env_name # Activate the environment\n\n# \u200b\u66f4\u65b0\u200bpy\u200b\u5e93\u200b\n$ pip3 install --upgrade pip\n\n# \u200b\u5173\u95ed\u200b\u73af\u5883\u200b\n$ source deactivate /your_path/env_name\n\n# \u200b\u5220\u9664\u200b\u73af\u5883\u200b\n$ conda env remove -p  /your_path/env_name\n</code></pre> \u200b\u63a5\u7740\u200b\uff0c\u200b\u5f00\u59cb\u200b\u5b89\u88c5\u200b\u9879\u76ee\u200b\u7684\u200b\u4f9d\u8d56\u200b</p> <pre><code># \u200b\u62c9\u53d6\u200b\u4ed3\u5e93\u200b\n$ git clone --recursive https://github.com/chatchat-space/Langchain-Chatchat.git\n\n# \u200b\u8fdb\u5165\u200b\u76ee\u5f55\u200b\n$ cd Langchain-Chatchat\n\n# \u200b\u5b89\u88c5\u200b\u5168\u90e8\u200b\u4f9d\u8d56\u200b\n$ pip install -r requirements.txt\n\n# \u200b\u9ed8\u8ba4\u200b\u4f9d\u8d56\u200b\u5305\u62ec\u200b\u57fa\u672c\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff08FAISS\u200b\u5411\u91cf\u200b\u5e93\u200b\uff09\u3002\u200b\u5982\u679c\u200b\u8981\u200b\u4f7f\u7528\u200b milvus/pg_vector \u200b\u7b49\u200b\u5411\u91cf\u200b\u5e93\u200b\uff0c\u200b\u8bf7\u200b\u5c06\u200b requirements.txt \u200b\u4e2d\u200b\u76f8\u5e94\u200b\u4f9d\u8d56\u200b\u53d6\u6d88\u200b\u6ce8\u91ca\u200b\u518d\u200b\u5b89\u88c5\u200b\u3002\n</code></pre> <p>\u200b\u6b64\u5916\u200b\uff0c\u200b\u4e3a\u200b\u65b9\u4fbf\u200b\u7528\u6237\u200b API \u200b\u4e0e\u200b webui \u200b\u5206\u79bb\u200b\u8fd0\u884c\u200b\uff0c\u200b\u53ef\u200b\u5355\u72ec\u200b\u6839\u636e\u200b\u8fd0\u884c\u200b\u9700\u6c42\u200b\u5b89\u88c5\u200b\u4f9d\u8d56\u200b\u5305\u200b\u3002</p> <ul> <li> <p>\u200b\u5982\u679c\u200b\u53ea\u200b\u9700\u200b\u8fd0\u884c\u200b API\uff0c\u200b\u53ef\u200b\u6267\u884c\u200b\uff1a     <pre><code>$ pip install -r requirements_api.txt\n\n# \u200b\u9ed8\u8ba4\u200b\u4f9d\u8d56\u200b\u5305\u62ec\u200b\u57fa\u672c\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff08FAISS\u200b\u5411\u91cf\u200b\u5e93\u200b\uff09\u3002\u200b\u5982\u679c\u200b\u8981\u200b\u4f7f\u7528\u200b milvus/pg_vector \u200b\u7b49\u200b\u5411\u91cf\u200b\u5e93\u200b\uff0c\u200b\u8bf7\u200b\u5c06\u200b requirements.txt \u200b\u4e2d\u200b\u76f8\u5e94\u200b\u4f9d\u8d56\u200b\u53d6\u6d88\u200b\u6ce8\u91ca\u200b\u518d\u200b\u5b89\u88c5\u200b\u3002\n</code></pre></p> </li> <li> <p>\u200b\u5982\u679c\u200b\u53ea\u200b\u9700\u200b\u8fd0\u884c\u200b WebUI\uff0c\u200b\u53ef\u200b\u6267\u884c\u200b\uff1a     <pre><code>$ pip install -r requirements_webui.txt\n</code></pre></p> </li> </ul> <p>\u200b\u6ce8\u200b\uff1a\u200b\u4f7f\u7528\u200b <code>langchain.document_loaders.UnstructuredFileLoader</code>\u200b\u8fdb\u884c\u200b <code>.docx</code> \u200b\u7b49\u200b\u683c\u5f0f\u200b\u975e\u200b\u7ed3\u6784\u5316\u200b\u6587\u4ef6\u200b\u63a5\u5165\u200b\u65f6\u200b\uff0c\u200b\u53ef\u80fd\u200b\u9700\u8981\u200b\u4f9d\u636e\u200b\u6587\u6863\u200b\u8fdb\u884c\u200b\u5176\u4ed6\u200b\u4f9d\u8d56\u200b\u5305\u200b\u7684\u200b\u5b89\u88c5\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u8003\u200b langchain \u200b\u6587\u6863\u200b\u3002</p> <p>\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u4ee5\u4e0b\u200b\u4f9d\u8d56\u200b\uff0c\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u6e90\u7801\u200b\u5b89\u88c5\u200b\u4f9d\u8d56\u200b\u6216\u8005\u200b\u5b9a\u671f\u68c0\u67e5\u200b\u662f\u5426\u200b\u4e3a\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\uff0c\u200b\u6211\u4eec\u200b\u7684\u200b\u6846\u67b6\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5927\u91cf\u200b\u4f7f\u7528\u200b\u8fd9\u4e9b\u200b\u4f9d\u8d56\u200b\u7684\u200b\u6700\u65b0\u200b\u7279\u6027\u200b\u3002 + transformers + fastchat + fastapi + streamlit \u200b\u4ee5\u53ca\u200b\u5176\u200b\u7ec4\u4ef6\u200b + langchain \u200b\u4ee5\u53ca\u200b\u5176\u200b\u7ec4\u4ef6\u200b + xformers </p>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_4","title":"\u6a21\u578b\u200b\u4e0b\u8f7d","text":"<p>\u200b\u5982\u9700\u200b\u5728\u200b\u672c\u5730\u200b\u6216\u200b\u79bb\u7ebf\u200b\u73af\u5883\u200b\u4e0b\u200b\u8fd0\u884c\u200b\u672c\u200b\u9879\u76ee\u200b\uff0c\u200b\u9700\u8981\u200b\u9996\u5148\u200b\u5c06\u200b\u9879\u76ee\u200b\u6240\u200b\u9700\u200b\u7684\u200b\u6a21\u578b\u200b\u4e0b\u8f7d\u200b\u81f3\u200b\u672c\u5730\u200b\uff0c\u200b\u901a\u5e38\u200b\u5f00\u6e90\u200b LLM \u200b\u4e0e\u200b Embedding \u200b\u6a21\u578b\u200b\u53ef\u4ee5\u200b\u4ece\u200b HuggingFace \u200b\u4e0b\u8f7d\u200b\u3002</p> <p>\u200b\u4ee5\u672c\u200b\u9879\u76ee\u200b\u4e2d\u200b\u9ed8\u8ba4\u200b\u4f7f\u7528\u200b\u7684\u200b  LLM \u200b\u6a21\u578b\u200b THUDM/ChatGLM3-6B \u200b\u4e0e\u200b Embedding \u200b\u6a21\u578b\u200b BAAI/bge-large-zh \u200b\u4e3a\u4f8b\u200b\uff1a</p> <p>\u200b\u4e0b\u8f7d\u200b\u6a21\u578b\u200b\u9700\u8981\u200b\u5148\u200b\u5b89\u88c5\u200bGit LFS\uff0c\u200b\u7136\u540e\u200b\u8fd0\u884c\u200b</p> <pre><code>$ git lfs install\n$ git clone https://www.modelscope.cn/ZhipuAI/chatglm3-6b.git\n$ git clone https://www.modelscope.cn/AI-ModelScope/bge-large-zh.git\n</code></pre>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_5","title":"\u521d\u59cb\u5316\u200b\u77e5\u8bc6\u5e93","text":"<p>\u200b\u5f53\u524d\u200b\u9879\u76ee\u200b\u7684\u200b\u77e5\u8bc6\u5e93\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u5728\u200b\u6570\u636e\u5e93\u200b\u4e2d\u200b\uff0c\u200b\u5728\u200b\u6b63\u5f0f\u200b\u8fd0\u884c\u200b\u9879\u76ee\u200b\u4e4b\u524d\u200b\u8bf7\u200b\u5148\u200b\u521d\u59cb\u5316\u200b\u6570\u636e\u5e93\u200b\uff08\u200b\u6211\u4eec\u200b\u5f3a\u70c8\u5efa\u8bae\u200b\u60a8\u200b\u5728\u200b\u6267\u884c\u200b\u64cd\u4f5c\u524d\u200b\u5907\u4efd\u200b\u60a8\u200b\u7684\u200b\u77e5\u8bc6\u200b\u6587\u4ef6\u200b\uff09\u3002 - \u200b\u5982\u679c\u200b\u60a8\u200b\u5df2\u7ecf\u200b\u6709\u200b\u521b\u5efa\u200b\u8fc7\u200b\u77e5\u8bc6\u5e93\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5148\u200b\u6267\u884c\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u521b\u5efa\u200b\u6216\u200b\u66f4\u65b0\u200b\u6570\u636e\u5e93\u200b\u8868\u200b\uff1a   <pre><code>$ python init_database.py --create-tables\n</code></pre>   \u200b\u5982\u679c\u200b\u53ef\u4ee5\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b\uff0c\u200b\u5219\u200b\u65e0\u9700\u200b\u518d\u200b\u91cd\u5efa\u200b\u77e5\u8bc6\u5e93\u200b\u3002</p> <ul> <li>\u200b\u5982\u679c\u200b\u60a8\u200b\u662f\u200b\u7b2c\u4e00\u6b21\u200b\u8fd0\u884c\u200b\u672c\u200b\u9879\u76ee\u200b\uff0c\u200b\u77e5\u8bc6\u5e93\u200b\u5c1a\u672a\u200b\u5efa\u7acb\u200b\uff0c\u200b\u6216\u8005\u200b\u4e4b\u524d\u200b\u4f7f\u7528\u200b\u7684\u200b\u662f\u200b\u4f4e\u4e8e\u200b\u6700\u65b0\u200bmaster\u200b\u5206\u652f\u200b\u7248\u672c\u200b\u7684\u200b\u6846\u67b6\u200b\uff0c\u200b\u6216\u8005\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u77e5\u8bc6\u5e93\u200b\u7c7b\u578b\u200b\u3001\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b\u53d1\u751f\u53d8\u5316\u200b\uff0c\u200b\u6216\u8005\u200b\u4e4b\u524d\u200b\u7684\u200b\u5411\u91cf\u200b\u5e93\u200b\u6ca1\u6709\u200b\u5f00\u542f\u200b <code>normalize_L2</code>\uff0c\u200b\u9700\u8981\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u521d\u59cb\u5316\u200b\u6216\u200b\u91cd\u5efa\u200b\u77e5\u8bc6\u5e93\u200b\uff1a</li> </ul> <pre><code>$ python init_database.py --recreate-vs\n</code></pre>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_6","title":"\u4e00\u952e\u200b\u542f\u52a8","text":"<p>\u200b\u542f\u52a8\u200b\u524d\u200b\uff0c\u200b\u786e\u4fdd\u200b\u5df2\u7ecf\u200b\u6309\u7167\u200b\u53c2\u6570\u200b\u914d\u7f6e\u200b\u6b63\u786e\u200b\u914d\u7f6e\u200b\u5404\u200bconfig\u200b\u6a21\u5757\u200b\u3002</p> <p>\u200b\u4e00\u952e\u200b\u542f\u52a8\u200b\u811a\u672c\u200b startup.py\uff0c \u200b\u4e00\u952e\u200b\u542f\u52a8\u200b\u6240\u6709\u200b Fastchat \u200b\u670d\u52a1\u200b\u3001API \u200b\u670d\u52a1\u200b\u3001WebUI \u200b\u670d\u52a1\u200b\uff0c\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code>$ python startup.py -a\n</code></pre> <p>\u200b\u5e76\u200b\u53ef\u200b\u4f7f\u7528\u200b <code>Ctrl + C</code> \u200b\u76f4\u63a5\u200b\u5173\u95ed\u200b\u6240\u6709\u200b\u8fd0\u884c\u200b\u670d\u52a1\u200b\u3002\u200b\u5982\u679c\u200b\u4e00\u6b21\u200b\u7ed3\u675f\u200b\u4e0d\u4e86\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u591a\u200b\u6309\u200b\u51e0\u6b21\u200b\u3002</p> <p>\u200b\u53ef\u200b\u9009\u200b\u53c2\u6570\u200b\u5305\u62ec\u200b <code>-a (\u200b\u6216\u200b--all-webui)</code>, <code>--all-api</code>, <code>--llm-api</code>, <code>-c (\u200b\u6216\u200b--controller)</code>, <code>--openai-api</code>, <code>-m (\u200b\u6216\u200b--model-worker)</code>, <code>--api</code>, <code>--webui</code>\uff0c\u200b\u5176\u4e2d\u200b\uff1a</p> <ul> <li><code>--all-webui</code> \u200b\u4e3a\u200b\u4e00\u952e\u200b\u542f\u52a8\u200b WebUI \u200b\u6240\u6709\u200b\u4f9d\u8d56\u200b\u670d\u52a1\u200b\uff1b</li> <li><code>--all-api</code> \u200b\u4e3a\u200b\u4e00\u952e\u200b\u542f\u52a8\u200b API \u200b\u6240\u6709\u200b\u4f9d\u8d56\u200b\u670d\u52a1\u200b\uff1b</li> <li><code>--llm-api</code> \u200b\u4e3a\u200b\u4e00\u952e\u200b\u542f\u52a8\u200b Fastchat \u200b\u6240\u6709\u200b\u4f9d\u8d56\u200b\u7684\u200b LLM \u200b\u670d\u52a1\u200b\uff1b</li> <li><code>--openai-api</code> \u200b\u4e3a\u200b\u4ec5\u200b\u542f\u52a8\u200b FastChat \u200b\u7684\u200b controller \u200b\u548c\u200b openai-api-server \u200b\u670d\u52a1\u200b\uff1b</li> <li>\u200b\u5176\u4ed6\u200b\u4e3a\u200b\u5355\u72ec\u200b\u670d\u52a1\u200b\u542f\u52a8\u200b\u9009\u9879\u200b\u3002</li> </ul> <p>\u200b\u82e5\u60f3\u200b\u6307\u5b9a\u200b\u975e\u200b\u9ed8\u8ba4\u200b\u6a21\u578b\u200b\uff0c\u200b\u9700\u8981\u200b\u7528\u200b <code>--model-name</code> \u200b\u9009\u9879\u200b\uff0c\u200b\u793a\u4f8b\u200b\uff1a</p> <pre><code>$ python startup.py --all-webui --model-name Qwen-7B-Chat\n</code></pre> <p>\u200b\u66f4\u200b\u591a\u200b\u4fe1\u606f\u200b\u53ef\u200b\u901a\u8fc7\u200b <code>python startup.py -h</code> \u200b\u67e5\u770b\u200b\u3002</p>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_7","title":"\u591a\u5361\u200b\u52a0\u8f7d","text":"<p>\u200b\u9879\u76ee\u200b\u652f\u6301\u200b\u591a\u5361\u200b\u52a0\u8f7d\u200b\uff0c\u200b\u9700\u5728\u200b startup.py \u200b\u4e2d\u200b\u7684\u200b create_model_worker_app \u200b\u51fd\u6570\u200b\u4e2d\u200b\uff0c\u200b\u4fee\u6539\u200b\u5982\u4e0b\u200b\u4e09\u4e2a\u200b\u53c2\u6570\u200b:</p> <pre><code>gpus=None, \nnum_gpus= 1, \nmax_gpu_memory=\"20GiB\"\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c<code>gpus</code> \u200b\u63a7\u5236\u200b\u4f7f\u7528\u200b\u7684\u200b\u663e\u5361\u200b\u7684\u200bID\uff0c\u200b\u4f8b\u5982\u200b \"0,1\";</p> <p><code>num_gpus</code> \u200b\u63a7\u5236\u200b\u4f7f\u7528\u200b\u7684\u200b\u5361\u6570\u200b;</p> <p><code>max_gpu_memory</code> \u200b\u63a7\u5236\u200b\u6bcf\u4e2a\u200b\u5361\u200b\u4f7f\u7528\u200b\u7684\u200b\u663e\u5b58\u200b\u5bb9\u91cf\u200b\u3002</p> <p>\u200b\u6ce8\u200b1\uff1aserver_config.py\u200b\u7684\u200bFSCHAT_MODEL_WORKERS\u200b\u5b57\u5178\u200b\u4e2d\u200b\u4e5f\u200b\u589e\u52a0\u200b\u4e86\u200b\u76f8\u5173\u200b\u914d\u7f6e\u200b\uff0c\u200b\u5982\u200b\u6709\u200b\u9700\u8981\u200b\u4e5f\u200b\u53ef\u200b\u901a\u8fc7\u200b\u4fee\u6539\u200bFSCHAT_MODEL_WORKERS\u200b\u5b57\u5178\u200b\u4e2d\u200b\u5bf9\u5e94\u200b\u53c2\u6570\u200b\u5b9e\u73b0\u200b\u591a\u5361\u200b\u52a0\u8f7d\u200b\uff0c\u200b\u4e14\u200b\u9700\u6ce8\u610f\u200bserver_config.py\u200b\u7684\u200b\u914d\u7f6e\u200b\u4f1a\u200b\u8986\u76d6\u200bcreate_model_worker_app \u200b\u51fd\u6570\u200b\u7684\u200b\u914d\u7f6e\u200b\u3002</p> <p>\u200b\u6ce8\u200b2\uff1a\u200b\u5c11\u6570\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0cgpus\u200b\u53c2\u6570\u200b\u4f1a\u200b\u4e0d\u200b\u751f\u6548\u200b\uff0c\u200b\u6b64\u65f6\u200b\u9700\u8981\u200b\u901a\u8fc7\u200b\u8bbe\u7f6e\u200b\u73af\u5883\u53d8\u91cf\u200bCUDA_VISIBLE_DEVICES\u200b\u6765\u200b\u6307\u5b9a\u200btorch\u200b\u53ef\u89c1\u200b\u7684\u200bgpu,\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code>CUDA_VISIBLE_DEVICES=0,1 python startup.py -a\n</code></pre>"},{"location":"1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/#_8","title":"\u6700\u200b\u8f7b\u200b\u6a21\u5f0f\u200b\u672c\u5730\u200b\u90e8\u7f72\u200b\u65b9\u6848","text":"<p>\u200b\u8be5\u200b\u6a21\u5f0f\u200b\u7684\u200b\u914d\u7f6e\u200b\u65b9\u5f0f\u200b\u4e0e\u200b\u5e38\u89c4\u200b\u6a21\u5f0f\u200b\u76f8\u540c\u200b\uff0c\u200b\u4f46\u200b\u65e0\u9700\u200b\u5b89\u88c5\u200b <code>torch</code> \u200b\u7b49\u200b\u91cd\u200b\u4f9d\u8d56\u200b\uff0c\u200b\u901a\u8fc7\u200b\u5728\u7ebf\u200bAPI\u200b\u5b9e\u73b0\u200b LLM \u200b\u548c\u200b Ebeddings \u200b\u76f8\u5173\u200b\u529f\u80fd\u200b\uff0c\u200b\u9002\u5408\u200b\u6ca1\u6709\u200b\u663e\u5361\u200b\u7684\u200b\u7535\u8111\u200b\u4f7f\u7528\u200b\u3002</p> <pre><code>$ pip install -r requirements_lite.txt\n$ python startup.py -a --lite\n</code></pre> <p>\u200b\u8be5\u200b\u6a21\u5f0f\u200b\u652f\u6301\u200b\u7684\u200b\u5728\u7ebf\u200b Embeddings \u200b\u5305\u62ec\u200b\uff1a - \u200b\u667a\u8c31\u200bAI - MiniMax - \u200b\u767e\u5ea6\u200b\u5343\u5e06\u200b - \u200b\u963f\u91cc\u200b\u4e91\u200b\u901a\u4e49\u200b\u5343\u95ee\u200b</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u5728\u200b\u5bf9\u8bdd\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u5e76\u200b\u4e0d\u200b\u8981\u6c42\u200b LLM \u200b\u6a21\u578b\u200b\u4e0e\u200b Embeddings \u200b\u6a21\u578b\u200b\u4e00\u81f4\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200b\u77e5\u8bc6\u5e93\u200b\u7ba1\u7406\u200b\u9875\u9762\u200b\u4e2d\u200b\u4f7f\u7528\u200b zhipu-api \u200b\u4f5c\u4e3a\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b\uff0c\u200b\u5728\u200b\u77e5\u8bc6\u5e93\u200b\u5bf9\u8bdd\u200b\u9875\u9762\u200b\u4f7f\u7528\u200b\u5176\u5b83\u200b\u6a21\u578b\u200b\u3002</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/","title":"2 \u200b\u53c2\u6570\u200b\u914d\u7f6e","text":"<p>\u200b\u5728\u200b\u5f00\u59cb\u200b\u53c2\u6570\u200b\u914d\u7f6e\u200b\u4e4b\u524d\u200b\uff0c\u200b\u5148\u200b\u6267\u884c\u200b\u4ee5\u4e0b\u200b\u811a\u672c\u200b <pre><code>python copy_config_example.py\n</code></pre> \u200b\u8be5\u200b\u811a\u672c\u200b\u5c06\u4f1a\u200b\u5c06\u200b\u6240\u6709\u200b<code>config</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u6837\u4f8b\u200b\u590d\u5236\u200b\u4e00\u4efd\u200b\u5230\u200b<code>config</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u5f00\u53d1\u8005\u200b\u8fdb\u884c\u200b\u914d\u7f6e\u200b\u3002 \u200b\u63a5\u7740\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u53ef\u4ee5\u200b\u6839\u636e\u200b\u81ea\u5df1\u200b\u7684\u200b\u9700\u6c42\u200b\uff0c\u200b\u5bf9\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\u3002</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#basic_configpy","title":"\u57fa\u7840\u200b\u914d\u7f6e\u200b\u9879\u200b basic_config.py","text":"<p>\u200b\u8be5\u200b\u914d\u7f6e\u200b\u57fa\u200b\u8d1f\u8d23\u200b\u8bb0\u5f55\u200b\u65e5\u5fd7\u200b\u7684\u200b\u683c\u5f0f\u200b\u548c\u200b\u50a8\u5b58\u200b\u8def\u5f84\u200b\uff0c\u200b\u901a\u5e38\u200b\u4e0d\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u3002</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#model_configpy","title":"\u6a21\u578b\u200b\u914d\u7f6e\u200b\u9879\u200b model_config.py","text":"<p>\u200b\u672c\u200b\u6587\u4ef6\u200b\u5305\u542b\u200b\u672c\u5730\u200bLLM\u200b\u6a21\u578b\u200b\u3001\u200b\u672c\u5730\u200bEmbeddings\u200b\u6a21\u578b\u200b\u3001\u200b\u5728\u7ebf\u200bLLM\u200b\u6a21\u578b\u200bAPI\u200b\u7684\u200b\u76f8\u5173\u200b\u914d\u7f6e\u200b\u3002</p> <ul> <li>\u200b\u672c\u5730\u200b\u6a21\u578b\u200b\u8def\u5f84\u200b\u914d\u7f6e\u200b\u3002\u200b\u5efa\u8bae\u200b\u5c06\u200b\u6240\u6709\u200b\u4e0b\u8f7d\u200b\u7684\u200b\u6a21\u578b\u200b\u653e\u5230\u200b\u4e00\u4e2a\u200b\u7edf\u4e00\u200b\u7684\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u7136\u540e\u200b\u5c06\u200b<code>MODEL_ROOT_PATH</code>\u200b\u6307\u5b9a\u200b\u4e3a\u200b\u8be5\u200b\u76ee\u5f55\u200b\uff0c\u200b\u53ea\u8981\u200b\u6a21\u578b\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b\u7b26\u5408\u200b\u4e0b\u5217\u200b\u60c5\u51b5\u200b\u4e4b\u4e00\u200b\uff08\u200b\u4ee5\u200btext2vec\u200b\u4e3a\u4f8b\u200b\uff09\uff0c\u200b\u5373\u53ef\u200b\u81ea\u52a8\u8bc6\u522b\u200b\u52a0\u8f7d\u200b\uff1a</li> <li>text2vec\uff0c\u200b\u5373\u200bMODEL_PATH\u200b\u4e2d\u200b\u7684\u200b\u952e\u200b</li> <li>GanymedeNil/text2vec-large-chinese\uff0c\u200b\u5373\u200bMODEL_PATH\u200b\u4e2d\u200b\u7684\u200b\u503c\u200b</li> <li> <p>text2vec-large-chinese\uff0c\u200b\u5373\u200bMODEL_PATH\u200b\u4e2d\u200b\u7684\u200b\u503c\u200b\u7684\u200b\u7b80\u5199\u200b\u5f62\u5f0f\u200b</p> </li> <li> <p>\u200b\u5728\u7ebf\u200b\u6a21\u578b\u200bAPI\u200b\u914d\u7f6e\u200b\u3002\u200b\u5728\u200b<code>ONLINE_LLM_MODEL</code>\u200b\u5df2\u7ecf\u200b\u9884\u5148\u200b\u5199\u200b\u597d\u200b\u4e86\u200b\u6240\u6709\u200b\u652f\u6301\u200b\u7684\u200b\u5728\u7ebf\u200bAPI\u200b\u670d\u52a1\u200b\uff0c\u200b\u901a\u5e38\u200b\u53ea\u200b\u9700\u8981\u200b\u628a\u200b\u7533\u8bf7\u200b\u7684\u200bAPI_KEY\u200b\u7b49\u200b\u586b\u5165\u200b\u5373\u53ef\u200b\u3002 \u200b\u6709\u4e9b\u200b\u5728\u7ebf\u200bAPI\u200b\u670d\u52a1\u200b\u9700\u8981\u200b\u5b89\u88c5\u200b\u989d\u5916\u200b\u7684\u200b\u4f9d\u8d56\u200b\uff1a</p> </li> <li>zhipu-api: zhipuai</li> <li>fangzhou-api: volcengine&gt;=1.0.106</li> <li>qianfan-api: qianfan</li> <li> <p>qwen-api: dashscope</p> </li> <li> <p>HISTORY_LEN\u3002\u200b\u5386\u53f2\u200b\u5bf9\u8bdd\u200b\u8f6e\u6570\u200b\u901a\u5e38\u200b\u4e0d\u200b\u5efa\u8bae\u200b\u8bbe\u7f6e\u200b\u8d85\u8fc7\u200b10\uff0c\u200b\u56e0\u4e3a\u200b\u8fd9\u200b\u53ef\u80fd\u200b\u5bfc\u81f4\u200b\u4ee5\u4e0b\u200b\u95ee\u9898\u200b</p> </li> <li>\u200b\u663e\u5b58\u200b\u5360\u7528\u200b\u8fc7\u9ad8\u200b\uff1a\u200b\u5c24\u5176\u200b\u662f\u200b\u90e8\u5206\u200b\u6a21\u578b\u200b\uff0c\u200b\u672c\u8eab\u200b\u5c31\u200b\u5df2\u7ecf\u200b\u8981\u200b\u5360\u7528\u200b\u6ee1\u200b\u663e\u5b58\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u4fdd\u7559\u200b\u592a\u200b\u591a\u200b\u5386\u53f2\u200b\uff0c\u200b\u4e00\u6b21\u200b\u4f20\u5165\u200btoken\u200b\u592a\u200b\u591a\u200b\uff0c\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u7206\u200b\u663e\u5b58\u200b\u3002</li> <li> <p>\u200b\u901f\u5ea6\u200b\u5904\u7406\u200b\u5f88\u200b\u6162\u200b\uff1a\u200b\u8fd8\u662f\u200b\u56e0\u4e3a\u200b\u4e00\u6b21\u200b\u4f20\u5165\u200b\u4e86\u200b\u592a\u200b\u591a\u200btoken\uff0c\u200b\u5bfc\u81f4\u200b\u901f\u5ea6\u200b\u5f88\u200b\u6162\u200b\u3002</p> </li> <li> <p>TEMPERATURE\u3002\u200b\u901a\u5e38\u200b\u4e0d\u200b\u5efa\u8bae\u200b\u8bbe\u7f6e\u200b\u8fc7\u9ad8\u200b\u3002 \u200b\u5728\u200bAgent\u200b\u5bf9\u8bdd\u200b\u6a21\u5f0f\u200b\u548c\u200b\u77e5\u8bc6\u5e93\u200b\u95ee\u7b54\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5f3a\u70c8\u5efa\u8bae\u200b\u5c06\u8981\u200b\u5176\u200b\u8bbe\u7f6e\u200b\u6210\u200b0\u200b\u6216\u8005\u200b\u63a5\u8fd1\u200b\u4e8e\u200b0\u3002</p> </li> <li> <p>Agent_MODEL = None \u200b\u6211\u4eec\u200b\u652f\u6301\u200b\u7528\u6237\u200b\u4f7f\u7528\u200b\u201c\u200b\u6a21\u578b\u200b\u63a5\u529b\u8d5b\u200b\u201d\u200b\u7684\u200b\u7528\u6cd5\u200b\uff0c\u200b\u5373\u200b\uff1a \u200b\u9009\u62e9\u200b\u7684\u200b\u5927\u200b\u6a21\u578b\u200b\u4ec5\u80fd\u200b\u8c03\u7528\u200b\u5de5\u5177\u200b\uff0c\u200b\u4f46\u662f\u200b\u5728\u200b\u5de5\u5177\u200b\u4e2d\u200b\u8868\u73b0\u200b\u8f83\u5dee\u200b\uff0c\u200b\u5219\u200b\u8fd9\u4e2a\u200b\u5de5\u5177\u200b\u4f5c\u4e3a\u200b \u201c\u200b\u6a21\u578b\u200b\u8c03\u7528\u200b\u5de5\u5177\u200b\u201d \u200b\u5982\u679c\u200b\u7528\u6237\u200b\u8bbe\u7f6e\u200b\u4e86\u200bAgent_MODEL\uff0c\u200b\u5219\u200b\u5728\u200b Agent \u200b\u4e2d\u200b\uff0c\u200b\u4f7f\u7528\u200bAgent_MODEL\u200b\u6765\u200b\u6267\u884c\u200b\u4efb\u52a1\u200b\uff0c\u200b\u5426\u5219\u200b\uff0c\u200b\u4f7f\u7528\u200bLLM_MODEL</p> </li> </ul>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#prompt_configpy","title":"\u63d0\u793a\u200b\u8bcd\u200b\u914d\u7f6e\u200b\u9879\u200b prompt_config.py","text":"<p>\u200b\u63d0\u793a\u200b\u8bcd\u200b\u914d\u7f6e\u200b\u5206\u4e3a\u200b\u4e09\u4e2a\u200b\u677f\u5757\u200b\uff0c\u200b\u5206\u522b\u200b\u5bf9\u5e94\u200b\u4e09\u79cd\u200b\u804a\u5929\u200b\u7c7b\u578b\u200b\u3002 - llm_chat: \u200b\u57fa\u7840\u200b\u7684\u200b\u5bf9\u8bdd\u200b\u63d0\u793a\u200b\u8bcd\u200b\uff0c \u200b\u901a\u5e38\u200b\u6765\u8bf4\u200b\uff0c\u200b\u76f4\u63a5\u200b\u662f\u200b\u7528\u6237\u200b\u8f93\u5165\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u6ca1\u6709\u200b\u7cfb\u7edf\u200b\u63d0\u793a\u200b\u8bcd\u200b\u3002 - knowledge_base_chat: \u200b\u4e0e\u200b\u77e5\u8bc6\u5e93\u200b\u5bf9\u8bdd\u200b\u7684\u200b\u63d0\u793a\u200b\u8bcd\u200b\uff0c\u200b\u5728\u200b\u6a21\u677f\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e3a\u200b\u5f00\u53d1\u8005\u200b\u8bbe\u8ba1\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u7cfb\u7edf\u200b\u63d0\u793a\u200b\u8bcd\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u66f4\u6539\u200b\u3002 - agent_chat: \u200b\u4e0e\u200bAgent\u200b\u5bf9\u8bdd\u200b\u7684\u200b\u63d0\u793a\u200b\u8bcd\u200b\uff0c\u200b\u540c\u6837\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e3a\u200b\u5f00\u53d1\u8005\u200b\u8bbe\u8ba1\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u7cfb\u7edf\u200b\u63d0\u793a\u200b\u8bcd\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u66f4\u6539\u200b\u3002</p> <p>prompt\u200b\u6a21\u677f\u200b\u4f7f\u7528\u200bJinja2\u200b\u8bed\u6cd5\u200b\uff0c\u200b\u7b80\u5355\u200b\u70b9\u200b\u5c31\u662f\u200b\u7528\u200b\u53cc\u200b\u5927\u62ec\u53f7\u200b\u4ee3\u66ff\u200bf-string\u200b\u7684\u200b\u5355\u200b\u5927\u62ec\u53f7\u200b \u200b\u8bf7\u200b\u6ce8\u610f\u200b\uff0c\u200b\u672c\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u652f\u6301\u200b\u70ed\u200b\u52a0\u8f7d\u200b\uff0c\u200b\u4fee\u6539\u200bprompt\u200b\u6a21\u677f\u200b\u540e\u200b\u65e0\u9700\u200b\u91cd\u542f\u200b\u670d\u52a1\u200b\u3002</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#kb_configpy","title":"\u6570\u636e\u5e93\u200b\u914d\u7f6e\u200b kb_config.py","text":"<p>\u200b\u8bf7\u200b\u786e\u8ba4\u200b\u672c\u5730\u200b\u5206\u8bcd\u5668\u200b\u8def\u5f84\u200b\u662f\u5426\u200b\u5df2\u7ecf\u200b\u586b\u5199\u200b\uff0c\u200b\u5982\u200b\uff1a</p> <p><pre><code>text_splitter_dict = {\n   \"ChineseRecursiveTextSplitter\": {\n       \"source\":\"huggingface\",  # \u200b\u9009\u62e9\u200btiktoken\u200b\u5219\u200b\u4f7f\u7528\u200bopenai\u200b\u7684\u200b\u65b9\u6cd5\u200b,\u200b\u4e0d\u200b\u586b\u5199\u200b\u5219\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u5b57\u7b26\u200b\u957f\u5ea6\u200b\u5207\u5272\u200b\u65b9\u6cd5\u200b\u3002\n       \"tokenizer_name_or_path\":\"\", # \u200b\u7a7a\u683c\u200b\u4e0d\u586b\u5219\u200b\u9ed8\u8ba4\u200b\u4f7f\u7528\u200b\u5927\u200b\u6a21\u578b\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u3002 \n    }\n}\n</code></pre> \u200b\u8bbe\u7f6e\u200b\u597d\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u9700\u8981\u200b\u518d\u200b<code>TEXT_SPLITTER_NAME</code>\u200b\u4e2d\u200b\u6307\u5b9a\u200b\u5e76\u200b\u5e94\u7528\u200b\u3002</p> <p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u901a\u5e38\u200b\u4f7f\u7528\u200b<code>huggingface</code>\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u5e76\u4e14\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b\u5927\u200b\u6a21\u578b\u200b\u81ea\u5e26\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u6765\u200b\u5b8c\u6210\u200b\u4efb\u52a1\u200b\u3002</p> <p>\u200b\u8bf7\u200b\u6ce8\u610f\u200b\uff0c\u200b\u4f7f\u7528\u200b<code>gpt2</code>\u200b\u5206\u8bcd\u5668\u200b\u5c06\u8981\u200b\u8bbf\u95ee\u200bhuggingface\u200b\u5b98\u7f51\u200b\u4e0b\u8f7d\u200b\u6743\u91cd\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u8fd8\u200b\u652f\u6301\u200b\u4f7f\u7528\u200b<code>tiktoken</code> \u200b\u548c\u200b\u4f20\u7edf\u200b\u7684\u200b \u200b\u6309\u7167\u200b\u957f\u5ea6\u200b\u5206\u8bcd\u200b\u7684\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u914d\u7f6e\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5e0c\u671b\u200b\u8c03\u7528\u200b\u81ea\u5df1\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u8003\u200b[\u200b\u6700\u4f73\u200b\u5b9e\u8df5\u200b]\u200b\u90e8\u5206\u200b\u3002</p> <p><code>kbs_config</code>\u200b\u8bbe\u7f6e\u200b\u4e86\u200b\u4f7f\u7528\u200b\u7684\u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b\uff0c\u200b\u76ee\u524d\u200b\u53ef\u4ee5\u200b\u9009\u62e9\u200b - <code>faiss</code>: \u200b\u4f7f\u7528\u200bfaiss\u200b\u6570\u636e\u5e93\u200b\uff0c\u200b\u9700\u8981\u200b\u5b89\u88c5\u200bfaiss-gpu - <code>milvus</code>: \u200b\u4f7f\u7528\u200bmilvus\u200b\u6570\u636e\u5e93\u200b\uff0c\u200b\u9700\u8981\u200b\u5b89\u88c5\u200bmilvus\u200b\u5e76\u200b\u8fdb\u884c\u200b\u7aef\u53e3\u914d\u7f6e\u200b - <code>pg</code>: \u200b\u4f7f\u7528\u200bpg\u200b\u6570\u636e\u5e93\u200b\uff0c\u200b\u9700\u8981\u200b\u914d\u7f6e\u200bconnection_uri</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#server_configpy","title":"\u670d\u52a1\u200b\u548c\u200b\u7aef\u53e3\u914d\u7f6e\u200b\u9879\u200b server_config.py","text":"<p>\u200b\u901a\u5e38\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u9875\u9762\u200b\u5e76\u4e0d\u9700\u8981\u200b\u8fdb\u884c\u200b\u5927\u91cf\u200b\u7684\u200b\u4fee\u6539\u200b\uff0c\u200b\u4ec5\u200b\u9700\u200b\u786e\u4fdd\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7aef\u53e3\u200b\u6253\u5f00\u200b\uff0c\u200b\u5e76\u200b\u4e0d\u200b\u4e92\u76f8\u51b2\u7a81\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u662f\u200bLinux\u200b\u7cfb\u7edf\u200b\u63a8\u8350\u200b\u8bbe\u7f6e\u200b</p> <p><pre><code>DEFAULT_BIND_HOST =\"0.0.0.0\"\n</code></pre> \u200b\u5982\u679c\u200b\u4f7f\u7528\u200b\u8054\u7f51\u200b\u6a21\u578b\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u5173\u6ce8\u200b\u8054\u7f51\u200b\u6a21\u578b\u200b\u7684\u200b\u7aef\u53e3\u200b\u3002</p> <p>\u200b\u8fd9\u4e9b\u200b\u6a21\u578b\u200b\u5fc5\u987b\u200b\u662f\u200b\u5728\u200bmodel_config.MODEL_PATH\u200b\u6216\u200bONLINE_MODEL\u200b\u4e2d\u200b\u6b63\u786e\u200b\u914d\u7f6e\u200b\u7684\u200b\u3002</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#startuppy-model-worker-model-name-xxxxllm_model","title":"\u5728\u200b\u542f\u52a8\u200bstartup.py\u200b\u65f6\u200b\uff0c\u200b\u53ef\u7528\u200b\u901a\u8fc7\u200b<code>--model-worker --model-name xxxx</code>\u200b\u6307\u5b9a\u200b\u6a21\u578b\u200b\uff0c\u200b\u4e0d\u200b\u6307\u5b9a\u200b\u5219\u200b\u4e3a\u200bLLM_MODEL","text":""},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#startuppy","title":"\u8986\u76d6\u200b\u914d\u7f6e\u6587\u4ef6\u200b \u200b\u6216\u8005\u200b\u914d\u7f6e\u200b startup.py","text":"<p>\u200b\u5728\u200b <code>server_config.py</code>\u200b\u4e2d\u6709\u200b\u4ee5\u4e0b\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u88ab\u200b\u6ce8\u91ca\u200b\u4e86\u200b</p> <pre><code>\"gpus\": None, # \u200b\u4f7f\u7528\u200b\u7684\u200bGPU\uff0c\u200b\u4ee5\u200bstr\u200b\u7684\u200b\u683c\u5f0f\u200b\u6307\u5b9a\u200b\uff0c\u200b\u5982\u200b\"0,1\"\uff0c\u200b\u5982\u200b\u5931\u6548\u200b\u8bf7\u200b\u4f7f\u7528\u200bCUDA_VISIBLE_DEVICES=\"0,1\"\u200b\u7b49\u200b\u5f62\u5f0f\u200b\u6307\u5b9a\u200b\n\"num_gpus\": 1, # \u200b\u4f7f\u7528\u200bGPU\u200b\u7684\u200b\u6570\u91cf\u200b\n\"max_gpu_memory\":\"20GiB\", # \u200b\u6bcf\u4e2a\u200bGPU\u200b\u5360\u7528\u200b\u7684\u200b\u6700\u5927\u200b\u663e\u5b58\u200b\n\n \u200b\u4ee5\u4e0b\u200b\u4e3a\u200bmodel_worker\u200b\u975e\u5e38\u200b\u7528\u200b\u53c2\u6570\u200b\uff0c\u200b\u53ef\u200b\u6839\u636e\u200b\u9700\u8981\u200b\u914d\u7f6e\u200b\n\"load_8bit\": False, # \u200b\u5f00\u542f\u200b8bit\u200b\u91cf\u5316\u200b\n\"cpu_offloading\": None,\n\"gptq_ckpt\": None,\n\"gptq_wbits\": 16,\n\"gptq_groupsize\": -1,\n\"gptq_act_order\": False,\n\"awq_ckpt\": None,\n\"awq_wbits\": 16,\n\"awq_groupsize\": -1,\n\"model_names\": [LLM_MODEL],\n\"conv_template\": None,\n\"limit_worker_concurrency\": 5,\n\"stream_interval\": 2,\n\"no_register\": False,\n\"embed_in_truncate\": False,\n\n \u200b\u4ee5\u4e0b\u200b\u4e3a\u200bvllm_woker\u200b\u914d\u7f6e\u200b\u53c2\u6570\u200b,\u200b\u6ce8\u610f\u200b\u4f7f\u7528\u200bvllm\u200b\u5fc5\u987b\u200b\u6709\u200bgpu\uff0c\u200b\u4ec5\u200b\u5728\u200bLinux\u200b\u6d4b\u8bd5\u901a\u8fc7\u200b\n\n tokenizer = model_path # \u200b\u5982\u679c\u200btokenizer\u200b\u4e0e\u200bmodel_path\u200b\u4e0d\u200b\u4e00\u81f4\u200b\u5728\u200b\u6b64\u5904\u200b\u6dfb\u52a0\u200b\n 'tokenizer_mode':'auto',\n 'trust_remote_code':True,\n 'download_dir':None,\n 'load_format':'auto',\n 'dtype':'auto',\n 'seed':0,\n 'worker_use_ray':False,\n 'pipeline_parallel_size':1,\n 'tensor_parallel_size':1,\n 'block_size':16,\n 'swap_space':4 , # GiB\n 'gpu_memory_utilization':0.90,\n 'max_num_batched_tokens':2560,\n 'max_num_seqs':256,\n 'disable_log_stats':False,\n 'conv_template':None,\n 'limit_worker_concurrency':5,\n 'no_register':False,\n 'num_gpus': 1\n 'engine_use_ray': False,\n 'disable_log_requests': False\n</code></pre> <p>\u200b\u5728\u200b\u8fd9\u4e9b\u200b\u53c2\u6570\u200b\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u5219\u200b\u4f7f\u7528\u200b<code>startup.py</code>\u200b\u4e2d\u200b\u7684\u200b\u9ed8\u8ba4\u503c\u200b\uff0c\u200b\u5982\u679c\u200b\u8bbe\u7f6e\u200b\u4e86\u200b\uff0c\u200b\u5219\u200b\u4f7f\u7528\u200b\u8bbe\u7f6e\u200b\u7684\u200b\u503c\u200b\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u5f3a\u70c8\u5efa\u8bae\u200b\u5f00\u53d1\u200b\u4e0d\u8981\u200b\u5728\u200b<code>startup.py</code>\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u914d\u7f6e\u200b\uff0c\u200b\u800c\u200b\u5e94\u8be5\u200b\u5728\u200b<code>server_config.py</code>\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u914d\u7f6e\u200b\u3002\u200b\u907f\u514d\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u8986\u76d6\u200b\u3002</p>"},{"location":"2-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE/#_1","title":"\u9009\u62e9\u200b\u4f7f\u7528\u200b\u7684\u200b\u6a21\u578b","text":"<p>\u200b\u5728\u200b<code>model_config.py</code>\u200b\u5b8c\u6210\u200b\u6a21\u578b\u200b\u914d\u7f6e\u200b\u540e\u200b\uff0c\u200b\u8fd8\u200b\u4e0d\u80fd\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b\uff0c\u200b\u9700\u8981\u200b\u5728\u200b\u8be5\u200b\u6587\u4ef6\u200b\u4e0b\u200b\u914d\u7f6e\u200b\u672c\u5730\u200b\u6a21\u578b\u200b\u7684\u200b\u8fd0\u884c\u200b\u65b9\u5f0f\u200b\u6216\u200b\u5728\u7ebf\u200b\u6a21\u578b\u200b\u7684\u200bAPI\uff0c\u200b\u4f8b\u5982\u200b <pre><code>    \"agentlm-7b\": { # \u200b\u4f7f\u7528\u200bdefault\u200b\u4e2d\u200b\u7684\u200bIP\u200b\u548c\u200b\u7aef\u53e3\u200b\n       \"device\": \"cuda\",\n    },\n    \"zhipu-api\": { # \u200b\u8bf7\u200b\u4e3a\u200b\u6bcf\u4e2a\u200b\u8981\u200b\u8fd0\u884c\u200b\u7684\u200b\u5728\u7ebf\u200bAPI\u200b\u8bbe\u7f6e\u200b\u4e0d\u540c\u200b\u7684\u200b\u7aef\u53e3\u200b\n        \"port\": 21001,\n    },\n</code></pre> \u200b\u672c\u5730\u200b\u6a21\u578b\u200b\u4f7f\u7528\u200bdefault\u200b\u4e2d\u200b\u7684\u200bIP\u200b\u548c\u200b\u7aef\u53e3\u200b\uff0c\u200b\u5728\u7ebf\u200b\u6a21\u578b\u200b\u53ef\u4ee5\u200b\u81ea\u5df1\u200b\u9009\u62e9\u200b\u7aef\u53e3\u200b</p>"},{"location":"3-%E8%87%AA%E5%AE%9A%E4%B9%89/","title":"3 \u200b\u81ea\u5b9a\u4e49","text":""},{"location":"3-%E8%87%AA%E5%AE%9A%E4%B9%89/#_1","title":"\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5206\u8bcd\u5668","text":"<ol> <li> <p>\u200b\u5728\u200b<code>text_splitter</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\u65b0\u5efa\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6587\u4ef6\u540d\u200b\u4e3a\u200b\u60a8\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u540d\u5b57\u200b\uff0c\u200b\u6bd4\u5982\u200b<code>my_splitter.py</code>\uff0c\u200b\u7136\u540e\u200b\u5728\u200b<code>__init__.py</code>\u200b\u4e2d\u200b\u5bfc\u5165\u200b\u60a8\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\uff0c\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a <pre><code>from .my_splitter import MySplitter\n</code></pre></p> </li> <li> <p>\u200b\u4fee\u6539\u200b<code>config/model_config.py</code>\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5c06\u200b\u60a8\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u540d\u5b57\u200b\u6dfb\u52a0\u200b\u5230\u200b<code>text_splitter_dict</code>\u200b\u4e2d\u200b\uff0c\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a <pre><code>MySplitter: {\n        \"source\": \"huggingface\",  # \u200b\u9009\u62e9\u200btiktoken\u200b\u5219\u200b\u4f7f\u7528\u200bopenai\u200b\u7684\u200b\u65b9\u6cd5\u200b\n        \"tokenizer_name_or_path\": \"your tokenizer\", #\u200b\u5982\u679c\u200b\u9009\u62e9\u200bhuggingface\u200b\u5219\u200b\u4f7f\u7528\u200bhuggingface\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u90e8\u5206\u200btokenizer\u200b\u9700\u8981\u200b\u4ece\u200bHuggingface\u200b\u4e0b\u8f7d\u200b\n    }\nTEXT_SPLITTER = \"MySplitter\"\n</code></pre></p> </li> </ol> <p>\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u6b65\u9aa4\u200b\u540e\u200b\uff0c\u200b\u5c31\u200b\u80fd\u200b\u4f7f\u7528\u200b\u81ea\u5df1\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u4e86\u200b\u3002</p>"},{"location":"3-%E8%87%AA%E5%AE%9A%E4%B9%89/#agent","title":"\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b Agent \u200b\u5de5\u5177","text":"<ol> <li> <p>\u200b\u521b\u5efa\u200b\u81ea\u5df1\u200b\u7684\u200bAgent\u200b\u5de5\u5177\u200b</p> </li> <li> <p>\u200b\u5f00\u53d1\u8005\u200b\u5728\u200b<code>server/agent</code>\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u81ea\u5df1\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u5176\u200b\u6dfb\u52a0\u200b\u5230\u200b<code>tools.py</code>\u200b\u4e2d\u200b\u3002\u200b\u8fd9\u6837\u200b\u5c31\u200b\u5b8c\u6210\u200b\u4e86\u200bTools\u200b\u7684\u200b\u8bbe\u5b9a\u200b\u3002</p> </li> <li> <p>\u200b\u5f53\u200b\u60a8\u200b\u521b\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>custom_agent.py</code>\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5176\u4e2d\u200b\u5305\u542b\u200b\u4e00\u4e2a\u200b<code>work</code>\u200b\u51fd\u6570\u200b\uff0c\u200b\u90a3\u4e48\u200b\u60a8\u200b\u9700\u8981\u200b\u5728\u200b<code>tools.py</code>\u200b\u4e2d\u200b\u6dfb\u52a0\u200b\u5982\u4e0b\u200b\u4ee3\u7801\u200b\uff1a <pre><code>from custom_agent import work\nTool.from_function(\n    func=work,\n    name=\"\u200b\u8be5\u200b\u51fd\u6570\u200b\u7684\u200b\u540d\u5b57\u200b\",\n    description=\"\"\n    )\n</code></pre></p> </li> <li> <p>\u200b\u8bf7\u200b\u6ce8\u610f\u200b\uff0c\u200b\u5982\u679c\u200b\u4f60\u200b\u786e\u5b9a\u200b\u5728\u200b\u67d0\u200b\u4e00\u4e2a\u200b\u5de5\u7a0b\u200b\u4e2d\u200b\u4e0d\u4f1a\u200b\u4f7f\u7528\u200b\u5230\u200b\u67d0\u4e2a\u200b\u5de5\u5177\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u5176\u200b\u4ece\u200bTools\u200b\u4e2d\u200b\u79fb\u9664\u200b\uff0c\u200b\u964d\u4f4e\u200b\u6a21\u578b\u200b\u5206\u7c7b\u200b\u9519\u8bef\u200b\u5bfc\u81f4\u200b\u4f7f\u7528\u200b\u9519\u8bef\u200b\u5de5\u5177\u200b\u7684\u200b\u98ce\u9669\u200b\u3002</p> </li> <li> <p>\u200b\u5982\u679c\u200b\u60a8\u200b\u521b\u5efa\u200b\u7684\u200bAgent\u200b\u5de5\u5177\u200b\u662f\u200b\u4e3a\u4e86\u200b\u7ed9\u200b<code>ChatGLM3-6B</code>\u200b\u6a21\u578b\u200b\u4f7f\u7528\u200b\u7684\u200b\uff0c\u200b\u60a8\u200b\u5e94\u8be5\u200b\u5355\u72ec\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u4e0e\u200b\u5de5\u5177\u200b\u540d\u79f0\u200b\u76f8\u540c\u200b\u7684\u200byaml\u200b\u6587\u4ef6\u200b\u3002 \u200b\u8bf7\u200b\u6ce8\u610f\u200b\uff0c\u200b\u662f\u200b\u4e0e\u200bTools\u200b\u4e2d\u200b\u7684\u200b<code>name</code>\u200b\u76f8\u540c\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u6267\u884c\u200b\u51fd\u6570\u200b\u7684\u200b\u540d\u5b57\u200b\u3002\u200b\u521b\u5efa\u200b\u7684\u200byaml\u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u5e94\u8be5\u200b\u4e0e\u200bGLM3\u200b\u5b98\u65b9\u200b\u4ed3\u5e93\u200b\u4e2d\u200b\u7684\u200b\u683c\u5f0f\u200b\u5b8c\u5168\u4e00\u81f4\u200b\u3002</p> </li> <li> <p>\u200b\u4fee\u6539\u200b <code>custom_template.py</code> \u200b\u6587\u4ef6\u200b</p> </li> </ol> <p>\u200b\u5f00\u53d1\u8005\u200b\u9700\u8981\u200b\u6839\u636e\u200b\u81ea\u5df1\u200b\u9009\u62e9\u200b\u7684\u200b\u5927\u200b\u6a21\u578b\u200b\u8bbe\u5b9a\u200b\u9002\u5408\u200b\u8be5\u200b\u6a21\u578b\u200b\u7684\u200bAgent Prompt\u200b\u548c\u200b\u81ea\u200b\u81ea\u5b9a\u4e49\u200b\u8fd4\u56de\u200b\u683c\u5f0f\u200b\u3002 <pre><code>\"\"\"\nAnswer the following questions as best you can. You have access to the following tools:\n{tools}\nUse the following format:\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction: the action to take, should be one of [{tool_names}]\nAction Input: the input to the action\nObservation: the result of the action\n... (this Thought/Action/Action Input/Observation can be repeated zero or more times)\nThought: I now know the final answer\nFinal Answer: the final answer to the original input question\nBegin!\nhistory:\n{history}\nQuestion: {input}\nThought: {agent_scratchpad}\n\"\"\"\n</code></pre> \u200b\u9664\u4e86\u200b\u4f7f\u7528\u200b <code>Zero React</code> \u200b\u7684\u200b\u63d0\u793a\u200b\u8bcd\u200b\u65b9\u6848\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u5bf9\u200b\u63d0\u793a\u200b\u8bcd\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\uff0c\u200b\u6216\u8005\u200b\u4f7f\u7528\u200b Langchain \u200b\u63d0\u4f9b\u200b\u7684\u200b\u5176\u4ed6\u200b\u7684\u200bAgent\u200b\u7ed3\u6784\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c\u200b\u5982\u679c\u200b\u60a8\u200b\u4f7f\u7528\u200b\u7684\u200b\u6a21\u578b\u200b\u4e3a\u200b<code>ChatGLM3-6B</code>\u200b\u6a21\u578b\u200b\uff0c\u200b\u6211\u4eec\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u53ef\u4ee5\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b<code>ChatGLM3-6B</code>\u200b\u7684\u200bAgent\u200b\u63d0\u793a\u200b\u8bcd\u200b\uff0c\u200b\u8be5\u200b\u63d0\u793a\u200b\u8bcd\u200b\u4e0e\u200b Langchain \u200b\u7684\u200b <code>struct Agent</code>\u200b\u76f8\u4f3c\u200b\uff0c\u200b\u5176\u200b\u5185\u5bb9\u200b\u5982\u4e0b\u200b\uff1a <pre><code>\"ChatGLM3\":\n\"\"\"\nYou can answer using the tools, or answer directly using your knowledge without using the tools.Respond to the human as helpfully and accurately as possible.\nYou have access to the following tools:\n{tools}\nUse a json blob to specify a tool by providing an action key (tool name) and an action_input key (tool input).\nValid \"action\" values: \"Final Answer\" or  [{tool_names}]\nProvide only ONE action per $JSON_BLOB, as shown:\n\n```\n{{{{\n  \"action\": $TOOL_NAME,\n  \"action_input\": $INPUT\n}}}}\n```\nFollow this format:\n\nQuestion: input question to answer\nThought: consider previous and subsequent steps\nAction:\n```\n$JSON_BLOB\n```\nObservation: action result\n... (repeat Thought/Action/Observation N times)\nThought: I know what to respond\nAction:\n```\n{{{{\n  \"action\": \"Final Answer\",\n  \"action_input\": \"Final response to human\"\n}}}}\nBegin! Reminder to ALWAYS respond with a valid json blob of a single action. Use tools if necessary. Respond directly if appropriate. Format is Action:```$JSON_BLOB```then Observation:.\n\nhistory: {history}\n\nQuestion: {input}\n\nThought: {agent_scratchpad}\n\"\"\",\n</code></pre></p> <ol> <li>\u200b\u8ba9\u200b\u4e0d\u200b\u652f\u6301\u200b Langchain \u200b\u8c03\u7528\u200b\u65b9\u5f0f\u200b\u7684\u200b\u4f46\u200b\u5177\u5907\u200b Agent \u200b\u80fd\u529b\u200b\u7684\u200b\u6a21\u578b\u200b\u5c55\u73b0\u200b\u80fd\u529b\u200b</li> </ol> <p>\u200b\u4ee5\u200bChatGLM3-6B\u200b\u4e3a\u200b\u4ee3\u8868\u200b\u7684\u200b\u6a21\u578b\u200b\uff0c\u200b\u867d\u7136\u200b\u5177\u6709\u200b Function Call \u200b\u80fd\u529b\u200b\uff0c\u200b\u4f46\u200b\u5176\u200b\u5bf9\u9f50\u200b\u683c\u5f0f\u200b\u4e0e\u200b Langchain \u200b\u63d0\u4f9b\u200b\u9ed8\u8ba4\u200bAgent\u200b\u683c\u5f0f\u200b\u5e76\u200b\u4e0d\u200b\u7b26\u5408\u200b\uff0c\u200b\u56e0\u6b64\u200b\u65e0\u6cd5\u200b\u4f7f\u7528\u200b Langchain \u200b\u81ea\u8eab\u200b\u80fd\u529b\u200b\u5b9e\u73b0\u200b Function Call\u3002\u200b\u5728\u200b\u6211\u4eec\u200b\u7684\u200b\u6846\u67b6\u200b\u4e2d\u200b\uff0c\u200b\u60a8\u200b\u53ef\u4ee5\u200b\u5728\u200b <code>server/Agent/custom_agent/</code> \u200b\u6587\u4ef6\u5939\u200b\u4e2d\u200b\u81ea\u884c\u200b\u590d\u73b0\u200b\u66f4\u200b\u591a\u200b\u6a21\u578b\u200b\u7684\u200b Agent \u200b\u80fd\u529b\u200b\u5b9e\u73b0\u200b\u3002</p> <p>\u200b\u5728\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u6b65\u9aa4\u200b\u4e4b\u540e\u200b\uff0c\u200b\u60a8\u200b\u8fd8\u200b\u9700\u8981\u200b\u5230\u200b<code>server/chat/agent_chat/</code>\u200b\u4e2d\u200b\u5bfc\u5165\u200b\u60a8\u200b\u7684\u200b\u6a21\u5757\u200b\u6765\u200b\u5b9e\u73b0\u200b\u7279\u6b8a\u200b\u5224\u5b9a\u200b\u3002</p> <ol> <li> <p>\u200b\u5c40\u9650\u6027\u200b</p> </li> <li> <p>\u200b\u5728\u200b\u6211\u4eec\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0cGPT4\u200b\u80fd\u591f\u200b\u7a33\u5b9a\u200b\u7684\u200b\u53d1\u6325\u200b\u51fa\u200bAgent\u200b\u80fd\u529b\u200b\uff0cQwen\u200b\u5177\u6709\u200b\u57fa\u7840\u200b\u7684\u200bAgent\u200b\u80fd\u529b\u200b\u3002Qwen\u200b\u7cfb\u5217\u200b\u6a21\u578b\u200b\u5df2\u7ecf\u200b\u5bf9\u200b Agent \u200b\u8fdb\u884c\u200b\u4e86\u200b\u5bf9\u9f50\u200b\uff0c\u200b\u4f46\u662f\u200b\u7ecf\u8fc7\u200b\u5f00\u53d1\u200b\u7ec4\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5176\u200b\u6548\u679c\u200b\u5c1a\u4e14\u200b\u4e0d\u80fd\u200b\u5b8c\u6210\u200b\u5927\u89c4\u6a21\u200b\u7684\u200bAgent\u200b\u4efb\u52a1\u200b\u3002\u200b\u6211\u4eec\u200b\u4e0d\u200b\u63a8\u8350\u200b \u200b\u5f00\u53d1\u8005\u200b\u82b1\u8d39\u200b\u65e0\u7528\u200b\u7684\u200b\u65f6\u95f4\u200b\u5728\u200b\u5c1d\u8bd5\u200b\u672a\u200b\u7ecf\u8fc7\u200b\u5fae\u8c03\u200b\u7684\u200b\u5176\u4ed6\u200b\u6a21\u578b\u200b\u3002</p> </li> <li>\u200b\u7531\u4e8e\u200b React Agent \u200b\u7684\u200b\u8106\u5f31\u6027\u200b\uff0ctemperature \u200b\u53c2\u6570\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u5bf9\u4e8e\u200b\u6a21\u578b\u200b\u7684\u200b\u6548\u679c\u200b\u6709\u200b\u5f88\u5927\u200b\u7684\u200b\u5f71\u54cd\u200b\u3002\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u5f00\u53d1\u8005\u200b\u5728\u200b\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b Agent \u200b\u65f6\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u4e0d\u540c\u200b\u7684\u200b\u6a21\u578b\u200b\uff0c\u200b\u5c06\u200b\u5176\u200b\u8bbe\u7f6e\u200b\u6210\u200b0.1\u200b\u4ee5\u4e0b\u200b\uff0c\u200b\u4ee5\u200b\u8fbe\u5230\u200b\u66f4\u597d\u200b\u7684\u200b\u6548\u679c\u200b\u3002</li> <li>\u200b\u76ee\u524d\u200b\uff0c\u200b\u5b98\u65b9\u200b\u4ec5\u200b\u5bf9\u200b ChatGLM3-6B \u200b\u4e00\u79cd\u200b\u6a21\u578b\u200b\u8fdb\u884c\u200b\u4e86\u200b \u200b\u975e\u200b Langchain \u200b\u5bf9\u9f50\u200b\u683c\u5f0f\u200b\u4e0b\u200b\u7684\u200b\u80fd\u529b\u200b\u6fc0\u6d3b\u200b\uff0c\u200b\u6211\u4eec\u200b\u6b22\u8fce\u200b\u5f00\u53d1\u8005\u200b\u81ea\u884c\u200b\u63a2\u7d22\u200b\u5176\u4ed6\u200b\u6a21\u578b\u200b\uff0c\u200b\u5e76\u200b\u63d0\u4ea4\u200b\u5bf9\u5e94\u200b\u7684\u200b PR\uff0c\u200b\u8ba9\u200b\u6846\u67b6\u200b\u652f\u6301\u200b\u66f4\u200b\u591a\u200b\u7684\u200b Agent \u200b\u6a21\u578b\u200b\u3002</li> <li>\u200b\u57fa\u4e8e\u200b Langchain \u200b\u7684\u200b Agent \u200b\u67b6\u6784\u200b\u4e0e\u200b <code>AutoGen</code> \u200b\u7b49\u200b\u65b0\u4e00\u4ee3\u200b Agent \u200b\u67b6\u6784\u200b\u5177\u6709\u200b\u4e00\u5b9a\u200b\u533a\u522b\u200b\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u76ee\u524d\u200b\u7684\u200b\u4e3b\u8981\u200b\u5b9e\u73b0\u200b\u4ecd\u200b\u4fdd\u6301\u200b\u5728\u200b\u5de5\u5177\u200b\u8c03\u7528\u200b\u9636\u6bb5\u200b\u3002</li> </ol>"},{"location":"3-%E8%87%AA%E5%AE%9A%E4%B9%89/#_2","title":"\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5fae\u8c03\u200b\u6a21\u578b","text":"<ul> <li>\u200b\u672c\u200b\u9879\u76ee\u200b\u57fa\u4e8e\u200b FastChat \u200b\u52a0\u8f7d\u200b LLM \u200b\u670d\u52a1\u200b\uff0c\u200b\u6545\u200b\u9700\u4ee5\u200b FastChat \u200b\u52a0\u8f7d\u200b PEFT \u200b\u8def\u5f84\u200b\u3002</li> <li>\u200b\u5f00\u53d1\u8005\u200b\u9700\u8981\u200b\u4fdd\u8bc1\u200b\u8def\u5f84\u200b\u540d\u79f0\u200b\u91cc\u200b\u5fc5\u987b\u200b\u6709\u200b peft \u200b\u8fd9\u4e2a\u200b\u8bcd\u200b\u3002</li> <li>\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u7684\u200b\u540d\u5b57\u200b\u4e3a\u200b <code>adapter_config.json</code></li> <li>peft \u200b\u8def\u5f84\u200b\u4e0b\u200b\u5305\u542b\u200b.bin \u200b\u683c\u5f0f\u200b\u7684\u200b PEFT \u200b\u6743\u91cd\u200b\uff0c peft\u200b\u8def\u5f84\u200b\u5728\u200bstartup.py\u200b\u4e2d\u200b <code>create_model_worker_app</code> \u200b\u51fd\u6570\u200b\u7684\u200b <code>args.model_names</code> \u200b\u4e2d\u200b\u6307\u5b9a\u200b <pre><code>    args.model_names = [\"/home/ubuntu/your_peft_folder/peft\"]\n</code></pre></li> <li>\u200b\u6267\u884c\u200b\u4ee3\u7801\u200b\u4e4b\u200b\uff0c\u200b\u5e94\u8be5\u200b\u8bbe\u5b9a\u200b\u73af\u5883\u53d8\u91cf\u200b <pre><code>PEFT_SHARE_BASE_WEIGHTS=true \n</code></pre></li> </ul> <p>\u200b\u6ce8\u200b\uff1a\u200b\u5982\u679c\u200b\u4e0a\u8ff0\u200b\u65b9\u5f0f\u200b\u542f\u52a8\u200b\u5931\u8d25\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u4ee5\u200b\u6807\u51c6\u200b\u7684\u200b FastChat \u200b\u670d\u52a1\u200b\u542f\u52a8\u200b\u65b9\u5f0f\u200b\u5206\u6b65\u200b\u542f\u52a8\u200b\uff0cPEFT\u200b\u52a0\u8f7d\u200b\u8be6\u7ec6\u200b\u6b65\u9aa4\u200b\u53c2\u8003\u200b\u4ee5\u4e0b\u200bISSUE</p> <p>\u200b\u52a0\u8f7d\u200blora\u200b\u5fae\u8c03\u200b\u540e\u200b\u6a21\u578b\u200b\u5931\u6548\u200b</p> <p>\u200b\u5728\u200b<code>\u200b\u6700\u4f73\u200b\u5b9e\u8df5\u200b</code>\u200b\u7ae0\u8282\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e3a\u200b\u5f00\u53d1\u8005\u200b\u505a\u200b\u4e86\u200b\u66f4\u200b\u8be6\u7ec6\u200b\u7684\u200b\u6a21\u578b\u200b\u8f7d\u5165\u200b\u6587\u6863\u200b\u3002</p> <p>\u200b\u8be5\u200b\u529f\u80fd\u200b\u53ef\u80fd\u200b\u8fd8\u200b\u5177\u6709\u200b\u4e00\u5b9a\u200b\u7684\u200bBug\uff0c\u200b\u9700\u8981\u200b\u5f00\u53d1\u8005\u200b\u4ed4\u7ec6\u200b\u9002\u914d\u200b\u3002</p>"},{"location":"3-%E8%87%AA%E5%AE%9A%E4%B9%89/#_3","title":"\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5d4c\u5165\u200b\u6a21\u578b","text":"<ul> <li>\u200b\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u9700\u8981\u200b\u5c06\u200b\u5176\u200b\u5408\u5e76\u200b\u5230\u200b\u539f\u59cb\u200b\u7684\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b\u4e2d\u200b\uff0c\u200b\u4e4b\u540e\u200b\u4ec5\u200b\u9700\u200b\u5c06\u200b\u5176\u200b\u8def\u5f84\u200b\u6dfb\u52a0\u200b\u5230\u200b<code>config/model_config.py</code>\u200b\u4e2d\u200b\u5e76\u200b\u9009\u62e9\u200b\u81ea\u5df1\u200b\u7684\u200b\u6a21\u578b\u200b\u542f\u52a8\u200b\u5373\u53ef\u200b\u3002</li> <li>\u200b\u5982\u679c\u200b\u60f3\u200b\u81ea\u5df1\u200b\u5728\u200bEmbedding\u200b\u6a21\u578b\u200b\u4e2d\u200b\u652f\u6301\u200b \u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5173\u952e\u5b57\u200b\uff0c\u200b\u9700\u8981\u200b\u5728\u200b <code>embeddings/embedding_keywords.txt</code>\u200b\u4e2d\u200b\u8bbe\u5b9a\u200b\u597d\u200b\u81ea\u5df1\u200b\u7684\u200b\u5173\u952e\u5b57\u200b</li> <li>\u200b\u8fd0\u884c\u200b <code>embeddings/add_embedding_keywords.py</code></li> <li>\u200b\u5c06\u200b\u751f\u6210\u200b\u7684\u200b\u65b0\u200bEmbedding\u200b\u6a21\u578b\u200b\u5730\u5740\u200b\u653e\u5165\u200b<code>configs/model_config.py</code>\u200b\u4e2d\u200b\u5e76\u200b\u9009\u62e9\u200b\uff0c <pre><code>\"custom-embedding\": \"your path\",\n</code></pre> \u200b\u5e76\u200b\u8bbe\u7f6e\u200b <pre><code>EMBEDDING_MODEL = \"custom-embedding\"  \n</code></pre> \u200b\u5373\u53ef\u200b\u8c03\u7528\u200b\u52a0\u5165\u200b\u5173\u952e\u5b57\u200b\u7684\u200bembedding\u200b\u6a21\u578b\u200b\u3002 \u200b\u5728\u200b<code>\u200b\u6700\u4f73\u200b\u5b9e\u8df5\u200b</code>\u200b\u7ae0\u8282\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e3a\u200b\u67d0\u200b\u51e0\u4e2a\u200b\u5173\u952e\u8bcd\u200b\u5b9a\u5236\u200b\u4e86\u200b\u4e00\u4e2a\u200bEmbed\u200b\u6a21\u578b\u200b\u3002</li> </ul>"},{"location":"3-%E8%87%AA%E5%AE%9A%E4%B9%89/#_4","title":"\u65e5\u5fd7\u200b\u529f\u80fd","text":"<ul> <li>\u200b\u65e5\u5fd7\u200b\u529f\u80fd\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u5927\u200b\u6a21\u578b\u200b\u7684\u200b\u5fc3\u8df3\u200b\u548c\u200b\u7f51\u7edc\u200b\u7aef\u53e3\u200b\u4f20\u8f93\u200b\u8bb0\u5f55\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u65e5\u5fd7\u200b\u529f\u80fd\u200b\u67e5\u770b\u200b\u6a21\u578b\u200b\u7684\u200b\u8fd0\u884c\u200b\u60c5\u51b5\u200b\u3002</li> </ul>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/","title":"4 \u200b\u6700\u4f73\u200b\u5b9e\u8df5","text":""},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_1","title":"\u63a8\u8350\u200b\u7684\u200b\u6a21\u578b\u200b\u7ec4\u5408","text":"<ul> <li> <p>\u200b\u5728\u200b\u9ed8\u8ba4\u200b\u7684\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4ee5\u4e0b\u200b\u6a21\u578b\u200b\u7ec4\u5408\u200b <pre><code>LLM: Chatglm2-6b\nEmbedding Models: m3e-base\nTextSplitter: ChineseRecursiveTextSplitter\nKb_dataset: faiss\n</code></pre></p> </li> <li> <p>\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u5f00\u53d1\u8005\u200b\u6839\u636e\u200b\u81ea\u5df1\u200b\u7684\u200b\u4e1a\u52a1\u200b\u9700\u6c42\u200b\u8fdb\u884c\u200b\u6a21\u578b\u200b\u5fae\u8c03\u200b\uff0c\u200b\u5982\u679c\u200b\u4e0d\u200b\u9700\u8981\u200b\u5fae\u8c03\u200b\u4e14\u200b\u914d\u7f6e\u200b\u5145\u8db3\u200b\uff0c\u200b\u53ef\u200b\u9009\u62e9\u200b\u4ee5\u4e0b\u200b\u6027\u80fd\u200b\u8f83\u200b\u597d\u200b\u7684\u200b\u914d\u7f6e\u200b <pre><code>model_config.py\nLLM: Qwen-14B-Chat \u200b\u6216\u200b Baichuan2-13B-Chat\nEmbedding Models: piccolo-large-zh \u200b\u6216\u200b bge-large-zh-v1.5 \nHISTORY_LEN = 20\nTEMPERATURE = 0.1\n</code></pre> \u200b\u4f7f\u7528\u200b\u8be5\u200b\u6a21\u578b\u200b\u5c06\u200b\u9700\u8981\u200b\u66f4\u200b\u9ad8\u200b\u7684\u200b\u786c\u4ef6\u200b\u8981\u6c42\u200b <pre><code>1\u200b\u5f20\u200b RTX A6000 \u200b\u6216\u8005\u200b A40 \u200b\u7b49\u200b 48GB \u200b\u663e\u5b58\u200b\u4ee5\u4e0a\u200b\u7684\u200b\u663e\u5361\u200b\u3002\u200b\u63a8\u8350\u200b 1 x A100 \u200b\u4ee5\u4e0a\u200b\u3002\n(\u200b\u4f7f\u7528\u200b\u591a\u200b\u5f20\u200b\u663e\u5361\u200b\u62fc\u63a5\u200b\u4e5f\u200b\u80fd\u200b\u8fd0\u884c\u200b\uff0c\u200b\u4f46\u662f\u200b\u901f\u5ea6\u200b\u975e\u5e38\u200b\u6162\u200b\uff0c2\u200b\u5f20\u200b4090\u200b\u62fc\u63a5\u200b\u8fd0\u884c\u200b\u5927\u6982\u200b\u4e3a\u200b\u4e00\u79d2\u200b\u4e00\u4e2a\u200b\u5b57\u200b\u7684\u200b\u901f\u5ea6\u200b)\n\n64GB \u200b\u5185\u5b58\u200b\u7528\u4e8e\u200b\u52a0\u8f7d\u200b\u6a21\u578b\u200b\u800c\u200b\u4e0d\u200b\u88ab\u200bKill\n\n\u200b\u670d\u52a1\u5668\u200b\u7ea7\u200b\u7684\u200bCPU\uff0c\u200b\u63a8\u8350\u200b Xeon(R) Platinum 8358P \u200b\u4ee5\u4e0a\u200b\n</code></pre></p> </li> <li> <p>\u200b\u5982\u679c\u200b\u5f00\u53d1\u8005\u200b\u77e5\u8bc6\u5e93\u200b\u8f83\u5927\u200b\uff0c\u200b\u6709\u200b\u5927\u91cf\u200b\u6587\u6863\u200b\uff0c\u200b\u5927\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u5f00\u53d1\u8005\u200b\u4f7f\u7528\u200b <code>pg</code> \u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b</p> </li> <li> <p>\u200b\u5982\u679c\u200b\u5f00\u53d1\u8005\u200b\u7684\u200b\u77e5\u8bc6\u5e93\u200b\u5177\u6709\u200b\u4e00\u5b9a\u200b\u7684\u200b\u5173\u952e\u8bcd\u200b\u7279\u5f81\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <ul> <li>\u200b\u95ee\u7b54\u200b\u5bf9\u200b\u6587\u4ef6\u200b(\u200b\u4ee5\u200bQ + A \u200b\u4e3a\u200b\u4e00\u4e2a\u200b\u7ec4\u5408\u200b\u7684\u200bjson\u200b\u6587\u4ef6\u200b)</li> <li>Markdown\u200b\u6587\u4ef6\u200b</li> <li>\u200b\u5e76\u6392\u200b\u7684\u200bpdf\u200b\u6587\u4ef6\u200b</li> <li>\u200b\u5177\u6709\u200b\u591a\u4e2a\u200b\u8868\u683c\u200b\u7684\u200bpdf\u200b\u6587\u4ef6\u200b</li> </ul> <p>\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u5f00\u53d1\u8005\u200b\u81ea\u884c\u200b\u5f00\u53d1\u200b\u5206\u8bcd\u5668\u200b\uff0c\u200b\u4ee5\u200b\u8fbe\u5230\u200b\u66f4\u597d\u200b\u7684\u200b\u6548\u679c\u200b\u3002</p> </li> <li> <p>\u200b\u5982\u679c\u200b\u5f00\u53d1\u8005\u200b\u60f3\u200b\u4f7f\u7528\u200b\u66f4\u200b\u5168\u9762\u200b\u7684\u200b Agent \u200b\u529f\u80fd\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u5f00\u53d1\u8005\u200b\u4f7f\u7528\u200b\u4ee5\u4e0b\u200b\u914d\u7f6e\u200b <pre><code>LLM: Qwen-14B-Chat, AgentLM-70B \u200b\u6216\u200b GPT-4\nTools \u200b\u7684\u200b\u5de5\u5177\u200b\u63a7\u5236\u200b\u5728\u200b10\u200b\u4e2a\u200b\u4e4b\u5185\u200b\n</code></pre></p> </li> </ul>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_2","title":"\u5fae\u8c03\u200b\u6a21\u578b\u200b\u52a0\u8f7d\u200b\u5b9e\u64cd","text":""},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#p-tuningpeft","title":"\u975e\u200bp-tuning\u200b\u7c7b\u200bPEFT\u200b\u52a0\u8f7d","text":"<p>\u200b\u672c\u200b\u9879\u76ee\u200b\u57fa\u4e8e\u200b FastChat \u200b\u52a0\u8f7d\u200b LLM \u200b\u670d\u52a1\u200b\uff0c\u200b\u6545\u200b\u9700\u4ee5\u200b FastChat \u200b\u52a0\u8f7d\u200b PEFT \u200b\u8def\u5f84\u200b\uff0c\u200b\u9488\u5bf9\u200bchatglm,falcon\uff0ccodet5p\u200b\u4ee5\u5916\u200b\u7684\u200b\u6a21\u578b\u200b\uff0c\u200b\u4ee5\u53ca\u200b\u975e\u200bp-tuning\u200b\u4ee5\u5916\u200b\u7684\u200bpeft\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u9700\u5bf9\u200bpeft\u200b\u6587\u4ef6\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\uff0c\u200b\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <ol> <li>\u200b\u5c06\u200bconfig.json\u200b\u6587\u4ef6\u200b\u4fee\u6539\u200b\u4e3a\u200badapter_config.json;</li> <li>\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u5939\u200b\u5305\u542b\u200bpytorch_model.bin\u200b\u6587\u4ef6\u200b\uff1b</li> <li>\u200b\u4fee\u6539\u200b\u6587\u4ef6\u5939\u200b\u540d\u79f0\u200b\uff0c\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u5939\u200b\u5305\u542b\u200b'peft'\u200b\u4e00\u8bcd\u200b\uff1b</li> <li>\u200b\u5c06\u200bpeft\u200b\u6587\u4ef6\u5939\u200b\u79fb\u5165\u200b\u9879\u76ee\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff1b</li> <li>\u200b\u786e\u4fdd\u200badapter_config.json\u200b\u6587\u4ef6\u5939\u200b\u4e2d\u200bbase_model_name_or_path\u200b\u6307\u5411\u200b\u57fa\u7840\u200b\u6a21\u578b\u200b\uff1b</li> <li>\u200b\u5c06\u200bpeft\u200b\u8def\u5f84\u200b\u6dfb\u52a0\u200b\u5230\u200bmodel_config.py\u200b\u7684\u200bllm_dict\u200b\u4e2d\u200b\uff0c\u200b\u952e\u4e3a\u200b\u6a21\u578b\u200b\u540d\u200b\uff0c\u200b\u503c\u4e3a\u200bpeft\u200b\u8def\u5f84\u200b\uff0c\u200b\u6ce8\u610f\u200b\u4f7f\u7528\u200b\u76f8\u5bf9\u8def\u5f84\u200b\uff0c\u200b\u5982\u200b\"peft\"\uff1b</li> <li>\u200b\u5f00\u542f\u200b <code>PEFT_SHARE_BASE_WEIGHTS=true</code>\u200b\u73af\u5883\u53d8\u91cf\u200b\uff0c\u200b\u518d\u200b\u6267\u884c\u200bpython startup.py -a</li> </ol> <p>\u200b\u9488\u5bf9\u200bp-tuning\u200b\u548c\u200bchatglm\u200b\u6a21\u578b\u200b\uff0c\u200b\u9700\u8981\u200b\u5bf9\u200bfastchat\u200b\u8fdb\u884c\u200b\u8f83\u200b\u5927\u5e45\u5ea6\u200b\u7684\u200b\u4fee\u6539\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#p-tuning","title":"p-tuning\u200b\u52a0\u8f7d","text":"<p>P-tuning\u200b\u867d\u7136\u200b\u662f\u200b\u4e00\u79cd\u200bpeft\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u4f46\u200b\u5e76\u200b\u4e0d\u80fd\u200b\u4e8e\u200bhuggingface\u200b\u7684\u200bpeft python\u200b\u5305\u200b\u517c\u5bb9\u200b\uff0c\u200b\u800c\u200bfastchat\u200b\u5728\u200b\u591a\u5904\u200b\u4ee5\u200b\u5b57\u7b26\u4e32\u200b\u5339\u914d\u200b\u7684\u200b\u65b9\u5f0f\u200b\u8fdb\u884c\u200b\u786c\u200b\u7f16\u7801\u200b\u52a0\u8f7d\u200b\u6a21\u578b\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5bfc\u81f4\u200bfastchat\u200b\u548c\u200bchatchat\u200b\u4e0d\u80fd\u200b\u517c\u5bb9\u200bp-tuning\uff0c\u200b\u7ecf\u200blangchain-chatchat\u200b\u5f00\u53d1\u200b\u7ec4\u200b\u591a\u6b21\u200b\u5c1d\u8bd5\u200b\uff0c\u200b\u7ed9\u51fa\u200b\u5982\u4e0b\u200b\u6307\u5357\u200b\u8fdb\u884c\u200bp-tuning\u200b\u52a0\u8f7d\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#1-peft","title":"1. peft\u200b\u6587\u4ef6\u5939\u200b\u4fee\u6539","text":"<ol> <li>\u200b\u5c06\u200bconfig.json\u200b\u6587\u4ef6\u200b\u4fee\u6539\u200b\u4e3a\u200badapter_config.json;</li> <li>\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u5939\u200b\u5305\u542b\u200bpytorch_model.bin\u200b\u6587\u4ef6\u200b\uff1b</li> <li>\u200b\u4fee\u6539\u200b\u6587\u4ef6\u5939\u200b\u540d\u79f0\u200b\uff0c\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u5939\u200b\u5305\u542b\u200b'peft'\u200b\u4e00\u8bcd\u200b\uff1b</li> <li>\u200b\u5728\u200badapter_config.json\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u589e\u52a0\u200b\u5982\u4e0b\u200b\u5b57\u200b\u6bb5\u200b\uff1a</li> </ol> <pre><code>    \"base_model_name_or_path\": \"/root/model/chatglm2-6b/\"\n    \"task_type\": \"CAUSAL_LM\",\n    \"peft_type\": \"PREFIX_TUNING\",\n    \"inference_mode\": true,\n    \"revision\": \"main\",\n    \"num_virtual_tokens\": 16\n</code></pre> <p>\u200b\u5176\u4e2d\u200b,\"base_model_name_or_path\"\u200b\u4e3a\u200b\u57fa\u7840\u200b\u6a21\u578b\u200b\u7684\u200b\u5b58\u5728\u200b\u4f4d\u7f6e\u200b\uff1b 5. \u200b\u5c06\u200b\u6587\u4ef6\u5939\u200b\u79fb\u5165\u200b\u9879\u76ee\u200b\u6587\u4ef6\u5939\u200b\u4e2d\u200b\uff0c\u200b\u5982\u200bLangchain-Chatchat\u200b\u9879\u76ee\u200b\u6587\u4ef6\u5939\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff1b</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2-fastchat","title":"2. fastchat\u200b\u5305\u200b\u4ee3\u7801\u200b\u4fee\u6539","text":""},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#21-fastchatmodelmodel_adapter","title":"2.1 fastchat.model.model_adapter\u200b\u6587\u4ef6\u200b\u4fee\u6539","text":"<ol> <li>\u200b\u5c06\u200bfastchat.model.model_adapter.py\u200b\u6587\u4ef6\u200b\u7684\u200bload_model\u200b\u51fd\u6570\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</li> </ol> <p><pre><code>def load_model(\n    model_path: str,\n    device: str = \"cuda\",\n    num_gpus: int = 1,\n    max_gpu_memory: Optional[str] = None,\n    dtype: Optional[torch.dtype] = None,\n    load_8bit: bool = False,\n    cpu_offloading: bool = False,\n    gptq_config: Optional[GptqConfig] = None,\n    awq_config: Optional[AWQConfig] = None,\n    revision: str = \"main\",\n    debug: bool = False,\n    load_kwargs = {}\n):\n    \"\"\"Load a model from Hugging Face.\"\"\"\n    # get model adapter\n    adapter = get_model_adapter(model_path)\n    kwargs = load_kwargs\n    # Handle device mapping\n    cpu_offloading = raise_warning_for_incompatible_cpu_offloading_configuration(\n        device, load_8bit, cpu_offloading\n    )\n    if device == \"cpu\":\n        kwargs[\"torch_dtype\"]= torch.float32\n        if CPU_ISA in [\"avx512_bf16\", \"amx\"]:\n            try:\n                import intel_extension_for_pytorch as ipex\n\n                kwargs [\"torch_dtype\"]= torch.bfloat16\n            except ImportError:\n                warnings.warn(\n                    \"Intel Extension for PyTorch is not installed, it can be installed to accelerate cpu inference\"\n                )\n    elif device == \"cuda\":\n        kwargs[\"torch_dtype\"] = torch.float16\n        if num_gpus != 1:\n            kwargs[\"device_map\"] = \"auto\"\n            if max_gpu_memory is None:\n                kwargs[\n                    \"device_map\"\n                ] = \"sequential\"  # This is important for not the same VRAM sizes\n                available_gpu_memory = get_gpu_memory(num_gpus)\n                kwargs[\"max_memory\"] = {\n                    i: str(int(available_gpu_memory[i] * 0.85)) + \"GiB\"\n                    for i in range(num_gpus)\n                }\n            else:\n                kwargs[\"max_memory\"] = {i: max_gpu_memory for i in range(num_gpus)}\n    elif device == \"mps\":\n        kwargs[\"torch_dtype\"] = torch.float16\n        # Avoid bugs in mps backend by not using in-place operations.\n        replace_llama_attn_with_non_inplace_operations()\n    elif device == \"xpu\":\n        kwargs[\"torch_dtype\"] = torch.bfloat16\n        # Try to load ipex, while it looks unused, it links into torch for xpu support\n        try:\n            import intel_extension_for_pytorch as ipex\n        except ImportError:\n            warnings.warn(\n                \"Intel Extension for PyTorch is not installed, but is required for xpu inference.\"\n            )\n    elif device == \"npu\":\n        kwargs[\"torch_dtype\"]= torch.float16\n        # Try to load ipex, while it looks unused, it links into torch for xpu support\n        try:\n            import torch_npu\n        except ImportError:\n            warnings.warn(\"Ascend Extension for PyTorch is not installed.\")\n    else:\n        raise ValueError(f\"Invalid device: {device}\")\n\n    if cpu_offloading:\n        # raises an error on incompatible platforms\n        from transformers import BitsAndBytesConfig\n\n        if \"max_memory\" in kwargs:\n            kwargs[\"max_memory\"][\"cpu\"] = (\n                str(math.floor(psutil.virtual_memory().available / 2**20)) + \"Mib\"\n            )\n        kwargs[\"quantization_config\"] = BitsAndBytesConfig(\n            load_in_8bit_fp32_cpu_offload=cpu_offloading\n        )\n        kwargs[\"load_in_8bit\"] = load_8bit\n    elif load_8bit:\n        if num_gpus != 1:\n            warnings.warn(\n                \"8-bit quantization is not supported for multi-gpu inference.\"\n            )\n        else:\n            model, tokenizer = adapter.load_compress_model(\n                model_path=model_path,\n                device=device,\n                torch_dtype=kwargs[\"torch_dtype\"],\n                revision=revision,\n            )\n            if debug:\n                print(model)\n            return model, tokenizer\n    elif awq_config and awq_config.wbits &lt; 16:\n        assert (\n            awq_config.wbits == 4\n        ), \"Currently we only support 4-bit inference for AWQ.\"\n        model, tokenizer = load_awq_quantized(model_path, awq_config, device)\n        if num_gpus != 1:\n            device_map = accelerate.infer_auto_device_map(\n                model,\n                max_memory=kwargs[\"max_memory\"],\n                no_split_module_classes=[\n                    \"OPTDecoderLayer\",\n                    \"LlamaDecoderLayer\",\n                    \"BloomBlock\",\n                    \"MPTBlock\",\n                    \"DecoderLayer\",\n                ],\n            )\n            model = accelerate.dispatch_model(\n                model, device_map=device_map, offload_buffers=True\n            )\n        else:\n            model.to(device)\n        return model, tokenizer\n    elif gptq_config and gptq_config.wbits &lt; 16:\n        model, tokenizer = load_gptq_quantized(model_path, gptq_config)\n        if num_gpus != 1:\n            device_map = accelerate.infer_auto_device_map(\n                model,\n                max_memory=kwargs[\"max_memory\"],\n                no_split_module_classes=[\"LlamaDecoderLayer\"],\n            )\n            model = accelerate.dispatch_model(\n                model, device_map=device_map, offload_buffers=True\n            )\n        else:\n            model.to(device)\n        return model, tokenizer\n    kwargs[\"revision\"] = revision\n\n    if dtype is not None:  # Overwrite dtype if it is provided in the arguments.\n        kwargs[\"torch_dtype\"] = dtype\n\n    # Load model\n    model, tokenizer = adapter.load_model(model_path, kwargs)\n\n    if (\n        device == \"cpu\"\n        and kwargs[\"torch_dtype\"] is torch.bfloat16\n        and CPU_ISA is not None\n    ):\n        model = ipex.optimize(model, dtype=kwargs[\"torch_dtype\"])\n\n    if (device == \"cuda\" and num_gpus == 1 and not cpu_offloading) or device in (\n        \"mps\",\n        \"xpu\",\n        \"npu\",\n    ):\n        model.to(device)\n\n    if device == \"xpu\":\n        model = torch.xpu.optimize(model, dtype=kwargs[\"torch_dtype\"], inplace=True)\n\n    if debug:\n        print(model)\n\n    return model, tokenizer\n</code></pre> 2. \u200b\u5c06\u200bfastchat.model.model_adapter.py\u200b\u7684\u200b\u51fd\u6570\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</p> <p><pre><code>def get_generate_stream_function(model: torch.nn.Module, model_path: str):\n    \"\"\"Get the generate_stream function for inference.\"\"\"\n    from fastchat.serve.inference import generate_stream\n\n    model_type = str(type(model)).lower()\n\n    is_chatglm = \"chatglm\" in model_type \n    is_falcon = \"rwforcausallm\" in model_type\n    is_codet5p = \"codet5p\" in model_type \n    is_peft = \"peft\" in model_type\n\n    if is_chatglm:\n        return generate_stream_chatglm\n    elif is_falcon:\n        return generate_stream_falcon\n    elif is_codet5p:\n        return generate_stream_codet5p\n    elif peft_share_base_weights and is_peft:\n        # Return a curried stream function that loads the right adapter\n        # according to the model_name available in this context.  This ensures\n        # the right weights are available.\n        @torch.inference_mode()\n        def generate_stream_peft(\n            model,\n            tokenizer,\n            params: Dict,\n            device: str,\n            context_len: int,\n            stream_interval: int = 2,\n            judge_sent_end: bool = False,\n        ):\n\n            model.set_adapter(model_path)\n            if \"chatglm\" in str(type(model.base_model)).lower():\n                model.disable_adapter()\n                prefix_state_dict = torch.load(os.path.join(model_path, \"pytorch_model.bin\"))\n                new_prefix_state_dict = {}\n\n                for k, v in prefix_state_dict.items():\n                    if k.startswith(\"transformer.prefix_encoder.\"):\n                        new_prefix_state_dict[k[len(\"transformer.prefix_encoder.\"):]] = v\n                    elif k.startswith(\"transformer.prompt_encoder.\"):\n                        new_prefix_state_dict[k[len(\"transformer.prompt_encoder.\"):]] = v\n                model.transformer.prefix_encoder.load_state_dict(new_prefix_state_dict)\n                for x in generate_stream_chatglm(\n                    model,\n                    tokenizer,\n                    params,\n                    device,\n                    context_len,\n                    stream_interval,\n                    judge_sent_end,\n                ):\n                    yield x\n            elif \"rwforcausallm\" in str(type(model.base_model)).lower():\n\n                for x in generate_stream_falcon(\n                    model,\n                    tokenizer,\n                    params,\n                    device,\n                    context_len,\n                    stream_interval,\n                    judge_sent_end,\n                ):\n                    yield x   \n            elif \"codet5p\" in str(type(model.base_model)).lower():\n\n                for x in generate_stream_codet5p(\n                    model,\n                    tokenizer,\n                    params,\n                    device,\n                    context_len,\n                    stream_interval,\n                    judge_sent_end,\n                ):\n                    yield x   \n            else:\n\n                for x in generate_stream(\n                    model,\n                    tokenizer,\n                    params,\n                    device,\n                    context_len,\n                    stream_interval,\n                    judge_sent_end,\n                ):\n                    yield x\n\n        return generate_stream_peft\n    else:\n        return generate_stream\n</code></pre> 3. \u200b\u5c06\u200bfastchat.model.model_adapter.py\u200b\u7684\u200bPeftModelAdapter\u200b\u7c7b\u200b\u7684\u200bload_model\u200b\u65b9\u6cd5\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</p> <p><pre><code>    def load_model(self, model_path: str, from_pretrained_kwargs: dict):\n        \"\"\"Loads the base model then the (peft) adapter weights\"\"\"\n        from peft import PeftConfig, PeftModel\n\n        config = PeftConfig.from_pretrained(model_path)\n        base_model_path = config.base_model_name_or_path\n        if \"peft\" in base_model_path:\n            raise ValueError(\n                f\"PeftModelAdapter cannot load a base model with 'peft' in the name: {config.base_model_name_or_path}\"\n            )\n\n        # Basic proof of concept for loading peft adapters that share the base\n        # weights.  This is pretty messy because Peft re-writes the underlying\n        # base model and internally stores a map of adapter layers.\n        # So, to make this work we:\n        #  1. Cache the first peft model loaded for a given base models.\n        #  2. Call `load_model` for any follow on Peft models.\n        #  3. Make sure we load the adapters by the model_path.  Why? This is\n        #  what's accessible during inference time.\n        #  4. In get_generate_stream_function, make sure we load the right\n        #  adapter before doing inference.  This *should* be safe when calls\n        #  are blocked the same semaphore.\n        if peft_share_base_weights:\n            if base_model_path in peft_model_cache:\n                model, tokenizer = peft_model_cache[base_model_path]\n                # Super important: make sure we use model_path as the\n                # `adapter_name`.\n                model.load_adapter(model_path, adapter_name=model_path)\n            else:\n                base_adapter = get_model_adapter(base_model_path)\n                base_model, tokenizer = base_adapter.load_model(\n                    base_model_path, from_pretrained_kwargs\n                )\n                # Super important: make sure we use model_path as the\n                # `adapter_name`.\n                from peft import get_peft_model\n                model = get_peft_model(base_model,config,adapter_name=model_path)\n                peft_model_cache[base_model_path] = (model, tokenizer)\n            return model, tokenizer\n\n        # In the normal case, load up the base model weights again.\n        base_adapter = get_model_adapter(base_model_path)\n        base_model, tokenizer = base_adapter.load_model(\n            base_model_path, from_pretrained_kwargs\n        )\n        from peft import get_peft_model\n        model = get_peft_model(base_model,config,adapter_name=model_path)\n        return model, tokenizer\n</code></pre> 4. \u200b\u5c06\u200bfastchat.model.model_adapter.py\u200b\u7684\u200bChatglmAdapter\u200b\u7c7b\u200b\u7684\u200bload_model\u200b\u65b9\u6cd5\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</p> <pre><code>    def load_model(self, model_path: str, from_pretrained_kwargs: dict):\n        revision = from_pretrained_kwargs.get(\"revision\", \"main\")\n        tokenizer = AutoTokenizer.from_pretrained(\n            model_path, trust_remote_code=True, revision=revision\n        )\n        config = AutoConfig.from_pretrained(model_path, trust_remote_code=True,**from_pretrained_kwargs)\n        model = AutoModel.from_pretrained(\n            model_path, trust_remote_code=True, config=config\n        )\n        return model, tokenizer\n</code></pre>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#22-fastchatservemodel_worker","title":"2.2 fastchat.serve.model_worker\u200b\u6587\u4ef6\u200b\u4fee\u6539","text":"<ol> <li>\u200b\u5c06\u200bfastchat.serve.model_worker\u200b\u6587\u4ef6\u200b\u7684\u200bModelWorker\u200b\u7684\u200b__init__\u200b\u65b9\u6cd5\u200b\u4fee\u6539\u200b\u5982\u4e0b\u200b\uff1a</li> </ol> <p><pre><code>class ModelWorker(BaseModelWorker):\n    def __init__(\n        self,\n        controller_addr: str,\n        worker_addr: str,\n        worker_id: str,\n        model_path: str,\n        model_names: List[str],\n        limit_worker_concurrency: int,\n        no_register: bool,\n        device: str,\n        num_gpus: int,\n        max_gpu_memory: str,\n        dtype: Optional[torch.dtype] = None,\n        load_8bit: bool = False,\n        cpu_offloading: bool = False,\n        gptq_config: Optional[GptqConfig] = None,\n        awq_config: Optional[AWQConfig] = None,\n        stream_interval: int = 2,\n        conv_template: Optional[str] = None,\n        embed_in_truncate: bool = False,\n        seed: Optional[int] = None,\n        load_kwargs = {}, #\u200b\u4fee\u6539\u200b\u70b9\u200b\n        **kwargs,\n    ):\n        super().__init__(\n            controller_addr,\n            worker_addr,\n            worker_id,\n            model_path,\n            model_names,\n            limit_worker_concurrency,\n            conv_template=conv_template,\n        )\n\n        logger.info(f\"Loading the model {self.model_names} on worker {worker_id} ...\")\n        self.model, self.tokenizer = load_model(\n            model_path,\n            device=device,\n            num_gpus=num_gpus,\n            max_gpu_memory=max_gpu_memory,\n            dtype=dtype,\n            load_8bit=load_8bit,\n            cpu_offloading=cpu_offloading,\n            gptq_config=gptq_config,\n            awq_config=awq_config,\n            load_kwargs=load_kwargs #\u200b\u4fee\u6539\u200b\u70b9\u200b\n        )\n        self.device = device\n        if self.tokenizer.pad_token == None:\n            self.tokenizer.pad_token = self.tokenizer.eos_token\n        self.context_len = get_context_length(self.model.config)\n        print(\"**\"*100)\n        self.generate_stream_func = get_generate_stream_function(self.model, model_path)\n        print(f\"self.generate_stream_func{self.generate_stream_func}\")\n        print(\"*\"*100)\n        self.stream_interval = stream_interval\n        self.embed_in_truncate = embed_in_truncate\n        self.seed = seed\n\n        if not no_register:\n            self.init_heart_beat()\n</code></pre> 2. \u200b\u5728\u200bfastchat.serve.model_worker\u200b\u6587\u4ef6\u200b\u7684\u200bcreate_model_worker\u200b\u589e\u52a0\u200b\u5982\u4e0b\u200bargs\u200b\u53c2\u6570\u200b\uff1a</p> <pre><code>parser.add_argument(\"--load_kwargs\",type=dict,default={})\n</code></pre> <pre><code>\u200b\u5e76\u200b\u5c06\u200b\u5982\u4e0b\u200b\u8bed\u53e5\u200b\uff1a\n</code></pre> <pre><code>    worker = ModelWorker(\n        args.controller_address,\n        args.worker_address,\n        worker_id,\n        args.model_path,\n        args.model_names,\n        args.limit_worker_concurrency,\n        no_register=args.no_register,\n        device=args.device,\n        num_gpus=args.num_gpus,\n        max_gpu_memory=args.max_gpu_memory,\n        dtype=str_to_torch_dtype(args.dtype),\n        load_8bit=args.load_8bit,\n        cpu_offloading=args.cpu_offloading,\n        gptq_config=gptq_config,\n        awq_config=awq_config,\n        stream_interval=args.stream_interval,\n        conv_template=args.conv_template,\n        embed_in_truncate=args.embed_in_truncate,\n        seed=args.seed,\n    )\n</code></pre> <p>\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</p> <pre><code>    worker = ModelWorker(\n        args.controller_address,\n        args.worker_address,\n        worker_id,\n        args.model_path,\n        args.model_names,\n        args.limit_worker_concurrency,\n        no_register=args.no_register,\n        device=args.device,\n        num_gpus=args.num_gpus,\n        max_gpu_memory=args.max_gpu_memory,\n        dtype=str_to_torch_dtype(args.dtype),\n        load_8bit=args.load_8bit,\n        cpu_offloading=args.cpu_offloading,\n        gptq_config=gptq_config,\n        awq_config=awq_config,\n        stream_interval=args.stream_interval,\n        conv_template=args.conv_template,\n        embed_in_truncate=args.embed_in_truncate,\n        seed=args.seed,\n        load_kwargs=args.load_kwargs\n    )\n</code></pre> <p>\u200b\u81f3\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u5b8c\u6210\u200b\u4e86\u200bfastchat\u200b\u52a0\u8f7d\u200bptuning\u200b\u7684\u200b\u6240\u6709\u200b\u4fee\u6539\u200b\uff0c\u200b\u5728\u200b\u8c03\u7528\u200bfastchat\u200b\u52a0\u8f7d\u200bp-tuning\u200b\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u52a0\u5165\u200b <code>PEFT_SHARE_BASE_WEIGHTS=true</code>\uff0c\u200b\u5e76\u200b\u4ee5\u200b\u5b57\u5178\u200b\u7684\u200b\u5f62\u5f0f\u200b\u6dfb\u52a0\u200b--load_kwargs\u200b\u53c2\u6570\u200b\u4e3a\u200b\u8bad\u7ec3\u200bptuning\u200b\u65f6\u200b\u7684\u200bpre_seq_len\u200b\u503c\u200b\u5373\u53ef\u200b\uff0c\u200b\u4f8b\u5982\u200b\u5c06\u200b2.2.2\u200b\u6b65\u9aa4\u200b\u4e2d\u200b\u7684\u200b <code>parser.add_argument(\"--load_kwargs\",type=dict,default={})</code>\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</p> <p><code>parser.add_argument(\"--load_kwargs\",type=dict,default={\"pre_seq_len\":16})</code></p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#3-langchain-chatchat","title":"3 langchain-chatchat\u200b\u4ee3\u7801\u200b\u4fee\u6539\u200b\uff1a","text":"<ol> <li>\u200b\u5728\u200bconfigs/serve_config.py\u200b\u4e2d\u200b\u7684\u200bFSCHAT_MODEL_WORKERS\u200b\u5b57\u5178\u200b\u4e2d\u200b\u589e\u52a0\u200b\u5982\u4e0b\u200b\u5b57\u200b\u6bb5\u200b\uff1a</li> </ol> <p><pre><code>\"load_kwargs\": {\"pre_seq_len\": 16} #\u200b\u503c\u200b\u4fee\u6539\u200b\u4e3a\u200badapter_config.json\u200b\u4e2d\u200b\u7684\u200bpre_seq_len\u200b\u503c\u200b\n</code></pre> 2. \u200b\u5c06\u200bstartup.py\u200b\u4e2d\u200b\u7684\u200bcreate_model_worker_app\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a</p> <pre><code>def create_model_worker_app(log_level: str = \"INFO\", **kwargs) -&gt; FastAPI:\n    \"\"\"\n    kwargs\u200b\u5305\u542b\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\u5982\u4e0b\u200b\uff1a\n    host:\n    port:\n    model_names:[`model_name`]\n    controller_address:\n    worker_address:\n\n\n    \u200b\u5bf9\u4e8e\u200bonline_api:\n        online_api:True\n        worker_class: `provider`\n    \u200b\u5bf9\u4e8e\u200b\u79bb\u7ebf\u200b\u6a21\u578b\u200b\uff1a\n        model_path: `model_name_or_path`,huggingface\u200b\u7684\u200brepo-id\u200b\u6216\u200b\u672c\u5730\u200b\u8def\u5f84\u200b\n        device:`LLM_DEVICE`\n    \"\"\"\n    import fastchat.constants\n    fastchat.constants.LOGDIR = LOG_PATH\n    from fastchat.serve.model_worker import worker_id, logger\n    import argparse\n    logger.setLevel(log_level)\n\n    parser = argparse.ArgumentParser()\n    args = parser.parse_args([])\n\n    for k, v in kwargs.items():\n        setattr(args, k, v)\n\n    # \u200b\u5728\u7ebf\u200b\u6a21\u578b\u200bAPI\n    if worker_class := kwargs.get(\"worker_class\"):\n        from fastchat.serve.model_worker import app\n        worker = worker_class(model_names=args.model_names,\n                              controller_addr=args.controller_address,\n                              worker_addr=args.worker_address)\n        sys.modules[\"fastchat.serve.model_worker\"].worker = worker\n    # \u200b\u672c\u5730\u200b\u6a21\u578b\u200b\n    else:\n        from configs.model_config import VLLM_MODEL_DICT\n        if kwargs[\"model_names\"][0] in VLLM_MODEL_DICT and args.infer_turbo == \"vllm\":\n            import fastchat.serve.vllm_worker\n            from fastchat.serve.vllm_worker import VLLMWorker,app\n            from vllm import AsyncLLMEngine\n            from vllm.engine.arg_utils import AsyncEngineArgs,EngineArgs\n            args.tokenizer = args.model_path # \u200b\u5982\u679c\u200btokenizer\u200b\u4e0e\u200bmodel_path\u200b\u4e0d\u200b\u4e00\u81f4\u200b\u5728\u200b\u6b64\u5904\u200b\u6dfb\u52a0\u200b\n            args.tokenizer_mode = 'auto'\n            args.trust_remote_code= True\n            args.download_dir= None\n            args.load_format = 'auto'\n            args.dtype = 'auto'\n            args.seed = 0\n            args.worker_use_ray = False\n            args.pipeline_parallel_size = 1\n            args.tensor_parallel_size = 1\n            args.block_size = 16\n            args.swap_space = 4  # GiB\n            args.gpu_memory_utilization = 0.90\n            args.max_num_batched_tokens = 2560\n            args.max_num_seqs = 256\n            args.disable_log_stats = False\n            args.conv_template = None\n            args.limit_worker_concurrency = 5\n            args.no_register = False\n            args.num_gpus = 1 # vllm worker\u200b\u7684\u200b\u5207\u5206\u200b\u662f\u200btensor\u200b\u5e76\u884c\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u586b\u5199\u200b\u663e\u5361\u200b\u7684\u200b\u6570\u91cf\u200b\n            args.engine_use_ray = False\n            args.disable_log_requests = False\n            if args.model_path:\n                args.model = args.model_path\n            if args.num_gpus &gt; 1:\n                args.tensor_parallel_size = args.num_gpus\n\n            for k, v in kwargs.items():\n                setattr(args, k, v)\n\n            engine_args = AsyncEngineArgs.from_cli_args(args)\n            engine = AsyncLLMEngine.from_engine_args(engine_args)\n\n            worker = VLLMWorker(\n                        controller_addr = args.controller_address,\n                        worker_addr = args.worker_address,\n                        worker_id = worker_id,\n                        model_path = args.model_path,\n                        model_names = args.model_names,\n                        limit_worker_concurrency = args.limit_worker_concurrency,\n                        no_register = args.no_register,\n                        llm_engine =  engine,\n                        conv_template = args.conv_template,\n                        )\n            sys.modules[\"fastchat.serve.vllm_worker\"].engine = engine\n            sys.modules[\"fastchat.serve.vllm_worker\"].worker = worker\n\n        else:\n            from fastchat.serve.model_worker import app, GptqConfig, AWQConfig, ModelWorker\n            args.gpus = \"0\" # GPU\u200b\u7684\u200b\u7f16\u53f7\u200b,\u200b\u5982\u679c\u200b\u6709\u200b\u591a\u4e2a\u200bGPU\uff0c\u200b\u53ef\u4ee5\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b\"0,1,2,3\"\n            args.max_gpu_memory = \"20GiB\"\n            args.num_gpus = 1  # model worker\u200b\u7684\u200b\u5207\u5206\u200b\u662f\u200bmodel\u200b\u5e76\u884c\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u586b\u5199\u200b\u663e\u5361\u200b\u7684\u200b\u6570\u91cf\u200b\n\n            args.load_8bit = False\n            args.cpu_offloading = None\n            args.gptq_ckpt = None\n            args.gptq_wbits = 16\n            args.gptq_groupsize = -1\n            args.gptq_act_order = False\n            args.awq_ckpt = None\n            args.awq_wbits = 16\n            args.awq_groupsize = -1\n            args.model_names = []\n            args.conv_template = None\n            args.limit_worker_concurrency = 5\n            args.stream_interval = 2\n            args.no_register = False\n            args.embed_in_truncate = False\n            args.load_kwargs = {\"pre_seq_len\": 16} # \u200b\u6539\u200b*************************\n            for k, v in kwargs.items():\n                setattr(args, k, v)\n            if args.gpus:\n                if args.num_gpus is None:\n                    args.num_gpus = len(args.gpus.split(','))\n                if len(args.gpus.split(\",\")) &lt; args.num_gpus:\n                    raise ValueError(\n                        f\"Larger --num-gpus ({args.num_gpus}) than --gpus {args.gpus}!\"\n                    )\n                os.environ[\"CUDA_VISIBLE_DEVICES\"] = args.gpus\n            gptq_config = GptqConfig(\n                ckpt=args.gptq_ckpt or args.model_path,\n                wbits=args.gptq_wbits,\n                groupsize=args.gptq_groupsize,\n                act_order=args.gptq_act_order,\n            )\n            awq_config = AWQConfig(\n                ckpt=args.awq_ckpt or args.model_path,\n                wbits=args.awq_wbits,\n                groupsize=args.awq_groupsize,\n            )\n\n            worker = ModelWorker(\n                controller_addr=args.controller_address,\n                worker_addr=args.worker_address,\n                worker_id=worker_id,\n                model_path=args.model_path,\n                model_names=args.model_names,\n                limit_worker_concurrency=args.limit_worker_concurrency,\n                no_register=args.no_register,\n                device=args.device,\n                num_gpus=args.num_gpus,\n                max_gpu_memory=args.max_gpu_memory,\n                load_8bit=args.load_8bit,\n                cpu_offloading=args.cpu_offloading,\n                gptq_config=gptq_config,\n                awq_config=awq_config,\n                stream_interval=args.stream_interval,\n                conv_template=args.conv_template,\n                embed_in_truncate=args.embed_in_truncate,\n                load_kwargs=args.load_kwargs #\u200b\u6539\u200b*************************\n            )\n            sys.modules[\"fastchat.serve.model_worker\"].args = args\n            sys.modules[\"fastchat.serve.model_worker\"].gptq_config = gptq_config\n\n            sys.modules[\"fastchat.serve.model_worker\"].worker = worker\n\n    MakeFastAPIOffline(app)\n    app.title = f\"FastChat LLM Server ({args.model_names[0]})\"\n    app._worker = worker\n    return app\n</code></pre> <p>\u200b\u81f3\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u5b8c\u6210\u200b\u4e86\u200blangchain-chatchat\u200b\u52a0\u8f7d\u200bp-tuning\u200b\u7684\u200b\u5168\u90e8\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5c06\u200bptuing\u200b\u7684\u200b\u8def\u5f84\u200b\u6dfb\u52a0\u200b\u5230\u200bmodel_config\u200b\u7684\u200bllm_dict\uff0c\u200b\u5982\u200b    ``` chatglm2-6b: 'p-tuning-peft' <pre><code>\u200b\u5373\u200b\u53ef\u4ee5\u200b\u5982\u4e0b\u200b\u65b9\u5f0f\u200b\u52a0\u8f7d\u200bp-tuning\uff1a\n\n```shell\nPEFT_SHARE_BASE_WEIGHTS=true python startup.py -a\n</code></pre></p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_3","title":"\u9884\u5904\u7406\u200b\u77e5\u8bc6\u5e93\u200b\u6587\u4ef6","text":"<p>\u200b\u5728\u200b\u8f7d\u5165\u200b\u77e5\u8bc6\u5e93\u200b\u6587\u4ef6\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u76f4\u63a5\u200b\u4e0a\u4f20\u200b\u6587\u6863\u200b\u867d\u7136\u200b\u80fd\u200b\u5b9e\u73b0\u200b\u57fa\u7840\u200b\u7684\u200b\u95ee\u7b54\u200b\uff0c\u200b\u4f46\u662f\u200b\uff0c\u200b\u5176\u200b\u6548\u679c\u200b\u5e76\u200b\u4e0d\u80fd\u200b\u53d1\u6325\u200b\u5230\u200b\u6700\u4f73\u200b\u6c34\u5e73\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u5f00\u53d1\u8005\u200b\u5bf9\u200b\u77e5\u8bc6\u5e93\u200b\u6587\u4ef6\u200b\u505a\u51fa\u200b\u4ee5\u4e0b\u200b\u7684\u200b\u9884\u5904\u7406\u200b\u3002 \u200b\u4ee5\u4e0b\u200b\u65b9\u5f0f\u200b\u7684\u200b\u9884\u5904\u7406\u200b\u5982\u679c\u200b\u6267\u884c\u200b\u4e86\u200b\uff0c\u200b\u6709\u200b\u6982\u7387\u200b\u63d0\u5347\u200b\u6a21\u578b\u200b\u7684\u200b\u53ec\u56de\u200b\u7387\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#1-txt-markdown","title":"1. \u200b\u4f7f\u7528\u200b<code>TXT / Markdown</code> \u200b\u7b49\u200b\u683c\u5f0f\u5316\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u6309\u7167\u200b\u8981\u70b9\u200b\u6392\u7248","text":"<p>\u200b\u4f8b\u5982\u200b\uff0c\u200b\u4ee5\u4e0b\u200b\u6bb5\u843d\u200b\u5e94\u8be5\u200b\u88ab\u200b\u5904\u7406\u200b\u6210\u200b\u5982\u4e0b\u200b\u5185\u5bb9\u200b\u540e\u200b\u5728\u200b\u5d4c\u5165\u200b\u77e5\u8bc6\u5e93\u200b\uff0c\u200b\u4f1a\u200b\u6709\u200b\u66f4\u597d\u200b\u7684\u200b\u6548\u679c\u200b\u3002 <pre><code>\u200b\u539f\u6587\u200b: PDF\u200b\u7c7b\u578b\u200b\n\u200b\u67e5\u7279\u200b\u67e5\u7279\u200b\u56e2\u961f\u200b\u8363\u83b7\u200bAGI Playground Hackathon\u200b\u9ed1\u5ba2\u200b\u677e\u200b\u201c\u200b\u751f\u4ea7\u529b\u200b\u5de5\u5177\u200b\u7684\u200b\u65b0\u200b\u60f3\u8c61\u200b\u201d\u200b\u8d5b\u9053\u200b\u5b63\u519b\u200b\n2023\u200b\u5e74\u200b10\u200b\u6708\u200b16\u200b\u65e5\u200b, Founder Park\u200b\u5728\u200b\u8fd1\u65e5\u200b\u7ed3\u675f\u200b\u7684\u200bAGI Playground Hackathon\u200b\u9ed1\u5ba2\u200b\u677e\u200b\u6bd4\u8d5b\u200b\u4e2d\u200b\uff0c\u200b\u67e5\u7279\u200b\u67e5\u7279\u200b\u56e2\u961f\u200b\u5c55\u73b0\u200b\u51fa\u8272\u200b\u7684\u200b\u5b9e\u529b\u200b\uff0c\u200b\u8363\u83b7\u200b\u4e86\u200b\u201c\u200b\u751f\u4ea7\u529b\u200b\u5de5\u5177\u200b\u7684\u200b\u65b0\u200b\u60f3\u8c61\u200b\u201d\u200b\u8d5b\u9053\u200b\u5b63\u519b\u200b\u3002\u200b\u672c\u6b21\u200b\u6bd4\u8d5b\u200b\u7531\u200bFounder Park\u200b\u4e3b\u529e\u200b\uff0c\u200b\u5e76\u200b\u7531\u667a\u8c31\u200b\u3001Dify\u3001Zilliz\u3001\u200b\u58f0\u7f51\u200b\u3001AWS\u200b\u4e91\u200b\u670d\u52a1\u200b\u7b49\u200b\u4f01\u4e1a\u200b\u534f\u529e\u200b\u3002\n\u200b\u6bd4\u8d5b\u200b\u5438\u5f15\u200b\u4e86\u200b120\u200b\u591a\u652f\u200b\u53c2\u8d5b\u200b\u56e2\u961f\u200b\uff0c\u200b\u6700\u7ec8\u200b\u6709\u200b36\u200b\u652f\u200b\u961f\u4f0d\u200b\u8fdb\u5165\u200b\u51b3\u8d5b\u200b\uff0c\u200b\u5176\u4e2d\u200b34\u200b\u652f\u200b\u961f\u4f0d\u200b\u6210\u529f\u200b\u5b8c\u6210\u200b\u4e86\u200b\u8def\u6f14\u200b\u3002\u200b\u6bd4\u8d5b\u200b\u89c4\u5b9a\u200b\uff0c\u200b\u6240\u6709\u200b\u53c2\u8d5b\u9009\u624b\u200b\u5fc5\u987b\u200b\u5728\u200b\u77ed\u77ed\u7684\u200b48\u200b\u5c0f\u65f6\u200b\u5185\u200b\u5b8c\u6210\u200b\u4e00\u4e2a\u200b\u5e94\u7528\u200b\u4ea7\u54c1\u5f00\u53d1\u200b\uff0c\u200b\u540c\u65f6\u200b\u8981\u6c42\u200b\u4f7f\u7528\u200b\u667a\u8c31\u200b\u5927\u200b\u6a21\u578b\u200b\u53ca\u200bZilliz\u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b\u8fdb\u884c\u200b\u5f00\u53d1\u200b\u3002\n\u200b\u67e5\u7279\u200b\u67e5\u7279\u200b\u56e2\u961f\u200b\u7684\u200b\u73b0\u573a\u200b\u53c2\u8d5b\u200b\u4eba\u5458\u200b\u7531\u200b\u4e24\u540d\u200b\u9879\u76ee\u200b\u6210\u5458\u200b\u7ec4\u6210\u200b\uff1a\n\u200b\u6765\u81ea\u200bA\u200b\u5927\u5b66\u200b\u7684\u200b\u5c0f\u660e\u200b\u8d1f\u8d23\u200b\u4e86\u200bAgent\u200b\u65c5\u6e38\u200b\u52a9\u624b\u200b\u7684\u200b\u5f00\u53d1\u200b\u3001\u200b\u573a\u5730\u200b\u534f\u8c03\u200b\u4ee5\u53ca\u200b\u56e2\u961f\u200b\u4f4f\u5bbf\u200b\u548c\u200b\u884c\u7a0b\u200b\u7684\u200b\u5b89\u6392\u200b\uff1b\u200b\u5728\u200b\u4fdd\u8bc1\u200b\u56e2\u961f\u200b\u5b8c\u8d5b\u200b\u4e0a\u200b\u505a\u51fa\u200b\u4e86\u200b\u4e3b\u8981\u200b\u8d21\u732e\u200b\u3002\u200b\u4f5c\u4e3a\u200b\u961f\u957f\u200b\uff0c\u200b\u680b\u5b87\u200b\u575a\u6301\u200b\u81ea\u4fe1\u200b\uff0c\u200b\u521b\u65b0\u200b\uff0c\u200b\u6c89\u7740\u200b\u7684\u200b\u7cbe\u795e\u200b\uff0c\u200b\u4e0d\u65ad\u200b\u63d0\u51fa\u200b\u6539\u8fdb\u200b\u65b9\u6848\u200b\u5e76\u200b\u6293\u7d27\u200b\u843d\u5b9e\u200b\uff0c\u200b\u9047\u5230\u200b\u76f8\u5173\u200b\u95ee\u9898\u200b\u79ef\u6781\u200b\u8bf7\u6559\u200b\u8001\u5e08\u200b\uff0c\u200b\u63d0\u9ad8\u200b\u4e86\u200b\u56e2\u961f\u200b\u5f00\u53d1\u200b\u6548\u7387\u200b\u3002\n\u200b\u4f5c\u4e3a\u200b\u6838\u5fc3\u200b\u5f00\u53d1\u8005\u200b\u7684\u200bB\u200b\u516c\u53f8\u200b\u5c0f\u84dd\u200b\uff0c\u200b\u4ed6\u200b\u5219\u200b\u4e3b\u7ba1\u200bAgent\u200b\u667a\u80fd\u200b\u77e5\u8bc6\u5e93\u200b\u67e5\u8be2\u200b\u5f00\u53d1\u200b\u3001Agent\u200b\u5e95\u5c42\u200b\u6846\u67b6\u200b\u8bbe\u8ba1\u200b\u3001\u200b\u76f8\u5173\u200bAPI\u200b\u8c03\u6574\u200b\u548c\u200bUI\u200b\u8c03\u6574\u200b\u3002\u200b\u5728\u200b\u6700\u540e\u200b\uff0c\u200b\u4ed6\u200b\u4ee3\u8868\u200b\u56e2\u961f\u200b\u5728\u200b\u89c4\u5b9a\u200b\u7684\u200b\u65f6\u95f4\u200b\u5185\u200b\u5448\u73b0\u200b\u4e86\u200b\u4ea7\u54c1\u200b\u7684\u200b\u7279\u70b9\u200b\u548c\u200b\u4f18\u52bf\u200b\uff0c\u200b\u5e76\u200b\u5b8c\u7f8e\u200b\u7684\u200b\u5c55\u793a\u200b\u4e86\u200b\u4ea7\u54c1\u200bdemo\u3002\u200b\u4e3a\u200b\u56e2\u961f\u200b\u6700\u7ec8\u200b\u4ea7\u54c1\u200b\u80fd\u591f\u200b\u5f97\u5230\u200b\u5956\u9879\u200b\u505a\u51fa\u200b\u4e86\u200b\u91cd\u8981\u200b\u8d21\u732e\u200b\u3002\n</code></pre> \u200b\u4fee\u6539\u200b\u540e\u200b\u7684\u200bMarkdown\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5177\u6709\u200b\u66f4\u200b\u9ad8\u200b\u7684\u200b\u53ec\u56de\u200b\u7387\u200b <pre><code># \u200b\u67e5\u7279\u200b\u67e5\u7279\u200b\u56e2\u961f\u200b\u8363\u83b7\u200bAGI Playground Hackathon\u200b\u9ed1\u5ba2\u200b\u677e\u200b\u201c\u200b\u751f\u4ea7\u529b\u200b\u5de5\u5177\u200b\u7684\u200b\u65b0\u200b\u60f3\u8c61\u200b\u201d\u200b\u8d5b\u9053\u200b\u5b63\u519b\u200b\u3002\n\n## \u200b\u62a5\u9053\u200b\u7b80\u4ecb\u200b\n2023\u200b\u5e74\u200b10\u200b\u6708\u200b16\u200b\u65e5\u200b, Founder Park\u200b\u5728\u200b\u8fd1\u65e5\u200b\u7ed3\u675f\u200b\u7684\u200bAGI Playground Hackathon\u200b\u9ed1\u5ba2\u200b\u677e\u200b\u6bd4\u8d5b\u200b\u4e2d\u200b\uff0c\u200b\u67e5\u7279\u200b\u67e5\u7279\u200b\u56e2\u961f\u200b\u5c55\u73b0\u200b\u51fa\u8272\u200b\u7684\u200b\u5b9e\u529b\u200b\uff0c\u200b\u8363\u83b7\u200b\u4e86\u200b\u201c\u200b\u751f\u4ea7\u529b\u200b\u5de5\u5177\u200b\u7684\u200b\u65b0\u200b\u60f3\u8c61\u200b\u201d\u200b\u8d5b\u9053\u200b\u5b63\u519b\u200b\u3002\u200b\u672c\u6b21\u200b\u6bd4\u8d5b\u200b\u7531\u200bFounder Park\u200b\u4e3b\u529e\u200b\uff0c\u200b\u5e76\u200b\u7531\u667a\u8c31\u200b\u3001Dify\u3001Zilliz\u3001\u200b\u58f0\u7f51\u200b\u3001AWS\u200b\u4e91\u200b\u670d\u52a1\u200b\u7b49\u200b\u4f01\u4e1a\u200b\u534f\u529e\u200b\u3002\n\n## \u200b\u6bd4\u8d5b\u200b\u4ecb\u7ecd\u200b\n\n\u200b\u6bd4\u8d5b\u200b\u5438\u5f15\u200b\u4e86\u200b120\u200b\u591a\u652f\u200b\u53c2\u8d5b\u200b\u56e2\u961f\u200b\uff0c\u200b\u6700\u7ec8\u200b\u6709\u200b36\u200b\u652f\u200b\u961f\u4f0d\u200b\u8fdb\u5165\u200b\u51b3\u8d5b\u200b\uff0c\u200b\u5176\u4e2d\u200b34\u200b\u652f\u200b\u961f\u4f0d\u200b\u6210\u529f\u200b\u5b8c\u6210\u200b\u4e86\u200b\u8def\u6f14\u200b\u3002\u200b\u6bd4\u8d5b\u200b\u89c4\u5b9a\u200b\uff0c\u200b\u6240\u6709\u200b\u53c2\u8d5b\u9009\u624b\u200b\u5fc5\u987b\u200b\u5728\u200b\u77ed\u77ed\u7684\u200b48\u200b\u5c0f\u65f6\u200b\u5185\u200b\u5b8c\u6210\u200b\u4e00\u4e2a\u200b\u5e94\u7528\u200b\u4ea7\u54c1\u5f00\u53d1\u200b\uff0c\u200b\u540c\u65f6\u200b\u8981\u6c42\u200b\u4f7f\u7528\u200b\u667a\u8c31\u200b\u5927\u200b\u6a21\u578b\u200b\u53ca\u200bZilliz\u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b\u8fdb\u884c\u200b\u5f00\u53d1\u200b\u3002\n\n## \u200b\u83b7\u5956\u200b\u961f\u5458\u200b\u7b80\u4ecb\u200b\n\n+ \u200b\u5c0f\u660e\u200b\uff0cA\u200b\u5927\u5b66\u200b\n  + \u200b\u8d1f\u8d23\u200bAgent\u200b\u65c5\u6e38\u200b\u52a9\u624b\u200b\u7684\u200b\u5f00\u53d1\u200b\u3001\u200b\u573a\u5730\u200b\u534f\u8c03\u200b\u4ee5\u53ca\u200b\u56e2\u961f\u200b\u4f4f\u5bbf\u200b\u548c\u200b\u884c\u7a0b\u200b\u7684\u200b\u5b89\u6392\u200b\n  + \u200b\u5728\u200b\u4fdd\u8bc1\u200b\u56e2\u961f\u200b\u5b8c\u8d5b\u200b\u4e0a\u200b\u505a\u51fa\u200b\u4e86\u200b\u4e3b\u8981\u200b\u8d21\u732e\u200b\u3002\u200b\u4f5c\u4e3a\u200b\u961f\u957f\u200b\uff0c\u200b\u680b\u5b87\u200b\u575a\u6301\u200b\u81ea\u4fe1\u200b\uff0c\u200b\u521b\u65b0\u200b\uff0c\u200b\u6c89\u7740\u200b\u7684\u200b\u7cbe\u795e\u200b\uff0c\u200b\u4e0d\u65ad\u200b\u63d0\u51fa\u200b\u6539\u8fdb\u200b\u65b9\u6848\u200b\u5e76\u200b\u6293\u7d27\u200b\u843d\u5b9e\u200b\uff0c\u200b\u9047\u5230\u200b\u76f8\u5173\u200b\u95ee\u9898\u200b\u79ef\u6781\u200b\u8bf7\u6559\u200b\u8001\u5e08\u200b\uff0c\u200b\u63d0\u9ad8\u200b\u4e86\u200b\u56e2\u961f\u200b\u5f00\u53d1\u200b\u6548\u7387\u200b\u3002\n\n+ \u200b\u5c0f\u84dd\u200b\uff0cB\u200b\u516c\u53f8\u200b\n  + \u200b\u4e3b\u7ba1\u200bAgent\u200b\u667a\u80fd\u200b\u77e5\u8bc6\u5e93\u200b\u67e5\u8be2\u200b\u5f00\u53d1\u200b\u3001Agent\u200b\u5e95\u5c42\u200b\u6846\u67b6\u200b\u8bbe\u8ba1\u200b\u3001\u200b\u76f8\u5173\u200bAPI\u200b\u8c03\u6574\u200b\u548c\u200bUI\u200b\u8c03\u6574\u200b\u3002\n  + \u200b\u4ee3\u8868\u200b\u56e2\u961f\u200b\u5728\u200b\u89c4\u5b9a\u200b\u7684\u200b\u65f6\u95f4\u200b\u5185\u200b\u5448\u73b0\u200b\u4e86\u200b\u4ea7\u54c1\u200b\u7684\u200b\u7279\u70b9\u200b\u548c\u200b\u4f18\u52bf\u200b\uff0c\u200b\u5e76\u200b\u5b8c\u7f8e\u200b\u7684\u200b\u5c55\u793a\u200b\u4e86\u200b\u4ea7\u54c1\u200bdemo\u3002\n</code></pre></p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2","title":"2. \u200b\u51cf\u5c11\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u51b2\u7a81\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u5206\u95e8\u522b\u7c7b\u200b\u5b58\u653e\u6570\u636e","text":"<p>\u200b\u5c31\u200b\u50cf\u200b\u4eba\u7c7b\u200b\u5bfb\u627e\u200b\u76f8\u5173\u200b\u70b9\u200b\u4e00\u6837\u200b\uff0c\u200b\u5982\u679c\u200b\u5728\u200b\u591a\u200b\u4efd\u6587\u4ef6\u200b\u4e2d\u200b\u5b58\u5728\u200b\u76f8\u4f3c\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u6a21\u578b\u200b\u65e0\u6cd5\u200b\u51c6\u786e\u200b\u7684\u200b\u641c\u7d22\u200b\u5230\u200b\u76f8\u5173\u200b\u5185\u5bb9\u200b\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u9700\u8981\u200b\u51cf\u5c11\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u76f8\u4f3c\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u6216\u200b\u5c06\u200b\u5176\u5206\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u77e5\u8bc6\u5e93\u200b\u4e2d\u200b\u3002 \u200b\u4f8b\u5982\u200b\uff0c\u200b\u4ee5\u4e0b\u200b\u4e24\u4e2a\u200b\u53e5\u5b50\u200b\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u641c\u7d22\u200b\u5916\u7c4d\u200b\u6559\u5e08\u200b\uff0c\u200b\u5219\u200b\u5177\u6709\u200b\u6b67\u4e49\u200b\uff0c\u200b\u975e\u5e38\u5bb9\u6613\u200b\u641c\u7d22\u200b\u5230\u200b\u9519\u8bef\u200b\u7b54\u6848\u200b\u3002</p> <pre><code>\u200b\u6587\u4ef6\u200b\u4e00\u200b\uff1a\n\u200b\u5728\u200b\u5927\u200b\u6570\u636e\u200b\u4e13\u4e1a\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u62e5\u6709\u200b\u8d85\u8fc7\u200b1/3\u200b\u7684\u200b\u5916\u7c4d\u200b\u535a\u58eb\u200b\u548c\u200b\u6559\u5e08\u200b\u3002\n\n\u200b\u6587\u4ef6\u200b\u4e8c\u200b\uff1a\n\n\u200b\u672c\u200b\u4e13\u4e1a\u200b\u5177\u6709\u200b40%\u200b\u7684\u200b\u5916\u7c4d\u200b\u6559\u5e08\u200b\u6bd4\u4f8b\u200b\uff0c\n\u200b\u672c\u200b\u4e13\u4e1a\u200b\u6709\u200b\u535a\u58eb\u751f\u200b10\u200b\u4eba\u200b\uff0c\u200b\u7814\u7a76\u751f\u200b12\u200b\u4eba\u200b\u3002\n</code></pre>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#3","title":"3. \u200b\u51cf\u5c11\u200b\u5177\u6709\u200b\u6b67\u4e49\u200b\u7684\u200b\u53e5\u5b50","text":"<p>\u200b\u77e5\u8bc6\u5e93\u200b\u4e2d\u200b\u5e94\u8be5\u200b\u51cf\u5c11\u200b\u5177\u6709\u200b\u6b67\u4e49\u200b\u7684\u200b\u53e5\u5b50\u200b\u548c\u200b\u6bb5\u843d\u200b\uff0c\u200b\u6216\u8005\u200b\u6c49\u8bed\u200b\u7684\u200b\u9ad8\u7ea7\u200b\u7528\u6cd5\u200b\uff0c\u200b\u4f8b\u5982\u200b <pre><code>1. \u200b\u4ed6\u200b\u8bf4\u200b\u4ed6\u200b\u4f1a\u200b\u6740\u200b\u4e86\u200b\u90a3\u4e2a\u200b\u4eba\u200b\u3002\n2. \u200b\u4f60\u200b\u8bf4\u200b\u5565\u5b50\u200b\uff1f\n3. \u200b\u6211\u200b\u559c\u6b22\u200b\u4f60\u200b\u7684\u200b\u5934\u53d1\u200b\u3002\n4. \u200b\u5730\u677f\u200b\u771f\u7684\u200b\u6ed1\u200b\uff0c\u200b\u6211\u200b\u5dee\u70b9\u200b\u6ca1\u200b\u6454\u5012\u200b\u3002\n</code></pre> \u200b\u5728\u200b\u76f8\u4f3c\u200b\u5ea6\u200b\u6a21\u578b\u200b\u5bf9\u6bd4\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4ec5\u4ec5\u200b\u80fd\u200b\u641c\u7d22\u200b\u53e5\u5b50\u200b\u7684\u200b\u8868\u9762\u200b\u610f\u601d\u200b\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u4f7f\u7528\u200b\u6709\u200b\u6b67\u4e49\u200b\u7684\u200b\u53e5\u5b50\u200b\u548c\u200b\u6bb5\u843d\u200b\u53ef\u80fd\u200b\u5bfc\u81f4\u200b\u641c\u7d22\u200b\u9519\u8bef\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#4","title":"4. \u200b\u51cf\u5c11\u200b\u5355\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u5927\u5c0f\u200b\uff0c\u200b\u51cf\u5c11\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u7279\u6b8a\u7b26\u53f7","text":"<ul> <li>\u200b\u4e0a\u4f20\u200b\u77e5\u8bc6\u5e93\u200b\u7684\u200b\u5355\u4e2a\u200b\u6587\u4ef6\u200b\u4e0d\u200b\u5efa\u8bae\u200b\u8d85\u8fc7\u200b5MB\uff0c\u200b\u4ee5\u514d\u200b\u51fa\u73b0\u200b\u5411\u200b\u91cf\u5316\u200b\u4e2d\u65ad\u200b\u5361\u6b7b\u200b\u7b49\u200b\u60c5\u51b5\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u4e0a\u4f20\u200b\u5927\u200b\u6587\u4ef6\u200b\u4e0d\u8981\u200b\u4f7f\u7528\u200bfaiss\u200b\u6570\u636e\u5e93\u200b\u3002</li> <li>\u200b\u51cf\u5c11\u200b\u4e0a\u4f20\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u4e2d\u6587\u200b\u7b26\u53f7\u200b\uff0c\u200b\u7279\u6b8a\u7b26\u53f7\u200b\uff0c\u200b\u65e0\u200b\u610f\u4e49\u200b\u7a7a\u683c\u200b\u7b49\u200b\u3002</li> </ul>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#embedding","title":"\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5173\u952e\u8bcd\u200b\u8c03\u6574\u200bEmbedding\u200b\u6a21\u578b","text":"<p>1.\u200b\u9996\u5148\u200b\u51c6\u5907\u200b\u4e00\u4e2a\u200b\u5173\u952e\u5b57\u200b\u7684\u200b\u6587\u672c\u6587\u4ef6\u200b\uff0c\u200b\u6bcf\u200b\u4e00\u884c\u200b\u662f\u200b\u4e00\u4e2a\u200b\u5173\u952e\u5b57\u200b\u3002\u200b\u4f8b\u5982\u200b\uff1a <pre><code>\u200b\u6587\u4ef6\u200bkey_words.txt\uff1a\niphone13pro\n\u200b\u4e2d\u200b\u77f3\u6cb9\u200b\n</code></pre> 2. \u200b\u914d\u7f6e\u200bkb_config.py <pre><code>EMBEDDING_KEYWORD_FILE = \"embedding_keywords.txt\"\n</code></pre> 3. \u200b\u8fd0\u884c\u200b<code>embeddings/add_embedding_keywords.py</code> <pre><code>\u200b\u8f93\u5165\u200b\u7684\u200b\u6587\u672c\u200b\uff08\u200b\u8fd9\u91cc\u200b\u53ea\u662f\u200b\u4e00\u4e2a\u200b\u6ca1\u200b\u5206\u9694\u200b\u7684\u200b\u4e00\u4e32\u200b\u5b57\u7b26\u200b\uff09\uff1aiphone13pro\n\u200b\u751f\u6210\u200b\u7684\u200btoken id\u200b\u5e8f\u5217\u200b\uff1a[101, 21128, 102]\ntoken\u200b\u5230\u200btoken id\u200b\u7684\u200b\u6620\u5c04\u200b\uff1a\n[CLS]-&gt;101\niphone13pro-&gt;21128\n[SEP]-&gt;102\n\n\u200b\u8f93\u5165\u200b\u7684\u200b\u6587\u672c\u200b\uff1a\u200b\u4e2d\u200b\u77f3\u6cb9\u200b\n\u200b\u751f\u6210\u200b\u7684\u200btoken id\u200b\u5e8f\u5217\u200b\uff1a[101, 21129, 102]\ntoken\u200b\u5230\u200btoken id\u200b\u7684\u200b\u6620\u5c04\u200b\uff1a\n[CLS]-&gt;101\n\u200b\u4e2d\u200b\u77f3\u6cb9\u200b-&gt;21129\n[SEP]-&gt;102\n</code></pre> \u200b\u8fd9\u6837\u200b\uff0c\u200b\u4f60\u200b\u5c31\u200b\u83b7\u5f97\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u5e26\u6709\u200b\u5173\u952e\u8bcd\u200b\u8c03\u6574\u200b\u7684\u200bEmbedding\u200b\u6a21\u578b\u200b</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_4","title":"\u5b9e\u9645\u200b\u4f7f\u7528\u200b\u6548\u679c","text":"<p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u653e\u7f6e\u200b\u4e86\u200b\u4e00\u4e9b\u200b\u6210\u529f\u200b\u8c03\u7528\u200b\u7684\u200b\u6548\u679c\u56fe\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u5f00\u53d1\u8005\u200b\u8fdb\u884c\u200b\u67e5\u770b\u200b\u81ea\u5df1\u200b\u662f\u5426\u200b\u6210\u529f\u200b\u8fd0\u884c\u200b\u4e86\u200b\u6846\u67b6\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_5","title":"\u68c0\u67e5\u200b\u662f\u5426\u200b\u6210\u529f\u200b\u4e0a\u4f20\u200b/\u200b\u7ba1\u7406\u200b\u81ea\u5df1\u200b\u7684\u200b\u77e5\u8bc6\u5e93","text":"<p>\u200b\u5728\u200bWebUI\u200b\u754c\u9762\u200b\u4e0a\u4f20\u200b\u77e5\u8bc6\u5e93\u200b\uff0c\u200b\u5219\u200b\u5fc5\u987b\u200b\u4fdd\u8bc1\u200b\u77e5\u8bc6\u5e93\u200b\u8fdb\u884c\u200b\u5411\u200b\u91cf\u5316\u200b\uff0c\u200b\u6210\u529f\u200b\u4e4b\u540e\u200b\uff0c\u200b\u6587\u4ef6\u200b\u4f1a\u200b\u88ab\u200b\u5207\u5206\u200b\u5e76\u200b\u5728\u200b\u5411\u91cf\u200b\u4f4d\u7f6e\u200b\u6253\u94a9\u200b\u3002 \u200b\u4e0b\u56fe\u200b\u5c55\u793a\u200b\u4e86\u200b\u6210\u529f\u200b\u4e0a\u4f20\u200b\u77e5\u8bc6\u5e93\u200b\u7684\u200b\u753b\u9762\u200b</p> <p></p> <p>\u200b\u8bf7\u200b\u786e\u4fdd\u200b\u6240\u6709\u200b\u77e5\u8bc6\u5e93\u200b\u90fd\u200b\u5df2\u7ecf\u200b\u8fdb\u884c\u200b\u4e86\u200b\u5411\u200b\u91cf\u5316\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#llm","title":"\u68c0\u67e5\u200b\u662f\u5426\u200b\u6210\u529f\u200b\u5f00\u542f\u200bLLM\u200b\u5bf9\u8bdd","text":"<p>\u200b\u82e5\u200b\u6253\u5f00\u200bwebui\u200b\u540e\u200b\uff0c\u200b\u5728\u200b\u8be5\u200b\u6a21\u5f0f\u200b\u4e0b\u80fd\u200b\u6210\u529f\u200b\u8ddf\u200b\u5927\u200b\u6a21\u578b\u200b\u5bf9\u8bdd\u200b\u5373\u200b\u6210\u529f\u200b\u8c03\u7528\u200b\u3002</p> <p>\u200b\u4e0b\u56fe\u200b\u4e3a\u200b\u6210\u529f\u200b\u8c03\u7528\u200bLLM\u200b\u7684\u200b\u6548\u679c\u56fe\u200b:</p> <p></p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_6","title":"\u68c0\u67e5\u200b\u662f\u5426\u200b\u6210\u529f\u200b\u8c03\u7528\u200b\u77e5\u8bc6\u5e93\u200b/\u200b\u641c\u7d22","text":"<p>\u200b\u82e5\u200b\u6210\u529f\u200b\u8c03\u7528\u200b\u77e5\u8bc6\u5e93\u200b\uff0c\u200b\u5219\u200b\u4f60\u200b\u5e94\u8be5\u200b\u80fd\u200b\u770b\u5230\u200b\uff0c\u200b\u5728\u200b\u5927\u200b\u6a21\u578b\u200b\u56de\u7b54\u200b\u7684\u200b\u4e0b\u65b9\u200b\u6709\u200b\u4e00\u4e2a\u200b<code>\u200b\u77e5\u8bc6\u5e93\u200b\u5339\u914d\u200b\u7ed3\u679c\u200b</code>\u200b\u7684\u200b\u5c55\u5f00\u200b\u6846\u200b\uff0c\u200b\u5e76\u4e14\u200b\u5185\u90e8\u200b\u663e\u793a\u200b\u4e86\u200b\u76f8\u5173\u200b\u7684\u200b\u5339\u914d\u200b\u7ed3\u679c\u200b\u3002 \u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u641c\u7d22\u200b\u5230\u200b\u76f8\u5173\u200b\u5185\u5bb9\u200b\uff0c\u200b\u5219\u200b\u4f1a\u200b\u63d0\u793a\u200b<code>\u200b\u6839\u636e\u200b\u5df2\u77e5\u200b\u4fe1\u606f\u200b\u65e0\u6cd5\u56de\u7b54\u200b\u95ee\u9898\u200b</code>,\u200b\u5e76\u4e14\u200b\u4e0b\u62c9\u6846\u200b\u4e2d\u200b\u6ca1\u6709\u200b\u4efb\u4f55\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u4e0b\u56fe\u200b\u4e3a\u200b\u6210\u529f\u200b\u8c03\u7528\u200b\u77e5\u8bc6\u5e93\u200b\u6548\u679c\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u5728\u200b\u8fd9\u4e2a\u200b\u6848\u4f8b\u200b\u4e2d\u200b\uff0c\u200b\u7b2c\u4e00\u6b21\u200b\u7528\u6237\u200b\u7684\u200b\u63d0\u95ee\u200b\u65e0\u6cd5\u200b\u5728\u200b\u77e5\u8bc6\u5e93\u200b\u4e2d\u200b\u5bfb\u627e\u200b\u5230\u200b\u5408\u9002\u200b\u7684\u200b\u7b54\u6848\u200b\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5927\u200b\u6a21\u578b\u200b\u56de\u7b54\u200b\u4e86\u200b<code>\u200b\u6839\u636e\u200b\u5df2\u77e5\u200b\u4fe1\u606f\u200b\u65e0\u6cd5\u56de\u7b54\u200b\u95ee\u9898\u200b</code>\u3002</p> <p>\u200b\u7b2c\u4e8c\u6b21\u200b\u7528\u6237\u200b\u7684\u200b\u63d0\u95ee\u200b\u80fd\u200b\u5728\u200b\u77e5\u8bc6\u5e93\u200b\u4e2d\u200b\u5bfb\u627e\u200b\u5230\u200b\u5408\u9002\u200b\u7684\u200b\u7b54\u6848\u200b\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5927\u200b\u6a21\u578b\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u6b63\u786e\u200b\u7684\u200b\u56de\u7b54\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b: \u200b\u77e5\u8bc6\u5e93\u200b\u7684\u200b\u641c\u7d22\u200b\u60c5\u51b5\u200b\u53d6\u51b3\u4e8e\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b\u7684\u200b\u51c6\u5ea6\u200b\uff0c\u200b\u5206\u8bcd\u5668\u200b\u7684\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u77e5\u8bc6\u5e93\u200b\u7684\u200b\u6392\u7248\u200b\u548c\u200b\u5927\u200b\u6a21\u578b\u200b\u7684\u200b\u6570\u91cf\u200b\uff0c\u200b\u63d0\u793a\u200b\u8bcd\u200b\u8bbe\u5b9a\u200b\u7b49\u200b\u591a\u4e2a\u200b\u56e0\u7d20\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u9700\u8981\u200b\u5f00\u53d1\u8005\u200b\u8fdb\u884c\u200b\u6df1\u5ea6\u200b\u7684\u200b\u4f18\u5316\u200b\u548c\u200b\u8c03\u8bd5\u200b\u3002</p>"},{"location":"4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#agent","title":"\u68c0\u67e5\u200b\u662f\u5426\u200b\u6210\u529f\u200b\u8c03\u7528\u200bAgent\u200b\u5de5\u5177","text":"<p>\u200b\u82e5\u200b\u6210\u529f\u200b\u8c03\u7528\u200bAgent\u200b\u5de5\u5177\u200b\uff0c\u200b\u5219\u200b\u4f60\u200b\u5e94\u8be5\u200b\u770b\u5230\u200b\u5927\u200b\u6a21\u578b\u200b\u5b8c\u6574\u200b\u7684\u200b\u601d\u7ef4\u8fc7\u7a0b\u200b\uff0c\u200b\u8fd9\u4f1a\u200b\u5728\u200b<code>\u200b\u601d\u8003\u200b\u8fc7\u7a0b\u200b</code>\u200b\u4e0b\u62c9\u6846\u200b\u4e2d\u200b\u663e\u793a\u200b\u51fa\u6765\u200b\u3002\u200b\u5982\u679c\u200b\u6210\u529f\u200b\u8c03\u7528\u200bAgent\u200b\u5de5\u5177\u200b\uff0c\u200b\u5219\u200b\u4f60\u200b\u5e94\u8be5\u200b\u770b\u5230\u200bMarkdown\u200b\u5f15\u7528\u200b\u6548\u679c\u200b\u7684\u200b\u5de5\u5177\u200b\u4f7f\u7528\u200b\u60c5\u51b5\u200b\u3002 \u200b\u5728\u200bAgent\u200b\u5bf9\u8bdd\u200b\u6a21\u5f0f\u200b\u4e2d\u200b\uff0c<code>\u200b\u601d\u8003\u200b\u8fc7\u7a0b\u200b</code>\u200b\u4e2d\u200b\u663e\u793a\u200b\u7684\u200b\u662f\u200b\u5927\u200b\u6a21\u578b\u200b\u7684\u200b\u601d\u8003\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u800c\u200b\u4e0b\u62c9\u6846\u200b\u4e4b\u524d\u200b\u7684\u200b\u5185\u5bb9\u200b\u4e3a\u200b\u5927\u200b\u6a21\u578b\u200b\u7684\u200b<code>Final Answer</code>\uff0c\u200b\u7f3a\u4e4f\u200b\u4e2d\u95f4\u200b\u7684\u200b\u8fd0\u7b97\u200b\u8fc7\u7a0b\u200b\u3002</p> <p>\u200b\u4e0b\u56fe\u200b\u5c55\u73b0\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u6210\u529f\u200b\u8c03\u7528\u200bAgent\u200b\u5de5\u5177\u200b\u7684\u200b\u6548\u679c\u56fe\u200b:</p> <p></p> <p>\u200b\u672c\u200b\u6846\u67b6\u200b\u652f\u6301\u200b\u6a21\u578b\u200b\u8fde\u7eed\u200b\u6389\u200b\u7528\u200b\u591a\u4e2a\u200bAgent\u200b\u5de5\u5177\u200b\uff0c\u200b\u4e0b\u56fe\u200b\u5c55\u793a\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u4e00\u4e2a\u200b\u63d0\u95ee\u200b\u4e2d\u200b\u5927\u200b\u6a21\u578b\u200b\u8fde\u7eed\u200b\u8c03\u7528\u200b\u591a\u4e2a\u200bAgent\u200b\u5de5\u5177\u200b\u7684\u200b\u6548\u679c\u56fe\u200b:</p> <p></p> <p>\u200b\u5728\u200b\u8fd9\u4e2a\u200b\u6848\u4f8b\u200b\u4e2d\u200b\uff0c<code>3900</code>\u200b\u662f\u200b\u5927\u200b\u6a21\u578b\u200b\u7684\u200b\u6700\u7ec8\u200b\u7b54\u6848\u200b\uff0c\u200b\u5176\u4f59\u200b\u90fd\u200b\u662f\u200b\u601d\u8003\u200b\u8fc7\u7a0b\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/","title":"5 \u200b\u5e38\u89c1\u95ee\u9898","text":"<p>\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u4e00\u4e9b\u200b\u5e38\u89c1\u200b\u7684\u200b\u95ee\u9898\u200b\u548c\u200b\u56de\u7b54\u200b</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q","title":"Q: \u200b\u6211\u8981\u200b\u63d0\u51fa\u200b\u95ee\u9898\u200b\uff0c\u200b\u600e\u4e48\u529e","text":"<p>A: \u200b\u9996\u5148\u200b\uff0c\u200b\u4f60\u200b\u8981\u200b\u89c2\u5bdf\u200b\u4e00\u4e0b\u200b\u4f60\u200b\u7684\u200b\u95ee\u9898\u200b\u662f\u5426\u200b\u6709\u6ca1\u6709\u200b\u88ab\u200b\u89e3\u51b3\u200b\uff0c\u200b\u5efa\u8bae\u200b\u7ffb\u770b\u200b\u4ee5\u5f80\u200b\u7684\u200bIssue\u200b\u548c\u200bDiscussion\uff0c\u200b\u5982\u679c\u200b\u6709\u200b\uff0c\u200b\u5148\u200b\u6309\u7167\u200b\u4ed6\u4eec\u200b\u7684\u200b\u65b9\u6cd5\u200b\u6765\u200b\u505a\u200b\u3002 \u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\uff0c\u200b\u6309\u7167\u200b\u4ee5\u4e0b\u200b\u6b65\u9aa4\u200b 1. \u200b\u8fd9\u662f\u200b\u4e00\u4e2a\u200bbug\u200b\u8fd8\u662f\u200b\u4e00\u4e2a\u200b\u8ba8\u8bba\u200b\u95ee\u9898\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200b\u8ba8\u8bba\u200b\u95ee\u9898\u200b\uff0c\u200b\u653e\u5728\u200bdisscusion\uff0c\u200b\u5982\u679c\u200b\u662f\u200bbug\u200b\u548c\u200bfeature\uff0c\u200b\u653e\u5728\u200bissue\u3002 2. \u200b\u5982\u679c\u200b\u8981\u200b\u63d0\u51fa\u200bfeature\uff0c\u200b\u63d0\u4ea4\u200b\u4e00\u4efd\u200b\u5bf9\u5e94\u200b\u7684\u200bPR\u200b\u4f1a\u200b\u8ba9\u200b\u5f00\u53d1\u8005\u200b\u66f4\u200b\u91cd\u89c6\u200b\u4f60\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u5426\u5219\u200b\u4f60\u200b\u7684\u200b\u95ee\u9898\u200b\u5f88\u200b\u6709\u200b\u53ef\u80fd\u200b\u88ab\u200b\u76f4\u63a5\u200b\u5173\u95ed\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-valueerror-found-modules-on-cpudisk-using-exllama-backend-requires-all-the-modules-to-be-on-gpu-you-can-deactivate-exllama-backend-by-setting-disable_exllamatrue-in-the-quantization-config-object","title":"Q: ValueError: Found modules on cpu/disk. Using Exllama backend requires all the modules to be on GPU. You can deactivate exllama backend by setting disable_exllama=True in the quantization config object.","text":"<p>A: \u200b\u8fd9\u662f\u200bFschat\u200b\u4f9d\u8d56\u200b\u6e90\u7801\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u8bf7\u200b\u67e5\u770b\u200b\u4ee5\u4e0b\u200b\u89e3\u51b3\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u901a\u8fc7\u200b\u4fee\u6539\u200b'Fschat'\u200b\u5e93\u4e2d\u200b\u7684\u200b\u5bf9\u5e94\u200b\u5185\u5bb9\u200b\u3002</p> <p>https://github.com/lm-sys/FastChat/issues/2459</p> <p>https://stackoverflow.com/questions/76983305/fine-tuning-thebloke-llama-2-13b-chat-gptq-model-with-hugging-face-transformers</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-attributeerror-chatglmtokenizer-object-has-no-attribute-tokenizer","title":"Q: AttributeError: 'ChatGLMTokenizer' object has no attribute 'tokenizer'","text":"<p>A: \u200b\u67e5\u770b\u200b\u4ee5\u4e0b\u200bIssue</p> <p>https://github.com/chatchat-space/Langchain-Chatchat/issues/1835</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#qlinuxpdfimporterror-pdf-libglso1-cannot-open-shared-object-file-no-such-file-or-directory","title":"Q\uff1alinux\u200b\u4e0b\u5411\u200b\u91cf\u5316\u200bPDF\u200b\u6587\u4ef6\u200b\u65f6\u200b\u51fa\u9519\u200b\uff1a<code>ImportError: \u200b\u4ece\u6587\u4ef6\u200b *.pdf \u200b\u52a0\u8f7d\u200b\u6587\u6863\u200b\u65f6\u200b\u51fa\u9519\u200b\uff1alibGL.so.1: cannot open shared object file: No such file or directory</code>","text":"<p>A\uff1a \u200b\u8fd9\u662f\u200b\u7cfb\u7edf\u200b\u7f3a\u5c11\u200b\u5fc5\u8981\u200b\u7684\u200b\u52a8\u6001\u200b\u5e93\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u624b\u52a8\u200b\u5b89\u88c5\u200b\uff1a<code>libgl1-mesa-glx</code> \u200b\u548c\u200b <code>libglib2.0-0</code></p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-int4","title":"Q: \u200b\u5404\u79cd\u200bInt4\u200b\u6a21\u578b\u200b\u65e0\u6cd5\u200b\u8f7d\u5165","text":"<p>A. \u200b\u7531\u4e8e\u200b\u5404\u79cd\u200bInt4\u200b\u6a21\u578b\u200b\u4e0e\u200bFp16\u200b\u6a21\u578b\u200b\u5e76\u200b\u4e0d\u200b\u76f8\u4f3c\u200b\uff0c\u200b\u4e14\u200b\u91cf\u5316\u200b\u6280\u672f\u200b\u53ef\u80fd\u200b\u6709\u6240\u4e0d\u540c\u200b\uff0c\u200b\u65e0\u6cd5\u200b\u8f7d\u5165\u200b\u53ef\u80fd\u200b\u662f\u56e0\u4e3a\u200bfschat\u200b\u4e0d\u200b\u652f\u6301\u200b\u6216\u8005\u200b\u7f3a\u5c11\u200b\u5bf9\u5e94\u200b\u7684\u200b\u4f9d\u8d56\u200b\uff0c\u200b\u9700\u8981\u200b\u67e5\u770b\u200b\u5bf9\u5e94\u200b\u4ed3\u5e93\u200b\u7684\u200bissue\u200b\u83b7\u5f97\u200b\u66f4\u200b\u591a\u200b\u4fe1\u606f\u200b\u3002\u200b\u5f00\u53d1\u200b\u7ec4\u200b\u6ca1\u6709\u200b\u9488\u5bf9\u200bInt4\u200b\u6a21\u578b\u200b\u8fdb\u884c\u200b\u4f18\u5316\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q_1","title":"Q: \u200b\u672c\u200b\u9879\u76ee\u200b\u652f\u6301\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u683c\u5f0f\u200b\uff1f","text":"<p>A: \u200b\u76ee\u524d\u200b\u5df2\u200b\u6d4b\u8bd5\u200b\u652f\u6301\u200b txt\u3001docx\u3001md\u3001pdf\u3001csv\u3001html\u3001json \u200b\u7b49\u200b\u683c\u5f0f\u6587\u4ef6\u200b</p> <p>\u200b\u66f4\u200b\u591a\u200b\u6587\u4ef6\u683c\u5f0f\u200b\u8bf7\u200b\u53c2\u8003\u200b langchain \u200b\u6587\u6863\u200b\u3002\u200b\u76ee\u524d\u200b\u5df2\u77e5\u200b\u6587\u6863\u200b\u4e2d\u82e5\u200b\u542b\u6709\u200b\u7279\u6b8a\u5b57\u7b26\u200b\uff0c\u200b\u53ef\u80fd\u200b\u5b58\u5728\u200b\u6587\u4ef6\u200b\u65e0\u6cd5\u200b\u52a0\u8f7d\u200b\u7684\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-python-nltk-resource-punkt-not-found","title":"Q: \u200b\u4f7f\u7528\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b Python \u200b\u5305\u200b <code>nltk</code>\u200b\u53d1\u751f\u200b\u4e86\u200b <code>Resource punkt not found.</code>\u200b\u62a5\u9519\u200b\uff0c\u200b\u8be5\u200b\u5982\u4f55\u200b\u89e3\u51b3\u200b\uff1f","text":"<p>A: \u200b\u65b9\u6cd5\u200b\u4e00\u200b\uff1ahttps://github.com/nltk/nltk_data/raw/gh-pages/packages/tokenizers/punkt.zip \u200b\u4e2d\u200b\u7684\u200b <code>packages/tokenizers</code> \u200b\u89e3\u538b\u200b\uff0c\u200b\u653e\u5230\u200b  <code>nltk_data/tokenizers</code> \u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u4e0b\u200b\u3002</p> <p><code>nltk_data</code> \u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b <code>nltk.data.path</code> \u200b\u67e5\u8be2\u200b\u3002</p> <p>\u200b\u65b9\u6cd5\u200b\u4e8c\u200b\uff1a\u200b\u6267\u884c\u200bpython\u200b\u4ee3\u7801\u200b</p> <pre><code>import nltk\nnltk.download()\n</code></pre>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-python-nltk-resource-averaged_perceptron_tagger-not-found","title":"Q: \u200b\u4f7f\u7528\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b Python \u200b\u5305\u200b <code>nltk</code>\u200b\u53d1\u751f\u200b\u4e86\u200b <code>Resource averaged_perceptron_tagger not found.</code>\u200b\u62a5\u9519\u200b\uff0c\u200b\u8be5\u200b\u5982\u4f55\u200b\u89e3\u51b3\u200b\uff1f","text":"<p>A: </p> <p>\u200b\u65b9\u6cd5\u200b\u4e00\u200b\uff1a\u200b\u5c06\u200b https://github.com/nltk/nltk_data/blob/gh-pages/packages/taggers/averaged_perceptron_tagger.zip \u200b\u4e0b\u8f7d\u200b\uff0c\u200b\u89e3\u538b\u200b\u653e\u5230\u200b <code>nltk_data/taggers</code> \u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u4e0b\u200b\u3002</p> <p><code>nltk_data</code> \u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b <code>nltk.data.path</code> \u200b\u67e5\u8be2\u200b\u3002</p> <p>\u200b\u65b9\u6cd5\u200b\u4e8c\u200b\uff1a\u200b\u6267\u884c\u200bpython\u200b\u4ee3\u7801\u200b</p> <pre><code>import nltk\nnltk.download()\n</code></pre>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-colab","title":"Q: \u200b\u672c\u200b\u9879\u76ee\u200b\u53ef\u5426\u200b\u5728\u200b colab \u200b\u4e2d\u200b\u8fd0\u884c\u200b\uff1f","text":"<p>A4: \u200b\u53ef\u4ee5\u200b\u5c1d\u8bd5\u200b\u4f7f\u7528\u200b chatglm-6b-int4 \u200b\u6a21\u578b\u200b\u5728\u200b colab \u200b\u4e2d\u200b\u8fd0\u884c\u200b\uff0c\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u5982\u9700\u200b\u5728\u200b colab \u200b\u4e2d\u200b\u8fd0\u884c\u200b Web UI\uff0c\u200b\u9700\u200b\u5c06\u200b <code>webui.py</code>\u200b\u4e2d\u200b <code>demo.queue(concurrency_count=3).launch( server_name='0.0.0.0', share=False, inbrowser=False)</code>\u200b\u4e2d\u200b\u53c2\u6570\u200b <code>share</code>\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b <code>True</code>\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-anaconda-pip","title":"Q: \u200b\u5728\u200b Anaconda \u200b\u4e2d\u200b\u4f7f\u7528\u200b pip \u200b\u5b89\u88c5\u5305\u200b\u65e0\u6548\u200b\u5982\u4f55\u200b\u89e3\u51b3\u200b\uff1f","text":"<p>A5: \u200b\u6b64\u200b\u95ee\u9898\u200b\u662f\u200b\u7cfb\u7edf\u200b\u73af\u5883\u200b\u95ee\u9898\u200b\uff0c\u200b\u8be6\u7ec6\u200b\u89c1\u200b  \u200b\u5728\u200bAnaconda\u200b\u4e2d\u200b\u4f7f\u7528\u200bpip\u200b\u5b89\u88c5\u5305\u200b\u65e0\u6548\u200b\u95ee\u9898\u200b</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q_2","title":"Q: \u200b\u672c\u200b\u9879\u76ee\u200b\u4e2d\u6240\u200b\u9700\u200b\u6a21\u578b\u200b\u5982\u4f55\u200b\u4e0b\u8f7d\u200b\u81f3\u200b\u672c\u5730\u200b\uff1f","text":"<p>A6: \u200b\u672c\u200b\u9879\u76ee\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u7684\u200b\u6a21\u578b\u200b\u5747\u200b\u4e3a\u200b <code>huggingface.com</code> \u200b\u4e2d\u200b\u53ef\u200b\u4e0b\u8f7d\u200b\u7684\u200b\u5f00\u6e90\u200b\u6a21\u578b\u200b\uff0c\u200b\u4ee5\u200b\u9ed8\u8ba4\u200b\u9009\u62e9\u200b\u7684\u200b <code>chatglm-6b</code>\u200b\u548c\u200b <code>text2vec-large-chinese</code>\u200b\u6a21\u578b\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u4e0b\u8f7d\u200b\u6a21\u578b\u200b\u53ef\u200b\u6267\u884c\u200b\u5982\u4e0b\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code># \u200b\u5b89\u88c5\u200b git lfs\n$ git lfs install\n\n# \u200b\u4e0b\u8f7d\u200b LLM \u200b\u6a21\u578b\u200b\n$ git clone https://huggingface.co/THUDM/chatglm-6b /your_path/chatglm-6b\n\n# \u200b\u4e0b\u8f7d\u200b Embedding \u200b\u6a21\u578b\u200b\n$ git clone https://huggingface.co/GanymedeNil/text2vec-large-chinese /your_path/text2vec\n\n# \u200b\u6a21\u578b\u200b\u9700\u8981\u200b\u66f4\u65b0\u200b\u65f6\u200b\uff0c\u200b\u53ef\u200b\u6253\u5f00\u200b\u6a21\u578b\u200b\u6240\u5728\u200b\u6587\u4ef6\u5939\u200b\u540e\u62c9\u53d6\u200b\u6700\u65b0\u200b\u6a21\u578b\u200b\u6587\u4ef6\u200b/\u200b\u4ee3\u7801\u200b\n$ git pull\n</code></pre>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-huggingfacecom","title":"Q: <code>huggingface.com</code>\u200b\u4e2d\u200b\u6a21\u578b\u200b\u4e0b\u8f7d\u901f\u5ea6\u200b\u8f83\u6162\u200b\u600e\u4e48\u529e\u200b\uff1f","text":"<p>A: \u200b\u53ef\u200b\u4f7f\u7528\u200b\u672c\u200b\u9879\u76ee\u200b\u7528\u5230\u200b\u7684\u200b\u6a21\u578b\u200b\u6743\u91cd\u200b\u6587\u4ef6\u200b\u767e\u5ea6\u7f51\u200b\u76d8\u200b\u5730\u5740\u200b\uff1a</p> <ul> <li>ernie-3.0-base-zh.zip \u200b\u94fe\u63a5\u200b: https://pan.baidu.com/s/1CIvKnD3qzE-orFouA8qvNQ?pwd=4wih</li> <li>ernie-3.0-nano-zh.zip \u200b\u94fe\u63a5\u200b: https://pan.baidu.com/s/1Fh8fgzVdavf5P1omAJJ-Zw?pwd=q6s5</li> <li>text2vec-large-chinese.zip \u200b\u94fe\u63a5\u200b: https://pan.baidu.com/s/1sMyPzBIXdEzHygftEoyBuA?pwd=4xs7</li> <li>chatglm-6b-int4-qe.zip \u200b\u94fe\u63a5\u200b: https://pan.baidu.com/s/1DDKMOMHtNZccOOBGWIOYww?pwd=22ji</li> <li>chatglm-6b-int4.zip \u200b\u94fe\u63a5\u200b: https://pan.baidu.com/s/1pvZ6pMzovjhkA6uPcRLuJA?pwd=3gjd</li> <li>chatglm-6b.zip \u200b\u94fe\u63a5\u200b: https://pan.baidu.com/s/1B-MpsVVs1GHhteVBetaquw?pwd=djay</li> </ul>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q_3","title":"Q: \u200b\u8001\u200b\u7248\u672c\u200b\u548c\u200b\u65b0\u200b\u7248\u672c\u200b\u65e0\u6cd5\u200b\u517c\u5bb9\u200b\u600e\u4e48\u529e\u200b\uff1f","text":"<p>A: \u200b\u4fdd\u5b58\u200b\u8001\u200b\u7248\u672c\u200b\u7684\u200b\u914d\u7f6e\u6587\u4ef6\u200b\uff0c\u200b\u5220\u9664\u200b\u8001\u200b\u7248\u672c\u200b\u4ee3\u7801\u200b\u5e76\u200b\u4e0b\u8f7d\u200b\u65b0\u200b\u7248\u672c\u200b\u4ee3\u7801\u200b\u540e\u200b\uff0c\u200b\u6839\u636e\u200b\u65b0\u200b\u7248\u672c\u200b\u7684\u200b\u914d\u7f6e\u200b\u6587\u4ef6\u683c\u5f0f\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\u3002</p> <p>\u200b\u5728\u200b <code>0.2.6</code>\u200b\u540e\u200b\uff0c\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\u548c\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u53d1\u751f\u200b\u91cd\u5927\u200b\u53d8\u5316\u200b\uff0c\u200b\u5efa\u8bae\u200b\u91cd\u65b0\u914d\u7f6e\u200b\u73af\u5883\u200b\u548c\u200b\u914d\u7f6e\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u91cd\u5efa\u200b\u77e5\u8bc6\u5e93\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-outofmemoryerror-cuda-out-of-memory","title":"Q: \u200b\u663e\u5361\u200b\u5185\u5b58\u200b\u7206\u200b\u4e86\u200b\uff0c\u200b\u63d0\u793a\u200b \"OutOfMemoryError: CUDA out of memory\"","text":"<p>A: <code>VECTOR_SEARCH_TOP_K</code> \u200b\u548c\u200b <code>HISTORY_LEN</code> \u200b\u7684\u200b\u503c\u200b\u8c03\u4f4e\u200b\uff0c\u200b\u6bd4\u5982\u200b <code>VECTOR_SEARCH_TOP_K = 3</code> \u200b\u548c\u200b <code>LLM_HISTORY_LEN = 2</code>\uff0c\u200b\u8fd9\u6837\u200b\u7531\u200b <code>query</code> \u200b\u548c\u200b <code>context</code> \u200b\u62fc\u63a5\u200b\u5f97\u5230\u200b\u7684\u200b <code>prompt</code> \u200b\u4f1a\u200b\u53d8\u77ed\u200b\uff0c\u200b\u4f1a\u200b\u51cf\u5c11\u200b\u5185\u5b58\u200b\u7684\u200b\u5360\u7528\u200b\u3002\u200b\u6216\u8005\u200b\u4f7f\u7528\u200b\u91cf\u5316\u200b\u6a21\u578b\u200b\u51cf\u5c11\u200b\u663e\u5b58\u200b\u5360\u7528\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-pip-install-r-requirementstxt-python-langchain","title":"Q: \u200b\u6267\u884c\u200b <code>pip install -r requirements.txt</code> \u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u9047\u5230\u200b python \u200b\u5305\u200b\uff0c\u200b\u5982\u200b langchain \u200b\u627e\u200b\u4e0d\u5230\u200b\u5bf9\u5e94\u200b\u7248\u672c\u200b\u7684\u200b\u95ee\u9898","text":"<p>A: \u200b\u66f4\u6362\u200b pypi \u200b\u6e90\u540e\u200b\u91cd\u65b0\u5b89\u88c5\u200b\uff0c\u200b\u5982\u200b\u963f\u91cc\u200b\u6e90\u200b\u3001\u200b\u6e05\u534e\u200b\u6e90\u200b\u7b49\u200b\uff0c\u200b\u7f51\u7edc\u200b\u6761\u4ef6\u200b\u5141\u8bb8\u200b\u65f6\u200b\u5efa\u8bae\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b pypi.org \u200b\u6e90\u200b\uff0c\u200b\u5177\u4f53\u200b\u64cd\u4f5c\u547d\u4ee4\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code># \u200b\u4f7f\u7528\u200b pypi \u200b\u6e90\u200b\n$ pip install -r requirements.txt -i https://pypi.python.org/simple\n</code></pre> <p>\u200b\u6216\u200b</p> <pre><code># \u200b\u4f7f\u7528\u200b\u963f\u91cc\u200b\u6e90\u200b\n$ pip install -r requirements.txt -i http://mirrors.aliyun.com/pypi/simple/\n</code></pre> <p>\u200b\u6216\u200b</p> <pre><code># \u200b\u4f7f\u7528\u200b\u6e05\u534e\u200b\u6e90\u200b\n$ pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/\n</code></pre>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-apipy-upload_file-partially-initialized-module-charset_normalizer-has-no-attribute-md__mypyc-most-likely-due-to-a-circular-import","title":"Q: \u200b\u542f\u52a8\u200b api.py \u200b\u65f6\u200b upload_file \u200b\u63a5\u53e3\u200b\u629b\u51fa\u200b <code>partially initialized module 'charset_normalizer' has no attribute 'md__mypyc' (most likely due to a circular import)</code>","text":"<p>A11: \u200b\u8fd9\u662f\u200b\u7531\u4e8e\u200b charset_normalizer \u200b\u6a21\u5757\u200b\u7248\u672c\u200b\u8fc7\u9ad8\u200b\u5bfc\u81f4\u200b\u7684\u200b\uff0c\u200b\u9700\u8981\u200b\u964d\u4f4e\u200b\u4f4e\u200b charset_normalizer \u200b\u7684\u200b\u7248\u672c\u200b,\u200b\u6d4b\u8bd5\u200b\u5728\u200b charset_normalizer==2.1.0 \u200b\u4e0a\u200b\u53ef\u7528\u200b\u3002</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-api-bing_search_chat-failed-to-establish-a-new-connection-errno-110-connection-timed-out","title":"Q: \u200b\u8c03\u7528\u200bapi\u200b\u4e2d\u200b\u7684\u200b <code>bing_search_chat</code> \u200b\u63a5\u53e3\u200b\u65f6\u200b\uff0c\u200b\u62a5\u51fa\u200b <code>Failed to establish a new connection: [Errno 110] Connection timed out</code>","text":"<p>A12: \u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\u670d\u52a1\u5668\u200b\u52a0\u200b\u4e86\u200b\u9632\u706b\u5899\u200b\uff0c\u200b\u9700\u8981\u200b\u8054\u7cfb\u200b\u7ba1\u7406\u5458\u200b\u52a0\u200b\u767d\u540d\u5355\u200b\uff0c\u200b\u5982\u679c\u200b\u516c\u53f8\u200b\u7684\u200b\u670d\u52a1\u5668\u200b\u7684\u8bdd\u200b\uff0c\u200b\u5c31\u522b\u200b\u60f3\u200b\u4e86\u200bGG--!</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-chatglm-6b-int8-chatglm-6b-int4-runtimeerror-only-tensors-of-floating-point-andcomplex-dtype-can-require-gradients","title":"Q: \u200b\u52a0\u8f7d\u200b chatglm-6b-int8 \u200b\u6216\u200b chatglm-6b-int4 \u200b\u629b\u51fa\u200b <code>RuntimeError: Only Tensors of floating point andcomplex dtype can require gradients</code>","text":"<p>A13: \u200b\u7591\u4e3a\u200b chatglm \u200b\u7684\u200b quantization \u200b\u7684\u200b\u95ee\u9898\u200b\u6216\u200b torch \u200b\u7248\u672c\u200b\u5dee\u5f02\u200b\u95ee\u9898\u200b\uff0c\u200b\u9488\u5bf9\u200b\u5df2\u7ecf\u200b\u53d8\u4e3a\u200b Parameter \u200b\u7684\u200b torch.zeros \u200b\u77e9\u9635\u200b\u4e5f\u200b\u6267\u884c\u200b Parameter \u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4ece\u800c\u200b\u629b\u51fa\u200b <code>RuntimeError: Only Tensors of floating point andcomplex dtype can require gradients</code>\u3002\u200b\u89e3\u51b3\u529e\u6cd5\u200b\u662f\u200b\u5728\u200b chatglm \u200b\u9879\u76ee\u200b\u7684\u200b\u539f\u59cb\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b quantization.py \u200b\u6587\u4ef6\u200b 374 \u200b\u884c\u200b\u6539\u4e3a\u200b\uff1a</p> <pre><code>    try:\n        self.weight =Parameter(self.weight.to(kwargs[\"device\"]), requires_grad=False)\n    except Exception as e:\n        pass\n</code></pre> <pre><code>\u200b\u5982\u679c\u200b\u4e0a\u8ff0\u200b\u65b9\u5f0f\u200b\u4e0d\u8d77\u4f5c\u7528\u200b\uff0c\u200b\u5219\u200b\u5728\u200b.cache/hugggingface/modules/\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u9488\u5bf9\u200bchatglm\u200b\u9879\u76ee\u200b\u7684\u200b\u539f\u59cb\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200bquantization.py\u200b\u6587\u4ef6\u200b\u6267\u884c\u200b\u4e0a\u8ff0\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u82e5\u8f6f\u200b\u94fe\u63a5\u200b\u4e0d\u6b62\u200b\u4e00\u4e2a\u200b\uff0c\u200b\u6309\u7167\u200b\u9519\u8bef\u200b\u63d0\u793a\u200b\u9009\u62e9\u200b\u6b63\u786e\u200b\u7684\u200b\u8def\u5f84\u200b\u3002\n</code></pre> <p>\u200b\u6ce8\u200b\uff1a\u200b\u867d\u7136\u200b\u6a21\u578b\u200b\u53ef\u4ee5\u200b\u987a\u5229\u200b\u52a0\u8f7d\u200b\u4f46\u200b\u5728\u200bcpu\u200b\u4e0a\u200b\u4ecd\u200b\u5b58\u5728\u200b\u63a8\u7406\u200b\u5931\u8d25\u200b\u7684\u200b\u53ef\u80fd\u200b\uff1a\u200b\u5373\u200b\u9488\u5bf9\u200b\u6bcf\u4e2a\u200b\u95ee\u9898\u200b\uff0c\u200b\u6a21\u578b\u200b\u4e00\u76f4\u200b\u8f93\u51fa\u200bgugugugu\u3002</p> <pre><code>\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6700\u597d\u200b\u4e0d\u8981\u200b\u8bd5\u56fe\u7528\u200bcpu\u200b\u52a0\u8f7d\u200b\u91cf\u5316\u200b\u6a21\u578b\u200b\uff0c\u200b\u539f\u56e0\u200b\u53ef\u80fd\u200b\u662f\u200b\u76ee\u524d\u200bpython\u200b\u4e3b\u6d41\u200b\u91cf\u5316\u200b\u5305\u200b\u7684\u200b\u91cf\u5316\u200b\u64cd\u4f5c\u200b\u662f\u200b\u5728\u200bgpu\u200b\u4e0a\u200b\u6267\u884c\u200b\u7684\u200b,\u200b\u4f1a\u200b\u5929\u7136\u200b\u5730\u200b\u5b58\u5728\u200bgap\u3002\n</code></pre>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-text2vec-large-chinese-warning-no-sentence-transformers-model-found-with-name-text2vec-large-chinese-creating-a-new-one-with-mean-pooling","title":"Q: \u200b\u4fee\u6539\u200b\u914d\u7f6e\u200b\u4e2d\u200b\u8def\u5f84\u200b\u540e\u200b\uff0c\u200b\u52a0\u8f7d\u200b text2vec-large-chinese \u200b\u4f9d\u7136\u200b\u63d0\u793a\u200b <code>WARNING: No sentence-transformers model found with name text2vec-large-chinese. Creating a new one with MEAN pooling.</code>","text":"<p>A14: \u200b\u5c1d\u8bd5\u200b\u66f4\u6362\u200b embedding\uff0c\u200b\u5982\u200b text2vec-base-chinese\uff0c\u200b\u8bf7\u200b\u5728\u200b configs/model_config.py \u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u4fee\u6539\u200b <code>text2vec-base</code>\u200b\u53c2\u6570\u200b\u4e3a\u200b\u672c\u5730\u200b\u8def\u5f84\u200b\uff0c\u200b\u7edd\u5bf9\u8def\u5f84\u200b\u6216\u8005\u200b\u76f8\u5bf9\u8def\u5f84\u200b\u5747\u200b\u53ef\u200b</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-pg","title":"Q: \u200b\u4f7f\u7528\u200bpg\u200b\u5411\u91cf\u200b\u5e93\u5efa\u200b\u8868\u62a5\u200b\u9519","text":"<p>A15: \u200b\u9700\u8981\u200b\u624b\u52a8\u200b\u5b89\u88c5\u200b\u5bf9\u5e94\u200b\u7684\u200bvector\u200b\u6269\u5c55\u200b(\u200b\u8fde\u63a5\u200bpg\u200b\u6267\u884c\u200b CREATE EXTENSION IF NOT EXISTS vector)</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-pymilvus","title":"Q: pymilvus \u200b\u8fde\u63a5\u200b\u8d85\u65f6","text":"<p>A16.pymilvus\u200b\u7248\u672c\u200b\u9700\u8981\u200b\u5339\u914d\u200b\u548c\u200bmilvus\u200b\u5bf9\u5e94\u200b\u5426\u5219\u200b\u4f1a\u200b\u8d85\u65f6\u200b\u53c2\u8003\u200bpymilvus==2.1.3</p>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-vllmhuggingface","title":"Q: \u200b\u4f7f\u7528\u200bvllm\u200b\u63a8\u7406\u200b\u52a0\u901f\u200b\u6846\u67b6\u200b\u65f6\u200b\uff0c\u200b\u5df2\u7ecf\u200b\u4e0b\u8f7d\u200b\u4e86\u200b\u6a21\u578b\u200b\u4f46\u200b\u51fa\u73b0\u200bHuggingFace\u200b\u901a\u4fe1\u200b\u95ee\u9898","text":"<p>A17: \u200b\u53c2\u7167\u200b\u5982\u4e0b\u200b\u4ee3\u7801\u200b\u4fee\u6539\u200bpython\u200b\u73af\u5883\u200b\u4e0b\u200b/site-packages/vllm/model_executor/weight_utils.py\u200b\u6587\u4ef6\u200b\u7684\u200bprepare_hf_model_weights\u200b\u51fd\u6570\u200b\u5982\u4e0b\u200b\u5bf9\u5e94\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code>    if not is_local:\n        # Use file lock to prevent multiple processes from\n        # downloading the same model weights at the same time.\n        model_path_temp = os.path.join(\n            os.getenv(\"HOME\"),\n            \".cache/huggingface/hub\",\n            \"models--\" + model_name_or_path.replace(\"/\", \"--\"),\n            \"snapshots/\",\n        )\n        downloaded = False\n        if os.path.exists(model_path_temp):\n            temp_last_dir = os.listdir(model_path_temp)[-1]\n            model_path_temp = os.path.join(model_path_temp, temp_last_dir)\n            base_pattern = os.path.join(model_path_temp, \"pytorch_model*.bin\")\n            files = glob.glob(base_pattern)\n            if len(files) &gt; 0:\n                downloaded = True\n\n        if downloaded:\n           hf_folder = model_path_temp\n        else:\n            with get_lock(model_name_or_path, cache_dir):\n                hf_folder = snapshot_download(model_name_or_path,\n                                            allow_patterns=allow_patterns,\n                                            cache_dir=cache_dir,\n                                            tqdm_class=Disabledtqdm)\n    else:\n        hf_folder = model_name_or_path\n</code></pre>"},{"location":"5-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/#q-xxxbase_model_worerpy-assert-rstatus_code-200","title":"Q: <code>/xxx/base_model_worer.py</code> \u200b\u62a5\u200b <code>assert r.status_code == 200</code> \u200b\u9519\u8bef","text":"<p>A\uff1a\u200b\u8fd9\u4e2a\u200b\u9519\u8bef\u200b\u662f\u200b\u672c\u5730\u200b\u6a21\u578b\u200b\u8fdb\u7a0b\u200b\u6ce8\u518c\u200b\u5230\u200b fastchat controller \u200b\u5931\u8d25\u200b\u4e86\u200b\u3002\u200b\u4e00\u822c\u200b\u6709\u200b\u4e24\u79cd\u200b\u539f\u56e0\u200b\uff1a1\u3001\u200b\u5f00\u200b\u4e86\u200b\u7cfb\u7edf\u200b\u5168\u5c40\u200b\u4ee3\u7406\u200b\uff0c\u200b\u5173\u95ed\u200b\u5373\u53ef\u200b\u30022\u3001DEFAULT_BIND_HOST \u200b\u8bbe\u200b\u4e3a\u200b'0.0.0.0'\uff0c\u200b\u6539\u6210\u200b'127.0.0.1' \u200b\u6216\u200b \u200b\u672c\u200b\u673a\u200b\u5b9e\u9645\u200b IP \u200b\u5373\u53ef\u200b\u3002\u200b\u6216\u8005\u200b\u66f4\u65b0\u200b\u5230\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u4ee3\u7801\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u89e3\u51b3\u200b\u3002</p>"},{"location":"6-%E6%94%AF%E6%8C%81%E5%88%97%E8%A1%A8/","title":"6 \u200b\u652f\u6301\u200b\u5217\u8868","text":""},{"location":"6-%E6%94%AF%E6%8C%81%E5%88%97%E8%A1%A8/#llm","title":"LLM \u200b\u6a21\u578b\u200b\u652f\u6301\u200b\u5217\u8868","text":"<p>\u200b\u672c\u5730\u200b\u6a21\u578b\u200b</p> <p>\u200b\u672c\u5730\u200b LLM \u200b\u6a21\u578b\u200b\u63a5\u5165\u200b\u57fa\u4e8e\u200b FastChat \u200b\u5b9e\u73b0\u200b\uff0c\u200b\u652f\u6301\u200b\u6a21\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>ChatGLM \u200b\u5168\u7cfb\u7c7b\u200b\u6a21\u578b\u200b</li> <li>Qwen \u200b\u5168\u7cfb\u5217\u200b\u6a21\u578b\u200b</li> <li>Baichuan \u200b\u5168\u7cfb\u5217\u200b\u6a21\u578b\u200b</li> <li>vivo-ai/BlueLM-7B-Chat</li> <li>01-ai/Yi-34B-Chat</li> <li>meta-llama/Llama-2-7b-chat-hf</li> <li>Vicuna, Alpaca, LLaMA, Koala</li> <li>BlinkDL/RWKV-4-Raven</li> <li>camel-ai/CAMEL-13B-Combined-Data</li> <li>databricks/dolly-v2-12b</li> <li>FreedomIntelligence/phoenix-inst-chat-7b</li> <li>h2oai/h2ogpt-gm-oasst1-en-2048-open-llama-7b</li> <li>lcw99/polyglot-ko-12.8b-chang-instruct-chat</li> <li>lmsys/fastchat-t5-3b-v1.0</li> <li>mosaicml/mpt-7b-chat</li> <li>Neutralzz/BiLLa-7B-SFT</li> <li>nomic-ai/gpt4all-13b-snoozy</li> <li>NousResearch/Nous-Hermes-13b</li> <li>openaccess-ai-collective/manticore-13b-chat-pyg</li> <li>OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5</li> <li>project-baize/baize-v2-7b</li> <li>Salesforce/codet5p-6b</li> <li>StabilityAI/stablelm-tuned-alpha-7b</li> <li>tiiuae/falcon-40b</li> <li>timdettmers/guanaco-33b-merged</li> <li>togethercomputer/RedPajama-INCITE-7B-Chat</li> <li>WizardLM/WizardLM-13B-V1.0</li> <li>WizardLM/WizardCoder-15B-V1.0</li> <li>internlm/internlm-chat-7b</li> <li>HuggingFaceH4/starchat-beta</li> <li>FlagAlpha/Llama2-Chinese-13b-Chat and others</li> <li>BAAI/AquilaChat-7B</li> <li>all models of OpenOrca</li> <li>Spicyboros + airoboros 2.2</li> <li>VMware's OpenLLaMa OpenInstruct</li> <li>\u200b\u4efb\u4f55\u200b EleutherAI \u200b\u7684\u200b pythia \u200b\u6a21\u578b\u200b\uff0c\u200b\u5982\u200b pythia-6.9b</li> <li>\u200b\u5728\u200b\u4ee5\u4e0a\u200b\u6a21\u578b\u200b\u57fa\u7840\u200b\u4e0a\u200b\u8bad\u7ec3\u200b\u7684\u200b\u4efb\u4f55\u200b Peft \u200b\u9002\u914d\u5668\u200b\u3002\u200b\u4e3a\u4e86\u200b\u6fc0\u6d3b\u200b\uff0c\u200b\u6a21\u578b\u200b\u8def\u5f84\u200b\u4e2d\u200b\u5fc5\u987b\u200b\u6709\u200b <code>peft</code> \u3002\u200b\u6ce8\u610f\u200b\uff1a\u200b\u5982\u679c\u200b\u52a0\u8f7d\u200b\u591a\u4e2a\u200bpeft\u200b\u6a21\u578b\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u5728\u200b\u4efb\u4f55\u200b\u6a21\u578b\u200b\u5de5\u4f5c\u200b\u5668\u4e2d\u200b\u8bbe\u7f6e\u200b\u73af\u5883\u53d8\u91cf\u200b <code>PEFT_SHARE_BASE_WEIGHTS=true</code> \u200b\u6765\u200b\u4f7f\u200b\u5b83\u4eec\u200b\u5171\u4eab\u200b\u57fa\u7840\u200b\u6a21\u578b\u200b\u7684\u200b\u6743\u91cd\u200b\u3002</li> </ul> <p>\u200b\u4ee5\u4e0a\u200b\u6a21\u578b\u200b\u652f\u6301\u200b\u5217\u8868\u200b\u53ef\u80fd\u200b\u968f\u200b FastChat \u200b\u66f4\u65b0\u200b\u800c\u200b\u6301\u7eed\u200b\u66f4\u65b0\u200b\uff0c\u200b\u53ef\u200b\u53c2\u8003\u200b FastChat \u200b\u5df2\u200b\u652f\u6301\u200b\u6a21\u578b\u200b\u5217\u8868\u200b\u3002</p> <p>\u200b\u8054\u7f51\u200b\u6a21\u578b\u200b</p> <p>\u200b\u652f\u6301\u200b\u7684\u200b\u8054\u7f51\u200b\u6a21\u578b\u200b - ChatGPT - Azure OpenAI - \u200b\u667a\u8c31\u200bAI - MiniMax - \u200b\u8baf\u200b\u98de\u200b\u661f\u706b\u200b - \u200b\u767e\u5ea6\u200b\u5343\u5e06\u200b - \u200b\u963f\u91cc\u200b\u4e91\u200b\u901a\u4e49\u200b\u5343\u95ee\u200b - \u200b\u5b57\u8282\u200b\u706b\u5c71\u200b\u65b9\u821f\u200b - \u200b\u767e\u5ddd\u200b</p>"},{"location":"6-%E6%94%AF%E6%8C%81%E5%88%97%E8%A1%A8/#embedding","title":"Embedding \u200b\u6a21\u578b\u200b\u652f\u6301\u200b\u5217\u8868","text":"<p>\u200b\u672c\u5730\u200b\u6a21\u578b\u200b</p> <p>\u200b\u672c\u200b\u9879\u76ee\u200b\u652f\u6301\u200b\u8c03\u7528\u200b HuggingFace \u200b\u4e2d\u200b\u7684\u200b Embedding \u200b\u6a21\u578b\u200b\uff0c\u200b\u5df2\u200b\u652f\u6301\u200b\u7684\u200b Embedding \u200b\u6a21\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <p>MokaAI\u200b\u7cfb\u5217\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b</p> <ul> <li>moka-ai/m3e-small</li> <li>moka-ai/m3e-base</li> <li>moka-ai/m3e-large</li> </ul> <p>BAAI\u200b\u7cfb\u5217\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b - BAAI/bge-small-zh - BAAI/bge-base-zh - BAAI/bge-large-zh - BAAI/bge-small-zh-v1.5 - BAAI/bge-base-zh-v1.5 - BAAI/bge-large-zh-v1.5 - BAAI/bge-large-zh-noinstruct - BAAI/bge-reranker-large - BAAI/bge-reranker-base</p> <p>text2vec\u200b\u7cfb\u5217\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b - shibing624/text2vec-base-chinese-sentence - shibing624/text2vec-base-chinese-paraphrase - shibing624/text2vec-base-multilingual - shibing624/text2vec-base-chinese - shibing624/text2vec-bge-large-chinese - GanymedeNil/text2vec-large-chinese</p> <p>\u200b\u5176\u4ed6\u200b\u6a21\u578b\u200b - sensenova/piccolo-base-zh - sensenova/piccolo-large-zh - nghuyong/ernie-3.0-nano-zh - nghuyong/ernie-3.0-base-zh</p> <p>\u200b\u8fbe\u6469\u9662\u200b\u7cfb\u5217\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b - damo/nlp_gte_sentence-embedding_chinese-large</p> <p>\u200b\u8054\u7f51\u200b\u6a21\u578b\u200b</p> <p>\u200b\u9664\u200b\u672c\u5730\u200b\u6a21\u578b\u200b\u5916\u200b\uff0c\u200b\u672c\u200b\u9879\u76ee\u200b\u4e5f\u200b\u652f\u6301\u200b\u76f4\u63a5\u200b\u63a5\u5165\u200b OpenAI\u200b\u7684\u200b\u5728\u7ebf\u200b\u5d4c\u5165\u200b\u6a21\u578b\u200b\u3002 \u200b\u652f\u6301\u200b\u7684\u200b\u8054\u7f51\u200b\u6a21\u578b\u200b - OpenAI/text-embedding-ada-002 - \u200b\u667a\u8c31\u200bAI - MiniMax - \u200b\u767e\u5ea6\u200b\u5343\u5e06\u200b - \u200b\u963f\u91cc\u200b\u4e91\u200b\u901a\u4e49\u200b\u5343\u95ee\u200b</p>"},{"location":"6-%E6%94%AF%E6%8C%81%E5%88%97%E8%A1%A8/#_1","title":"\u5206\u8bcd\u5668\u200b\u652f\u6301\u200b\u5217\u8868","text":"<p>Langchain \u200b\u4e2d\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b</p> <p>\u200b\u672c\u200b\u9879\u76ee\u200b\u652f\u6301\u200b\u8c03\u7528\u200b Langchain \u200b\u7684\u200b Text Splitter \u200b\u5206\u8bcd\u5668\u200b\u4ee5\u53ca\u200b\u57fa\u4e8e\u200b\u6b64\u200b\u6539\u8fdb\u200b\u7684\u200b\u81ea\u5b9a\u4e49\u200b\u5206\u8bcd\u5668\u200b\uff0c\u200b\u5df2\u200b\u652f\u6301\u200b\u7684\u200b Text Splitter \u200b\u7c7b\u578b\u200b\u5982\u4e0b\u200b\uff1a - CharacterTextSplitter - LatexTextSplitter - MarkdownHeaderTextSplitter - MarkdownTextSplitter - NLTKTextSplitter - PythonCodeTextSplitter - RecursiveCharacterTextSplitter - SentenceTransformersTokenTextSplitter - SpacyTextSplitter</p> <p>\u200b\u81ea\u5b9a\u4e49\u200b\u5206\u8bcd\u5668\u200b</p> <p>\u200b\u5df2\u7ecf\u200b\u652f\u6301\u200b\u7684\u200b\u5b9a\u5236\u200b\u5206\u8bcd\u5668\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>AliTextSplitter</li> <li>ChineseRecursiveTextSplitter</li> <li>ChineseTextSplitter</li> </ul>"},{"location":"6-%E6%94%AF%E6%8C%81%E5%88%97%E8%A1%A8/#_2","title":"\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b\u652f\u6301\u200b\u5217\u8868","text":"<p>\u200b\u672c\u5730\u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b</p> <p>\u200b\u76ee\u524d\u200b\u652f\u6301\u200b\u7684\u200b\u672c\u5730\u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b\u5217\u8868\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>FAISS </li> <li>Milvus</li> <li>PGVector</li> </ul> <p>\u200b\u8054\u7f51\u200b\u5411\u91cf\u200b\u6570\u636e\u5e93\u200b</p> <ul> <li>Zilliz</li> </ul>"},{"location":"6-%E6%94%AF%E6%8C%81%E5%88%97%E8%A1%A8/#_3","title":"\u5de5\u5177\u200b\u652f\u6301\u200b\u5217\u8868","text":"<p>Langchain\u200b\u5de5\u5177\u200b</p> <ul> <li>Shell \u200b\u5de5\u5177\u200b\uff0c\u200b\u7528\u4e8e\u200b\u6a21\u62df\u200b\u5f53\u524d\u200b\u7684\u200bLinux Shell\u200b\u73af\u5883\u200b</li> <li>Youtube \u200b\u5de5\u5177\u200b\uff0c\u200b\u7528\u4e8e\u200b\u641c\u7d22\u200bYoutube\u200b\u7684\u200b\u76f8\u5173\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b</li> <li>Wolfram \u200b\u5de5\u5177\u200b\uff0c\u200b\u7528\u200bWolfram\u200b\u6765\u200b\u5b9e\u73b0\u200b\u6570\u5b66\u8ba1\u7b97\u200b\u7b49\u200b</li> </ul> <p>\u200b\u5176\u4ed6\u200bLangchain\u200b\u81ea\u5e26\u200b\u7684\u200b\u5de5\u5177\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u6309\u7167\u200b\u4e0a\u8ff0\u200b\u4e09\u4e2a\u200b\u5de5\u5177\u200b\u7684\u200b\u65b9\u5f0f\u200b\u6765\u200b\u81ea\u5df1\u200b\u5b9e\u73b0\u200b</p> <p>\u200b\u672c\u5730\u200b\u5de5\u5177\u200b</p> <ul> <li>\u200b\u7ffb\u8bd1\u200b\u5de5\u5177\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u5bf9\u200b\u8f93\u5165\u200b\u7684\u200b\u4efb\u610f\u200b\u8bed\u8a00\u200b\u7ffb\u8bd1\u200b\u3002 </li> <li>\u200b\u6570\u5b66\u200b\u5de5\u5177\u200b\uff0c\u200b\u4f7f\u7528\u200bLLMMathChain \u200b\u5b9e\u73b0\u200b\u6570\u5b66\u8ba1\u7b97\u200b\u3002</li> <li>\u200b\u9ad8\u7ea7\u200b\u77e5\u8bc6\u5e93\u200b\u5de5\u5177\u200b\uff0c\u200b\u667a\u80fd\u200b\u9009\u62e9\u200b\u8c03\u7528\u200b\u591a\u4e2a\u200b\u6216\u8005\u200b\u5355\u4e2a\u200b\u77e5\u8bc6\u5e93\u200b\u5e76\u200b\u67e5\u8be2\u200b\u5185\u5bb9\u200b\u3002</li> <li>\u200b\u8fdb\u9636\u200b\u77e5\u8bc6\u5e93\u200b\u5de5\u5177\u200b\uff0c\u200b\u667a\u80fd\u200b\u9009\u62e9\u200b\u8c03\u7528\u200b\u4e00\u4e2a\u200b\u6700\u200b\u76f8\u8fd1\u200b\u7684\u200b\u77e5\u8bc6\u5e93\u200b\u5e76\u200b\u67e5\u8be2\u200b\u5185\u5bb9\u200b\u3002</li> <li>\u200b\u57fa\u7840\u200b\u77e5\u8bc6\u5e93\u200b\u5de5\u5177\u200b\uff0c\u200b\u9009\u62e9\u200b\u6307\u5b9a\u200b\u7684\u200b\u4e00\u4e2a\u200b\u77e5\u8bc6\u5e93\u200b\u5e76\u200b\u56de\u7b54\u200b\u3002</li> </ul> <p>\u200b\u8054\u7f51\u200b\u5de5\u5177\u200b</p> <ul> <li>\u200b\u5929\u6c14\u200b\u5de5\u5177\u200b\uff0c\u200b\u4f7f\u7528\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200bLLMWetherChain\u200b\u5b9e\u73b0\u200b\u5929\u6c14\u200b\u67e5\u8be2\u200b\uff0c\u200b\u8c03\u7528\u200b\u548c\u200b\u98ce\u200b\u5929\u6c14\u200bAPI\u3002</li> <li> <p>\u200b\u641c\u7d22\u200b\u5de5\u5177\u200b\uff0c\u200b\u4f7f\u7528\u200b\u6211\u4eec\u200b\u7684\u200b\u641c\u7d22\u200bAPI\u200b\u6765\u200b\u5b9e\u73b0\u200b\u641c\u7d22\u200b\u5e76\u200b\u6982\u62ec\u200b\u5185\u5bb9\u200b\u3002</p> </li> <li> <p>\u200b\u6211\u4eec\u200b\u671f\u5f85\u200b\u5f00\u53d1\u8005\u200b\u5171\u4eab\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u5de5\u5177\u200b\uff0c\u200b\u5e2e\u52a9\u200b\u9879\u76ee\u200b\u751f\u6001\u200b\u5b8c\u5584\u200b</p> </li> </ul>"},{"location":"ES%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/","title":"ES\u200b\u90e8\u7f72\u200b\u6307\u5357","text":""},{"location":"ES%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/#es_1","title":"\u5b9e\u73b0\u200b\u57fa\u4e8e\u200bES\u200b\u7684\u200b\u6570\u636e\u200b\u63d2\u5165\u200b\u3001\u200b\u68c0\u7d22\u200b\u3001\u200b\u5220\u9664\u200b\u3001\u200b\u66f4\u65b0","text":"<pre><code>author: \u200b\u5510\u56fd\u200b\u6881\u200bTommy\ne-mail: flytang186@qq.com\n\n\u200b\u5982\u679c\u200b\u9047\u5230\u200b\u4efb\u4f55\u200b\u95ee\u9898\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4e0e\u200b\u6211\u200b\u8054\u7cfb\u200b\uff0c\u200b\u6211\u200b\u8fd9\u8fb9\u200b\u90e8\u7f72\u200b\u540e\u200b\u670d\u52a1\u200b\u662f\u200b\u6ca1\u6709\u200b\u95ee\u9898\u200b\u7684\u200b\u3002\n</code></pre>"},{"location":"ES%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/#1es-docker","title":"\u7b2c\u200b1\u200b\u6b65\u200b\uff1aES docker\u200b\u90e8\u7f72","text":"<pre><code>docker network create elastic\ndocker run -id --name elasticsearch --net elastic -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" -e \"xpack.security.enabled=false\" -e \"xpack.security.http.ssl.enabled=false\" -t docker.elastic.co/elasticsearch/elasticsearch:8.8.2\n</code></pre>"},{"location":"ES%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/#2kibana-docker","title":"\u7b2c\u200b2\u200b\u6b65\u200b\uff1aKibana docker\u200b\u90e8\u7f72","text":"<p>\u200b\u6ce8\u610f\u200b\uff1aKibana\u200b\u7248\u672c\u200b\u4e0e\u200bES\u200b\u4fdd\u6301\u4e00\u81f4\u200b <pre><code>docker pull docker.elastic.co/kibana/kibana:{version} \ndocker run --name kibana --net elastic -p 5601:5601 docker.elastic.co/kibana/kibana:{version}\n</code></pre></p>"},{"location":"ES%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/#3","title":"\u7b2c\u200b3\u200b\u6b65\u200b\uff1a\u200b\u6838\u5fc3\u200b\u4ee3\u7801","text":"<pre><code>1. \u200b\u6838\u5fc3\u200b\u4ee3\u7801\u200b\u8def\u5f84\u200b\nserver/knowledge_base/kb_service/es_kb_service.py\n\n2. \u200b\u9700\u8981\u200b\u5728\u200b configs/model_config.py \u200b\u4e2d\u200b \u200b\u914d\u7f6e\u200b ES\u200b\u53c2\u6570\u200b\uff08IP\uff0c PORT\uff09\u200b\u7b49\u200b\uff1b\n</code></pre>"}]}